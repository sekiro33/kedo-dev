{
  "__id": "018fe325-a738-79ac-815b-5018f67fb3fc",
  "namespace": "kedo_ext",
  "code": "my_profile_misc_widget",
  "__name": "Виджет Мой профиль Остальное",
  "description": "",
  "extensionZoneCode": "",
  "sort": 0,
  "category": "00000000-0000-0000-0000-000000000000",
  "version": 13,
  "hidden": false,
  "draft": false,
  "readonly": false,
  "descriptor": {
    "template": {
      "id": "34627995-3523-4c91-acf4-f266e94726f1",
      "descriptor": "component",
      "content": {
        "": [
          {
            "id": "6ace2c21-04b1-432b-a651-1da537272bac",
            "descriptor": "code",
            "values": {
              "contentPlaceholder": "",
              "html": "\u003cstyle\u003e\n\n    .misc {\n\n    }\n\n    .misc.kedo__my-profle_misc {\n        margin: 0;\n        padding: 0;\n        font-family: 'SF Pro Display';\n        margin-top: 0;\n        margin-bottom: 0;\n        padding-top: 0;\n        padding-bottom: 0;\n        font-size: 16px;\n        background-color: #F5F6FA;\n    }\n\n    .misc h3 {\n        font-size: 2rem\n    }\n\n    .misc svg {\n        fill: none\n    }\n\n    @keyframes kedo-loader-rotate {\n        to {\n            transform: rotate(.5turn)\n        }\n    }\n\n    @keyframes kedo-spinner-rotate {\n        0% {\n            transform: rotate(0)\n        }\n\n        100% {\n            transform: rotate(360deg)\n        }\n    }\n\n    .hidden {\n        display: none\n    }\n\n    .misc.item-header {\n        font-size: 16px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 140%;\n        color: #979797\n    }\n\n    .misc g {\n        fill: transparent\n    }\n\n    .misc.title-text {\n        font-size: 2.4rem;\n        margin-bottom: 0\n    }\n\n    .misc.kedo__my-profle_header-content {\n        gap: 1rem;\n        display: flex\n    }\n\n    .misc.kedo__my-profle_header-content div,\n    .misc.kedo__my-profle_header-content h3 {\n        color: #000\n    }\n\n    .misc.kedo__my-profle_docs {\n        display: flex;\n        flex-direction: column\n    }\n\n    .misc.kedo__my-profle_docs-title {\n        display: flex;\n        justify-content: space-between;\n        align-items: center\n    }\n\n    .misc.kedo__my-profle_docs-misc-info_content {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 5rem\n    }\n\n    .misc.misc-info-item {\n        width: 20rem;\n        padding-left: .5rem;\n        position: relative\n    }\n\n    .misc.misc-info-item::before {\n        content: \"\";\n        position: absolute;\n        width: 1px;\n        height: 3rem;\n        background-color: #5082e6;\n        left: -.2rem\n    }\n\n    .misc.family-info-item {\n        width: 25rem;\n        padding-left: .5rem;\n        position: relative;\n        word-wrap: break-word\n    }\n\n    .misc.family-info-item::before {\n        content: \"\";\n        position: absolute;\n        width: 2px;\n        height: 3rem;\n        background-color: #5082e6;\n        left: -8px\n    }\n\n    .misc.family-info-item_label {\n        font-size: 12px;\n        color: #979797\n    }\n\n    .misc.kedo__my-profle_docs-family-info_content_empty {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 100%\n    }\n\n    .misc.misc-info-item_label {\n        color: #979797;\n        font-size: small\n    }\n\n    .misc.misc-info-item_value {\n        font-weight: 400;\n        font-size: 15px\n    }\n\n    .misc.kedo__my-profle_misc-copy:hover {\n        cursor: pointer\n    }\n\n    .misc.kedo__my-profle_misc-copy:hover svg {\n        fill: #759eef\n    }\n\n    .misc.kedo__my-profle_misc-copy:active svg {\n        fill: #000\n    }\n\n    .misc.kedo__my-profle_misc {\n        display: flex;\n        flex-direction: column\n    }\n\n    .misc.kedo__my-profle_misc-buttons {\n        display: flex;\n        align-items: flex-start;\n        gap: 1rem\n    }\n\n    .misc.misc-button {\n        border-radius: 2rem;\n        color: #5082e6;\n        border: 1px solid #5082e6;\n        display: flex;\n        gap: 1rem;\n        padding: .5rem 1rem;\n        align-items: center\n    }\n\n    .misc.misc-button:hover {\n        cursor: pointer;\n        background-color: #ecf3ff\n    }\n\n    .misc.misc-button.pressed {\n        background-color: #5082e6;\n        color: #fff;\n        pointer-events: none\n    }\n\n    .misc.misc-button.pressed path {\n        fill: #fff\n    }\n\n    .misc.misc-button-title {\n        cursor: pointer\n    }\n\n    .misc.kedo__my-profle_misc_content {\n        border-radius: 1rem;\n        background-color: #fff;\n        padding: 1rem 2rem 2rem;\n        margin-top: 1rem;\n        display: flex;\n        flex-direction: column;\n        position: relative\n    }\n\n    .misc.kedo__my-profle_misc-header {\n        position: absolute;\n        top: 16px;\n        right: 19px\n    }\n\n    .misc.kedo__my-profle_misc-copy svg {\n        fill: #5082e6\n    }\n\n    .misc.kedo__my-profle_docs {\n        display: flex;\n        flex-direction: column\n    }\n\n    .misc.kedo__my-profle_docs-header {\n        display: flex;\n        justify-content: end\n    }\n\n    .misc.button-pressed {\n        cursor: default;\n        background-color: #ecf3ff\n    }\n\n    .misc.misc-info-item-category {\n        display: flex;\n        gap: 1rem;\n        align-items: center\n    }\n\n    .misc.misc-info-category_label {\n        width: .5rem;\n        height: .5rem;\n        background-color: #000;\n        border-radius: 50%\n    }\n\n    @keyframes spinner-rotation {\n        from {\n            transform: rotate(0)\n        }\n\n        to {\n            transform: rotate(360deg)\n        }\n    }\n\n    @media (max-width:720px) {\n        .kedo__my-profle_header-content {\n            flex-direction: column\n        }\n    }\n\n    @media (max-width:450px) {\n        .misc.kedo__my-profle_docs-header {\n            justify-content: start\n        }\n\n        .misc.kedo__my-profle_misc-buttons {\n            font-size: 14px;\n            justify-content: space-between\n        }\n\n        .misc.kedo__my-profle_misc_content {\n            padding: 1rem 1rem 1rem;\n            font-size: 14px\n        }\n    }\n\u003c/style\u003e\n\n\u003c!-- \u003cdiv class=\"kedo-loader-wrapper hidden\" data-loader=\"profile\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 26 26\" data-test=\"spinner\" class=\"kedo-spinner\"\u003e\n        \u003cpath d=\"M13 3v-2c-2.7 0-5.4.9-7.7 2.8l-.8.7 1.4 1.4c2-1.9 4.5-2.9 7.1-2.9z\" class=\"st0\"\u003e\u003c/path\u003e\n        \u003cpath d=\"M5.9 5.9l-1.4-1.4c-2.3 2.3-3.5 5.4-3.5 8.5h2c0-2.6 1-5.1 2.9-7.1z\" class=\"st1\"\u003e\n        \u003c/path\u003e\n        \u003cpath d=\"M3 13h-2c0 2.7.9 5.4 2.8 7.7l.7.8 1.4-1.4c-1.9-2-2.9-4.5-2.9-7.1z\" class=\"st2\"\u003e\n        \u003c/path\u003e\n        \u003cpath d=\"M5.9 20.1l-1.4 1.4c2.3 2.3 5.4 3.5 8.5 3.5v-2c-2.6 0-5.1-1-7.1-2.9z\" class=\"st3\"\u003e\u003c/path\u003e\n        \u003cpath d=\"M20.1 5.9l1.4-1.4c-2.3-2.3-5.4-3.5-8.5-3.5v2c2.6 0 5.1 1 7.1 2.9z\" class=\"st4\"\u003e\n        \u003c/path\u003e\n        \u003cpath d=\"M23 13h2c0-2.7-.9-5.4-2.8-7.7l-.7-.8-1.4 1.4c1.9 2 2.9 4.5 2.9 7.1z\" class=\"st5\"\u003e\u003c/path\u003e\n        \u003cpath d=\"M20.1 20.1l1.4 1.4c2.3-2.3 3.5-5.4 3.5-8.5h-2c0 2.6-1 5.1-2.9 7.1z\" class=\"st6\"\u003e\u003c/path\u003e\n        \u003cpath d=\"M20.7 22.2l.8-.7-1.4-1.4c-2 2-4.5 2.9-7.1 2.9v2c2.7 0 5.4-.9 7.7-2.8z\" class=\"st7\"\u003e\u003c/path\u003e\n    \u003c/svg\u003e\n\u003c/div\u003e --\u003e\n\n\u003cdiv class=\"misc kedo__my-profle_misc\"\u003e\n    \u003cdiv class=\"misc kedo__my-profle_misc-buttons\"\u003e\n        \u003cdiv class=\"misc misc-button pressed\" data-choice=\"family\"\u003e\n            \u003cdiv class=\"misc misc-button-img\"\u003e\u003csvg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath\n                        d=\"M12.8 11.5C11.9031 11.5 11.4719 12 10 12C8.52812 12 8.1 11.5 7.2 11.5C4.88125 11.5 3 13.3813 3 15.7V16.5C3 17.3281 3.67188 18 4.5 18H15.5C16.3281 18 17 17.3281 17 16.5V15.7C17 13.3813 15.1187 11.5 12.8 11.5ZM15.5 16.5H4.5V15.7C4.5 14.2125 5.7125 13 7.2 13C7.65625 13 8.39687 13.5 10 13.5C11.6156 13.5 12.3406 13 12.8 13C14.2875 13 15.5 14.2125 15.5 15.7V16.5ZM10 11C12.4844 11 14.5 8.98438 14.5 6.5C14.5 4.01562 12.4844 2 10 2C7.51562 2 5.5 4.01562 5.5 6.5C5.5 8.98438 7.51562 11 10 11ZM10 3.5C11.6531 3.5 13 4.84687 13 6.5C13 8.15312 11.6531 9.5 10 9.5C8.34688 9.5 7 8.15312 7 6.5C7 4.84687 8.34688 3.5 10 3.5Z\"\n                        fill=\"#5082E6\" /\u003e\n                \u003c/svg\u003e\u003c/div\u003e\n            \u003cdiv class=\"misc misc-button-title\" data-choice=\"family\"\u003eСостав семьи \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"misc misc-button\" data-choice=\"category\"\u003e\n            \u003cdiv class=\"misc misc-button-img\"\u003e\u003csvg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath\n                        d=\"M13 9.75V10.625C13 10.8313 12.8313 11 12.625 11H7.375C7.16875 11 7 10.8313 7 10.625V9.75C7 9.54375 7.16875 9.375 7.375 9.375H12.625C12.8313 9.375 13 9.54375 13 9.75ZM12.625 12H7.375C7.16875 12 7 12.1687 7 12.375V13.25C7 13.4563 7.16875 13.625 7.375 13.625H12.625C12.8313 13.625 13 13.4563 13 13.25V12.375C13 12.1687 12.8313 12 12.625 12ZM16 6.12187V16.5C16 17.3281 15.3281 18 14.5 18H5.5C4.67188 18 4 17.3281 4 16.5V3.5C4 2.67188 4.67188 2 5.5 2H11.8781C12.275 2 12.6562 2.15938 12.9375 2.44063L15.5594 5.0625C15.8406 5.34063 16 5.725 16 6.12187ZM12 3.62188V6H14.3781L12 3.62188ZM14.5 16.5V7.5H11.25C10.8344 7.5 10.5 7.16563 10.5 6.75V3.5H5.5V16.5H14.5Z\"\n                        fill=\"#5082E6\" /\u003e\n                \u003c/svg\u003e\u003c/div\u003e\n            \u003cdiv class=\"misc misc-button-title\" data-choice=\"category\"\u003eКатегория сотрудника \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"misc kedo__my-profle_misc_content\"\u003e\n        \u003cdiv class=\"misc kedo__my-profle_misc-header\"\u003e\n            \u003cdiv class=\"misc kedo__my-profle_misc-copy\"\u003e\u003csvg width=\"14\" height=\"16\" viewBox=\"0 0 14 16\" fill=\"none\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cg clip-path=\"url(#clip0_2146_5783)\"\u003e\n                        \u003cpath\n                            d=\"M13.5607 2.06066L11.9393 0.439344C11.658 0.158039 11.2765 2.08024e-06 10.8787 0L5.5 0C4.67156 0 4 0.671562 4 1.5V3H1.5C0.671562 3 0 3.67156 0 4.5V14.5C0 15.3284 0.671562 16 1.5 16H8.5C9.32844 16 10 15.3284 10 14.5V13H12.5C13.3284 13 14 12.3284 14 11.5V3.12131C14 2.72349 13.842 2.34196 13.5607 2.06066ZM8.3125 14.5H1.6875C1.63777 14.5 1.59008 14.4802 1.55492 14.4451C1.51975 14.4099 1.5 14.3622 1.5 14.3125V4.6875C1.5 4.63777 1.51975 4.59008 1.55492 4.55492C1.59008 4.51975 1.63777 4.5 1.6875 4.5H4V11.5C4 12.3284 4.67156 13 5.5 13H8.5V14.3125C8.5 14.3622 8.48025 14.4099 8.44508 14.4451C8.40992 14.4802 8.36223 14.5 8.3125 14.5ZM12.3125 11.5H5.6875C5.63777 11.5 5.59008 11.4802 5.55492 11.4451C5.51975 11.4099 5.5 11.3622 5.5 11.3125V1.6875C5.5 1.63777 5.51975 1.59008 5.55492 1.55492C5.59008 1.51975 5.63777 1.5 5.6875 1.5H9V4.25C9 4.66422 9.33578 5 9.75 5H12.5V11.3125C12.5 11.3622 12.4802 11.4099 12.4451 11.4451C12.4099 11.4802 12.3622 11.5 12.3125 11.5ZM12.5 3.5H10.5V1.5H10.801C10.8507 1.5 10.8984 1.51975 10.9336 1.55491L12.4451 3.06641C12.4625 3.08382 12.4763 3.10449 12.4857 3.12724C12.4952 3.14999 12.5 3.17438 12.5 3.199V3.5Z\"\n                            fill=\"#5082E6\" /\u003e\n                    \u003c/g\u003e\n                    \u003cdefs\u003e\n                        \u003cclipPath id=\"clip0_2146_5783\"\u003e\n                            \u003crect width=\"14\" height=\"16\" fill=\"white\" /\u003e\n                        \u003c/clipPath\u003e\n                    \u003c/defs\u003e\n                \u003c/svg\u003e\u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"misc kedo__my-profle_docs-category-info_content hidden\" id=\"category\"\u003e\n            \u003cdiv class=\"misc misc-info-item-category default-category\"\u003e\n                \u003cdiv class=\"misc misc-info-category_label\"\u003e\u003c/div\u003e\n                \u003cdiv class=\"misc misc-info-category_value\"\u003eСотрудник без ограничений\u003cbr\u003eДействует до: Без срока\u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"misc kedo__my-profle_docs-family-info_content\" id=\"family\"\u003e\n            \u003cdiv class=\"misc kedo__my-profle_docs-family-info_content_empty hidden\"\u003e\n                \u003ch3 class=\"misc kedo__my-profle_docs-family-info_content_empty-text\"\u003e\u003c/h3\u003eИнформация о составе семьи\n                отсутствует\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003ctemplate class=\"misc misc-info-item-category_template\"\u003e\n    \u003cdiv class=\"misc misc-info-item-category\"\u003e\n        \u003cdiv class=\"misc misc-info-category_label\"\u003e\n            \n        \u003c/div\u003e\n        \u003cdiv class=\"misc misc-info-category_value\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n\u003c/template\u003e\n\n\n\u003ctemplate class=\"misc family-info-item_template\"\u003e\n    \u003cdiv class=\"misc family-info-item\"\u003e\n        \u003cdiv class=\"misc family-info-item_label\"\u003e\n            \n        \u003c/div\u003e\n        \u003cdiv class=\"misc family-info-item_value\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n\u003c/template\u003e\n\n\u003ctemplate class=\"misc category-info-item_template\"\u003e\n    \u003cdiv class=\"misc misc-info-item-category default-category\"\u003e\n        \u003cdiv class=\"misc misc-info-category_label\"\u003e\u003c/div\u003e\n        \u003cdiv class=\"misc misc-info-category_value\"\u003eСотрудник без ограничений\u003cbr\u003eДействует до: Без срока\u003c/div\u003e\n    \u003c/div\u003e\n\u003c/template\u003e            ",
              "hideContent": false
            }
          }
        ]
      }
    },
    "fields": [
      {
        "code": "staff_app",
        "type": "SYS_COLLECTION",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": true,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {
          "code": "staff",
          "filter": {
            "value": {
              "tf": {}
            },
            "enabled": false
          },
          "bindings": null,
          "namespace": "kedo",
          "isDependent": false,
          "linkedFieldCode": ""
        },
        "view": {
          "name": "Приложение Сотрудники",
          "data": {},
          "input": false,
          "output": true
        }
      },
      {
        "code": "family_composition_app",
        "type": "SYS_COLLECTION",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": true,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {
          "code": "family_composition_app",
          "filter": {
            "value": {
              "tf": {}
            },
            "enabled": false
          },
          "bindings": null,
          "namespace": "kedo",
          "isDependent": false,
          "linkedFieldCode": ""
        },
        "view": {
          "name": "Приложение Состав семьи",
          "data": {},
          "input": true,
          "output": true
        }
      },
      {
        "code": "event_listeners_set",
        "type": "BOOLEAN",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": false,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Обработчики событий установлены",
          "data": {
            "additionalType": "radio",
            "noValue": "Нет",
            "yesValue": "Да"
          },
          "input": false,
          "output": true
        }
      }
    ],
    "fieldVisibilityConditions": {
      "staff_app": {
        "enabled": false,
        "conditions": []
      },
      "event_listeners_set": {
        "enabled": false,
        "conditions": []
      },
      "family_composition_app": {
        "enabled": false,
        "conditions": []
      }
    },
    "scriptOptions": {},
    "clientScripts": "declare const console: any;\ndeclare const window: any;\ndeclare const document: any;\ndeclare const filePath: any;\ndeclare const DOMParser: any;\ndeclare const FileReader: any;\n\ntype staff = ApplicationItem\u003cApplication$kedo$staff$Data, any\u003e;\ntype organization = ApplicationItem\u003cApplication$kedo$organization$Data, any\u003e;\ntype family = ApplicationItem\u003cApplication$kedo$family_composition_app$Data, any\u003e;\ntype subdivision = ApplicationItem\u003cApplication$kedo$structural_subdivision$Data, any\u003e;\ntype position = ApplicationItem\u003cApplication$kedo$position$Data, any\u003e;\ntype status = ApplicationItem\u003cApplication$kedo$statuses$Data, any\u003e;\n\ntype category = {\n    name: string,\n    assignment_date: string,\n    expiration_date: string\n};\n\ntype componentObj = {\n    cls: string,\n    component: any;\n};\n\ntype objData = {\n    id: string,\n    code: string,\n    ns: string,\n    name: string,\n    status: string,\n    status_code: string,\n    business_type: string,\n    render_zone: string,\n    created_at: TDatetime,\n    item_type: string,\n    link: string,\n    start_date?: string,\n    end_date?: string,\n    start_date_obj: TDate | TDatetime,\n    end_date_obj: TDate | TDatetime,\n    vacation_type?: string,\n    vacation_code?: string,\n    duration?: number,\n    cityId?: string,\n    cityName?: string,\n    staffId: string,\n    work_type?: string,\n    type_employment?: string,\n};\n\ntype userSettings = {\n    notifications: string,\n    provider: string,\n    default_page: string\n};\n\nenum LoaderType {\n    COMMON = \"common\",\n    MAIN = \"main\",\n    TASKS = \"tasks\",\n    DOCUMENTS = \"documents\",\n    SERVICES = \"services\",\n    BUSINESS_TRIPS = \"business_trips\",\n    VACATIONS = \"vacations\",\n    PROFILE = \"profile\",\n    DOCUMENTS_WIDGET = \"personnel_documents_widget\",\n    ISSUES_WIDGET = \"issues_widget\",\n    VACATION_WIDGET = \"vacation_widget\",\n};\n\nclass UserDataManager {\n    user: CurrentUserItem;\n    staff: staff;\n    organization: organization | undefined;\n    subdivision: subdivision | undefined;\n    position: position | undefined;\n    categories: category[];\n    family: { name: string, relation: string }[];\n    avatarLink: string | undefined;\n};\n\nclass DomManager {\n    constructor() {\n        this.userInfoTemplateContent = undefined;\n        this.loader = undefined;\n        this.parser = new DOMParser();\n        this.domLoaded = false;\n    };\n\n    parser: typeof DOMParser;\n    root: componentObj | undefined;\n    loader: componentObj | undefined;\n    userInfoTemplateContent: any | undefined\n    domLoaded: boolean;\n\n    renderProfileSection() {\n\n        function setMiscItems(event: any) {\n            let target = event.target;\n            const choice = event.target.dataset[\"choice\"];\n            const otherButton = choice === \"family\" ? document.querySelector(\"[data-choice='category']\") : document.querySelector(\"[data-choice='family']\");\n            if (event.target.classList.contains(\"misc-button-title\")) {\n                target = choice === \"family\" ? document.querySelector(\"[data-choice='family']\") : document.querySelector(\"[data-choice='category']\");\n            }\n            const itemToShow = document.querySelector(`#${choice}`);\n            const otherItem = choice === \"family\" ? document.querySelector(\"#category\") : document.querySelector(\"#family\");\n            itemToShow.classList.toggle(\"hidden\");\n            otherItem.classList.toggle(\"hidden\");\n            [target, otherButton].forEach(item =\u003e item.classList.toggle(\"pressed\"));\n        }\n\n        if (!Context.data.event_listeners_set) {\n            const buttons = document.querySelectorAll(\".misc-button\");\n            buttons.forEach((button: any) =\u003e button.addEventListener(\"click\", setMiscItems, true));\n        }\n\n        const familyInfoContainer = document.querySelector(\".kedo__my-profle_docs-family-info_content\");\n        const categoryInfoContainer = document.querySelector(\".kedo__my-profle_docs-category-info_content\");\n\n        refreshContainers([categoryInfoContainer], \"misc-info-item-category\");\n        refreshContainers([familyInfoContainer], \"family-info-item\");\n\n        if (userDataManager.family \u0026\u0026 userDataManager.family.length \u003e 0) {\n            const familyItemTemplate = document.querySelector(\".family-info-item_template\");\n\n            for (let item of userDataManager.family) {\n                const familyItemContent = familyItemTemplate.content.cloneNode(true);\n                const familyItem = familyItemContent.querySelector(\".family-info-item\");\n                const familyItemLabel = familyItem.querySelector(\".family-info-item_label\");\n                const familyItemValue = familyItem.querySelector(\".family-info-item_value\");\n\n                familyItemLabel.textContent = item.relation\n                familyItemValue.textContent = item.name;\n\n                familyInfoContainer.append(familyItem);\n            };\n        } else {\n            const emptyFamilyTemplate = document.querySelector(\".kedo__my-profle_docs-family-info_content_empty\");\n            if (emptyFamilyTemplate.classList.contains(\"hidden\")) {\n                emptyFamilyTemplate.classList.toggle(\"hidden\");\n            };\n        };\n\n        if (userDataManager.categories \u0026\u0026 userDataManager.categories.length \u003e 0) {\n            const categoryItemTemplate = document.querySelector(\".misc-info-item-category_template\");\n\n            for (let item of userDataManager.categories) {\n                const categoryItemContent = categoryItemTemplate.content.cloneNode(true);\n                const categoryItem = categoryItemContent.querySelector(\".misc-info-item-category\");\n                const categoryItemValue = categoryItem.querySelector(\".misc-info-category_value\");\n\n                categoryItemValue.innerHTML = `${item.name} \u003cbr\u003eДействует до: ${item.expiration_date}`;\n\n                categoryInfoContainer.append(categoryItem);\n            };\n        } else {\n            // const defaultCategoryTemplate = document.querySelector(\".misc-info-item-category\");\n            // if (defaultCategoryTemplate.classList.contains(\"hidden\")) {\n            //     defaultCategoryTemplate.classList.toggle(\"hidden\");\n            // };\n            const categoryItemTemplate = document.querySelector(\".category-info-item_template\");\n            const categoryItemContent = categoryItemTemplate.content.cloneNode(true);\n            const categoryItem = categoryItemContent.querySelector(\".default-category\");\n            categoryInfoContainer.append(categoryItem);\n        };\n\n        this.handleLoader(LoaderType.PROFILE);\n    };\n\n    handleLoader(loaderType: LoaderType) {\n        const waitForLoader = window.setInterval(() =\u003e {\n            const loader = document.querySelector(`.kedo-loader-wrapper[data-loader=${loaderType}]`);\n            if (!loader) {\n                return\n            };\n            window.clearInterval(waitForLoader)\n            loader.classList.toggle(\"hidden\");\n\n        }, 100)\n    };\n}\n\n/**\n * Функция для сброса компонентов внутри контейнеров при обновлении данных страницы\n * @param containers массив с DOM-элементами\n * @param classToDelete при указании класса - удаляет элементы с подходящим классом внутри контейнера\n */\nfunction refreshContainers(containers: any[], classToDelete?: string): void {\n    if (classToDelete) {\n        Array.from(containers).forEach((container: any) =\u003e {\n            const nodesToDelete = container.querySelectorAll(`.${classToDelete}`);\n            nodesToDelete.forEach((node: any) =\u003e {\n                node.remove();\n            });\n        });\n\n        return;\n    };\n\n    containers.forEach((container: any) =\u003e {\n        container.innerHTML = \"\";\n    });\n};\n\n/**\n * Функция используется для получения всех динамических данных, связанных с пользователем (документы, задачи)\n * @param refresh признак того, что идет обновление данных\n * @param refreshTasks признак того, что нужно только обновление задач\n */\nasync function getOrRefreshData(): Promise\u003cvoid\u003e {\n\n    userDataManager.categories = userDataManager.staff.data.categories_table ? await Promise.all(userDataManager.staff.data.categories_table.map(async row =\u003e {\n        return {\n            name: await row.staff_categories.fetch().then(item =\u003e item.data.__name),\n            expiration_date: row.expiration_date ? row.expiration_date.format(\"DD.MM.YYYY\") : \"Без срока\",\n            assignment_date: row.assignment_date ? row.assignment_date.format(\"DD.MM.YYYY\") : \"Без срока\"\n        };\n    })) : [];\n\n    const userFamily = await Context.fields.family_composition_app.app.search().where((f, g) =\u003e g.and(\n        f.__deletedAt.eq(null),\n        f.staff.link(userDataManager.staff)\n    )).size(100).all().then(data =\u003e data.map(item =\u003e {\n        return {\n            name: item.data.full_name ? `${item.data.full_name.lastname} ${item.data.full_name.firstname} ${item.data.full_name.middlename || \"\"}` : \"\",\n            relation: item.data.relation_degree ? item.data.relation_degree.name : \"Не указан\"\n        };\n    }));\n\n    userDataManager.family = userFamily;\n\n    domManager.renderProfileSection();\n};\n\n/**\n * Функция используется для отрисовки и обновления компонентов после того, как все данные загрузились (userDataManager.allDocsLoaded = true)\n * @param refresh признако того, что идёт обновление данных\n */\nfunction renderOrRefreshComponents() {\n    getOrRefreshData();\n    Context.data.event_listeners_set = true;\n};\n\nasync function getData() {\n    const currentUser = await System.users.getCurrentUser();\n    const currentStaff = await Context.fields.staff_app.app.search().where(f =\u003e f.ext_user.in([currentUser])).first();\n\n    if (currentStaff) {\n        userDataManager.staff = currentStaff;\n        Context.data.staff_app = currentStaff;\n        userDataManager.user = \u003cCurrentUserItem\u003ecurrentUser;\n    }\n}\n\nconst userDataManager = new UserDataManager();\nconst domManager = new DomManager();\n\nasync function onInit() {\n    await getData();\n}\n\nasync function onLoad() {\n    domManager.renderProfileSection();\n}",
    "clientScriptOptions": {
      "allowServer": true
    },
    "serverScripts": "/* Server scripts module */\n",
    "serverScriptOptions": {}
  },
  "dataNamespace": "",
  "dataCode": "",
  "runtime": {
    "version": 1,
    "clientScripts": "System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server, System) {\n        let LoaderType;\n        (function (LoaderType) {\n            LoaderType[\"COMMON\"] = \"common\";\n            LoaderType[\"MAIN\"] = \"main\";\n            LoaderType[\"TASKS\"] = \"tasks\";\n            LoaderType[\"DOCUMENTS\"] = \"documents\";\n            LoaderType[\"SERVICES\"] = \"services\";\n            LoaderType[\"BUSINESS_TRIPS\"] = \"business_trips\";\n            LoaderType[\"VACATIONS\"] = \"vacations\";\n            LoaderType[\"PROFILE\"] = \"profile\";\n            LoaderType[\"DOCUMENTS_WIDGET\"] = \"personnel_documents_widget\";\n            LoaderType[\"ISSUES_WIDGET\"] = \"issues_widget\";\n            LoaderType[\"VACATION_WIDGET\"] = \"vacation_widget\";\n        })(LoaderType || (LoaderType = {}));\n        ;\n        class UserDataManager {\n        }\n        ;\n        class DomManager {\n            constructor() {\n                this.userInfoTemplateContent = undefined;\n                this.loader = undefined;\n                this.parser = new DOMParser();\n                this.domLoaded = false;\n            }\n            ;\n            renderProfileSection() {\n                function setMiscItems(event) {\n                    let target = event.target;\n                    const choice = event.target.dataset[\"choice\"];\n                    const otherButton = choice === \"family\" ? document.querySelector(\"[data-choice='category']\") : document.querySelector(\"[data-choice='family']\");\n                    if (event.target.classList.contains(\"misc-button-title\")) {\n                        target = choice === \"family\" ? document.querySelector(\"[data-choice='family']\") : document.querySelector(\"[data-choice='category']\");\n                    }\n                    const itemToShow = document.querySelector(`#${choice}`);\n                    const otherItem = choice === \"family\" ? document.querySelector(\"#category\") : document.querySelector(\"#family\");\n                    itemToShow.classList.toggle(\"hidden\");\n                    otherItem.classList.toggle(\"hidden\");\n                    [target, otherButton].forEach(item =\u003e item.classList.toggle(\"pressed\"));\n                }\n                if (!Context.data.event_listeners_set) {\n                    const buttons = document.querySelectorAll(\".misc-button\");\n                    buttons.forEach((button) =\u003e button.addEventListener(\"click\", setMiscItems, true));\n                }\n                const familyInfoContainer = document.querySelector(\".kedo__my-profle_docs-family-info_content\");\n                const categoryInfoContainer = document.querySelector(\".kedo__my-profle_docs-category-info_content\");\n                refreshContainers([categoryInfoContainer], \"misc-info-item-category\");\n                refreshContainers([familyInfoContainer], \"family-info-item\");\n                if (userDataManager.family \u0026\u0026 userDataManager.family.length \u003e 0) {\n                    const familyItemTemplate = document.querySelector(\".family-info-item_template\");\n                    for (let item of userDataManager.family) {\n                        const familyItemContent = familyItemTemplate.content.cloneNode(true);\n                        const familyItem = familyItemContent.querySelector(\".family-info-item\");\n                        const familyItemLabel = familyItem.querySelector(\".family-info-item_label\");\n                        const familyItemValue = familyItem.querySelector(\".family-info-item_value\");\n                        familyItemLabel.textContent = item.relation;\n                        familyItemValue.textContent = item.name;\n                        familyInfoContainer.append(familyItem);\n                    }\n                    ;\n                }\n                else {\n                    const emptyFamilyTemplate = document.querySelector(\".kedo__my-profle_docs-family-info_content_empty\");\n                    if (emptyFamilyTemplate.classList.contains(\"hidden\")) {\n                        emptyFamilyTemplate.classList.toggle(\"hidden\");\n                    }\n                    ;\n                }\n                ;\n                if (userDataManager.categories \u0026\u0026 userDataManager.categories.length \u003e 0) {\n                    const categoryItemTemplate = document.querySelector(\".misc-info-item-category_template\");\n                    for (let item of userDataManager.categories) {\n                        const categoryItemContent = categoryItemTemplate.content.cloneNode(true);\n                        const categoryItem = categoryItemContent.querySelector(\".misc-info-item-category\");\n                        const categoryItemValue = categoryItem.querySelector(\".misc-info-category_value\");\n                        categoryItemValue.innerHTML = `${item.name} \u003cbr\u003eДействует до: ${item.expiration_date}`;\n                        categoryInfoContainer.append(categoryItem);\n                    }\n                    ;\n                }\n                else {\n                    const categoryItemTemplate = document.querySelector(\".category-info-item_template\");\n                    const categoryItemContent = categoryItemTemplate.content.cloneNode(true);\n                    const categoryItem = categoryItemContent.querySelector(\".default-category\");\n                    categoryInfoContainer.append(categoryItem);\n                }\n                ;\n                this.handleLoader(LoaderType.PROFILE);\n            }\n            ;\n            handleLoader(loaderType) {\n                const waitForLoader = window.setInterval(() =\u003e {\n                    const loader = document.querySelector(`.kedo-loader-wrapper[data-loader=${loaderType}]`);\n                    if (!loader) {\n                        return;\n                    }\n                    ;\n                    window.clearInterval(waitForLoader);\n                    loader.classList.toggle(\"hidden\");\n                }, 100);\n            }\n            ;\n        }\n        function refreshContainers(containers, classToDelete) {\n            if (classToDelete) {\n                Array.from(containers).forEach((container) =\u003e {\n                    const nodesToDelete = container.querySelectorAll(`.${classToDelete}`);\n                    nodesToDelete.forEach((node) =\u003e {\n                        node.remove();\n                    });\n                });\n                return;\n            }\n            ;\n            containers.forEach((container) =\u003e {\n                container.innerHTML = \"\";\n            });\n        }\n        ;\n        async function getOrRefreshData() {\n            userDataManager.categories = userDataManager.staff.data.categories_table ? await Promise.all(userDataManager.staff.data.categories_table.map(async (row) =\u003e {\n                return {\n                    name: await row.staff_categories.fetch().then(item =\u003e item.data.__name),\n                    expiration_date: row.expiration_date ? row.expiration_date.format(\"DD.MM.YYYY\") : \"Без срока\",\n                    assignment_date: row.assignment_date ? row.assignment_date.format(\"DD.MM.YYYY\") : \"Без срока\"\n                };\n            })) : [];\n            const userFamily = await Context.fields.family_composition_app.app.search().where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.staff.link(userDataManager.staff))).size(100).all().then(data =\u003e data.map(item =\u003e {\n                return {\n                    name: item.data.full_name ? `${item.data.full_name.lastname} ${item.data.full_name.firstname} ${item.data.full_name.middlename || \"\"}` : \"\",\n                    relation: item.data.relation_degree ? item.data.relation_degree.name : \"Не указан\"\n                };\n            }));\n            userDataManager.family = userFamily;\n            domManager.renderProfileSection();\n        }\n        ;\n        function renderOrRefreshComponents() {\n            getOrRefreshData();\n            Context.data.event_listeners_set = true;\n        }\n        ;\n        async function getData() {\n            const currentUser = await System.users.getCurrentUser();\n            const currentStaff = await Context.fields.staff_app.app.search().where(f =\u003e f.ext_user.in([currentUser])).first();\n            if (currentStaff) {\n                userDataManager.staff = currentStaff;\n                Context.data.staff_app = currentStaff;\n                userDataManager.user = currentUser;\n            }\n        }\n        const userDataManager = new UserDataManager();\n        const domManager = new DomManager();\n        async function onInit() {\n            await getData();\n        }\n        async function onLoad() {\n            domManager.renderProfileSection();\n        }\n        return {\n            refreshContainers,\n            getOrRefreshData,\n            renderOrRefreshComponents,\n            getData,\n            onInit,\n            onLoad\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n",
    "clientFnDeclarations": [
      {
        "name": "refreshContainers",
        "parameters": [
          {
            "name": "[object Object]",
            "type": "[object Object]"
          },
          {
            "name": "[object Object]",
            "type": "[object Object]"
          }
        ],
        "type": "[object Object]"
      },
      {
        "name": "getOrRefreshData",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "renderOrRefreshComponents",
        "parameters": [],
        "type": ""
      },
      {
        "name": "getData",
        "parameters": [],
        "type": ""
      },
      {
        "name": "onInit",
        "parameters": [],
        "type": ""
      },
      {
        "name": "onLoad",
        "parameters": [],
        "type": ""
      }
    ]
  },
  "__createdAt": "2024-06-04T12:07:26.771849046Z",
  "__createdBy": "7e61e9a9-edda-49a3-baa2-87b36c4fbb6c",
  "__updatedAt": "2024-06-07T06:47:54.791548325Z",
  "__updatedBy": "7e61e9a9-edda-49a3-baa2-87b36c4fbb6c",
  "__deletedAt": null
}
