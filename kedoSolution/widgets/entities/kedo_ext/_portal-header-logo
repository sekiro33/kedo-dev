{
  "__id": "018f09bd-56a0-7f29-9c49-07d619f75b22",
  "namespace": "kedo_ext",
  "code": "_portal-header-logo",
  "__name": "Виджет заголовка страницы",
  "description": "",
  "extensionZoneCode": "",
  "sort": 0,
  "category": "00000000-0000-0000-0000-000000000000",
  "version": 6,
  "hidden": false,
  "draft": false,
  "readonly": false,
  "descriptor": {
    "types": ["default", "portal-header"],
    "template": {
      "id": "c0c461f1-42bd-4357-a76f-1575ea4ab29c",
      "descriptor": "component",
      "content": {
        "": [
          {
            "id": "70e14589-a1c8-481b-bd37-236302e415d5",
            "descriptor": "code",
            "values": {
              "html": "\u003cstyle\u003e\n.portal-header__bar {\n    width: calc(100vw - 40px);\n    height: 60px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n}\n\n.portal-header__bar:before,\n.portal-header__bar:after {\n    content: \"\";\n    display: table;\n    clear: both;\n}\n\n.portal-header__bar .portal-header__bar-item {\n    padding: 8px 16px 8px 0px;\n    float: left;\n    width: auto;\n    border: none;\n    display: block;\n    outline: 0;\n}\n\n.portal-header__bar .portal-header__bar-logo {\n    margin-left: 15px;\n    height: 32px;\n    width: 32px;\n    background-size: contain;\n    background-repeat: no-repeat;\n}\n\n.portal-header__bar .portal-header__user {\n    position: fixed;\n    right: 0;\n    margin-right: 0px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    height: 60px;\n}\n\n@media screen and (max-width: 992px) {\n    .portal-header__user {\n        display: none !important;\n    }\n}\n\n.portal-header__bar .portal-header__partner-text {\n    font-style: normal;\n    font-weight: normal;\n    line-height: 32px;\n    font-size: 24px;\n    display: flex;\n    align-items: center;\n    text-transform: uppercase;\n    color: #062543;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.portal-header__bar .portal-mobile-menu {\n    margin-left: auto;\n    display: flex;\n    align-items: center;\n    height: 60px;\n}\n\n@media screen and (min-width: 993px) {\n    .portal-mobile-menu {\n        display: none !important;\n    }\n}\n\n.portal-header__user-name {\n    font-style: normal;\n    font-weight: 600;\n    font-size: 14px;\n    line-height: 22px;\n    color: #062543;\n    margin-left: 16px;\n}\n\n.portal-header__company {\n    font-style: normal;\n    font-weight: normal;\n    font-size: 12px;\n    line-height: 20px;\n    color: #062543;\n    margin-left: 16px;\n}\n\n.portal-header__user_logout {\n    margin: 16px 0 20px 30px;\n    font-style: normal;\n    font-weight: normal;\n    font-size: 16px;\n    line-height: 24px;\n    color: #5082E6;\n}\n\n.portal-header__user_logout:hover {\n    cursor: pointer;\n}\n\n.portal-header__modal {\n    display: none;\n    position: absolute;\n    z-index: 9000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow-y: hidden;\n    background-color: rgb(0,0,0);\n    background-color: rgba(0,0,0,0.4);\n}\n\n.portal-header__modal-content {\n    background-color: #fefefe;\n    width: 100%;\n    height: 100%;\n    overflow-y: initial;\n}\n\n.portal-header__modal-close {\n    padding-right: 36px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    color: #fff;\n    font-size: 24px;\n}\n\n.portal-header__mobile-menu {\n    display: flex;\n    flex-direction: column;\n    background-color: #1e6599;\n}\n\n.portal-header__mobile-menu-item {\n    width: 100%;\n    height: 60px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: stretch;\n    line-height: 20px;\n    padding: 20px 18px;\n}\n\n.portal-header__mobile-menu-item-logout i {\n    margin-left: 4px;\n    margin-right: 12px;\n    color: #595959;\n}\n\n.portal-header__mobile-menu-item-logout span {\n    color: #595959;\n}\n\n.portal-header__mobile-menu-item__wrap {\n    display: block;\n}\n\n.portal-header__mobile-menu-item-icon {\n    margin-right: 16px;\n    color: #1e6599;\n}\n\n.portal-header__mobile-menu-item-label {\n    color: #000;\n}\n\n.portal-header__mobile-menu-header {\n    display: flex;\n    flex-direction: row;\n    height: 60px;\n    justify-content: space-between;\n}\n\n.kedo_ext-header__mobile-menu-body {\n    background-color: #fefefe;\n    overflow-y: auto;\n    border-radius: 30px 30px 0px 0px;\n    height: calc(100vh - 60px - 60px); // mobile-menu-header height\n}\n\n.portal-header__mobile-menu-delimiter {\n    margin: 0px;\n}\n\n.portal-header__mobile-menu-footer {\n    background-color: #fefefe;\n}\n\n.portal-header__mobile-menu-title {\n    display: flex;\n    align-items: center;\n    color: #fff;\n    font-size: 21px;\n    font-weight: 400;\n    line-height: normal;\n    display: flex;\n    padding: 20px;\n}\n\u003c/style\u003e\n\n\u003cdiv class=\"portal-header__bar \"\u003e\n    \u003ca href=\"\u003c%= getStartPageURL() %\u003e\" class=\"portal-header__bar-item\"\u003e\u003cimg class=\"portal-header__bar-logo\" src=\"\u003c%= getLogoSrc() %\u003e\"\u003e\u003c/a\u003e\n    \u003c% if(getHeaderText()) {%\u003e\n    \u003cdiv class=\"portal-header__bar-item portal-header__partner-text\"\u003e\u003c%= getHeaderText() %\u003e\u003c/div\u003e\n    \u003c% } %\u003e\n    \u003cdiv class=\"portal-header__bar-item portal-header__user\"\u003e\n        \u003cdiv\u003e\n            \u003cdiv class=\"portal-header__user-name\"\u003e\u003c%= getUserFIO() %\u003e\u003c/div\u003e\n            \u003cdiv class=\"portal-header__company\"\u003e\u003c%= getCompanyName() %\u003e\u003c/div\u003e\n        \u003c/div\u003e\n        \u003ca onclick=\"\u003c%- Scripts %\u003e.logoutCurrentUser();\" class=\"portal-header__user_logout\"\u003eВыйти\u003c/a\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"portal-header__bar-item portal-mobile-menu\"\u003e\n        \u003ca onclick=\"\u003c%- Scripts %\u003e.showMobileMenu();\"\u003e\u003ci class=\"elma-icons md-24\"\u003emenu_burger\u003c/i\u003e\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv id=\"d1c4a7fe-ba3d-4bdd-bfa7-93a58c4ec7ba\"\u003e\n    \u003cdiv id=\"df0aa1ba-23a2-4077-817d-2a12fe3aa049\" class=\"portal-header__modal\"\u003e\n        \u003cdiv class=\"portal-header__modal-content\"\u003e\n            \u003cdiv class=\"portal-header__mobile-menu\"\u003e\n                \u003cdiv class=\"portal-header__mobile-menu-header\"\u003e\n                    \u003cdiv class=\"portal-header__mobile-menu-title\"\u003e\n                        \u003c%= getUserFIO() %\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\"portal-header__modal-close\"\u003e\n                        \u003ca onclick=\"\u003c%- Scripts %\u003e.closeMobileMenu();\"\u003e\n                            \u003ci class=\"elma-icons md-24\"\u003esystem_close\u003c/i\u003e\n                        \u003c/a\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"portal-header__mobile-menu-body\"\u003e\n                    \u003c%for(var item of getNavigationItems()) {%\u003e\n                        \u003cdiv class=\"portal-header__mobile-menu-item__wrap\"\u003e\n                            \u003ca\n                                class=\"portal-header__mobile-menu-item\"\n                                onclick=\"\u003c%- Scripts %\u003e.closeMobileMenu();\"\n                                href=\"\u003c%= item.url %\u003e\"\n                            \u003e\n                                \u003ci class=\"portal-header__mobile-menu-item-icon elma-icons md-24\"\n                                \u003efile_type_text\u003c/i\n                                \u003e\u003cspan class=\"portal-header__mobile-menu-item-label\"\u003e\u003c%= item.name %\u003e\u003c/span\u003e\n                            \u003c/a\u003e\n                        \u003c/div\u003e\n                    \u003c%}%\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"portal-header__mobile-menu-footer\"\u003e\n                    \u003chr class=\"portal-header__mobile-menu-delimiter\"\u003e\n                    \u003cdiv class=\"portal-header__mobile-menu-item__wrap\"\u003e\n                        \u003ca\n                            class=\"portal-header__mobile-menu-item portal-header__mobile-menu-item-logout\"\n                            onclick=\"\u003c%- Scripts %\u003e.logoutCurrentUser();\"\n                        \u003e\n                            \u003ci class=\"portal-header__mobile-menu-item-icon elma-icons md-24\"\n                            \u003esystem_logout\u003c/i\u003e\n                            \u003cspan class=\"portal-header__mobile-menu-item-label\"\u003eВыход\u003c/span\u003e\n                        \u003c/a\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cdiv id=\"fd164163-fdf1-4a56-bcb5-5d8bd1cdaeda\" class=\"portal-header__modal\"\u003e\n        CustomModalBody\n    \u003c/div\u003e\n\u003c/div\u003e\n"
            }
          }
        ]
      }
    },
    "scriptOptions": {},
    "clientScripts": "/* Client scripts module */\ndeclare var document: any;\n\nconst modalsContainerId = 'd1c4a7fe-ba3d-4bdd-bfa7-93a58c4ec7ba';\nconst mobileMenuModalId = 'df0aa1ba-23a2-4077-817d-2a12fe3aa049';\nconst mobileCustomModalId = 'fd164163-fdf1-4a56-bcb5-5d8bd1cdaeda';\n\nclass menuModal {\n    private name: string;\n    private element: any;\n\n    constructor(\n        readonly elementId: string,\n    ){\n        this.name = elementId;\n        this.element = document.getElementById(elementId);\n        this.addToBody();\n    }\n\n    getName(): string {\n        return this.name;\n    }\n\n    show() {\n        this.element.style.display = \"block\";\n    }\n\n    hide() {\n        this.element.style.display = \"none\";\n    }\n\n    private addToBody() {\n        document.body.appendChild(this.element);\n    }\n\n    removeFromBody() {\n        let header_modals: any;\n        this.hide();\n        header_modals = document.getElementById(modalsContainerId);\n        header_modals.appendChild(this.element);\n    }\n}\n\nclass menuModals {\n    private modals: menuModal[] = [];\n\n    private getModal(elementId: string): menuModal | undefined {\n        return this.modals.find(m =\u003e m.getName() === elementId);\n    }\n\n    addModal(elementId: string) {\n        this.modals.push(new menuModal(elementId));\n    }\n\n    initModals() {\n        this.addModal(mobileMenuModalId);\n        this.addModal(mobileCustomModalId);\n    }\n\n    removeModals() {\n        for (let item of \u003cmenuModal[]\u003ethis.modals) {\n            item.removeFromBody();\n        }\n        this.modals = [];\n    }\n\n    show(elementId: string) {\n        const modal = this.getModal(elementId);\n        if (modal) {\n            modal.show()\n        }\n    }\n\n    hide(elementId: string) {\n        const modal = this.getModal(elementId);\n        if (modal) {\n            modal.hide()\n        }\n    }\n}\n\nlet logoImg: string = '/assets/images/elma365.svg';\nlet companyName: string = 'MyCompany';\nlet headerText: string = 'PageHeaderText';\nlet userFIO: string;\nlet navigation_items: PortalPageInfo[] = [];\nconst modals: menuModals = new menuModals();\n\nfunction getLogoSrc(): string {\n    return logoImg;\n}\n\nfunction getHeaderText(): string {\n    return headerText;\n}\n\nfunction getUserFIO(): string {\n    return userFIO;\n}\n\nfunction getCompanyName(): string {\n    return companyName;\n}\n\nfunction getStartPageURL(): string {\n    return `/_portal/${Namespace.code}/_start_page`;\n}\n\nasync function onInit(): Promise\u003cvoid\u003e {\n    const promises: Promise\u003cany\u003e[] = [];\n    promises.push(loadUserInfo(), loadNavigationItems());\n    await Promise.all(promises);\n}\n\nasync function loadUserInfo(): Promise\u003cvoid\u003e {\n    const user = await System.users.getCurrentUser().catch(() =\u003e {\n        return undefined;\n    });\n    if (user) {\n        userFIO = `${user.data.fullname?.firstname} ${user.data.fullname?.lastname}`;\n    }\n}\n\nasync function logoutCurrentUser(): Promise\u003cvoid\u003e {\n    const user = await System.users.getCurrentUser();\n    await user.logout();\n}\n\nasync function loadNavigationItems(): Promise\u003cvoid\u003e {\n    navigation_items = await Namespace.kedo_ext.getPages().catch(() =\u003e {\n        return [];\n    });\n}\n\nfunction getNavigationItems(): PortalPageInfo[] {\n    return navigation_items;\n}\n\nfunction initModals() {\n    modals.initModals();\n}\n\nfunction removeModals() {\n    modals.removeModals();\n}\n\nfunction showMobileMenu() {\n    initModals();\n    modals.show(mobileMenuModalId);\n}\n\nfunction closeMobileMenu() {\n    removeModals();\n}\n",
    "clientScriptOptions": {},
    "serverScriptOptions": {}
  ,"serverScripts":""},
  "dataNamespace": "",
  "dataCode": "",
  "runtime": {
    "version": 1,
    "clientScripts": "System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        const modalsContainerId = 'd1c4a7fe-ba3d-4bdd-bfa7-93a58c4ec7ba';\n        const mobileMenuModalId = 'df0aa1ba-23a2-4077-817d-2a12fe3aa049';\n        const mobileCustomModalId = 'fd164163-fdf1-4a56-bcb5-5d8bd1cdaeda';\n        class menuModal {\n            constructor(elementId) {\n                this.elementId = elementId;\n                this.name = elementId;\n                this.element = document.getElementById(elementId);\n                this.addToBody();\n            }\n            getName() {\n                return this.name;\n            }\n            show() {\n                this.element.style.display = \"block\";\n            }\n            hide() {\n                this.element.style.display = \"none\";\n            }\n            addToBody() {\n                document.body.appendChild(this.element);\n            }\n            removeFromBody() {\n                let header_modals;\n                this.hide();\n                header_modals = document.getElementById(modalsContainerId);\n                header_modals.appendChild(this.element);\n            }\n        }\n        class menuModals {\n            constructor() {\n                this.modals = [];\n            }\n            getModal(elementId) {\n                return this.modals.find(m =\u003e m.getName() === elementId);\n            }\n            addModal(elementId) {\n                this.modals.push(new menuModal(elementId));\n            }\n            initModals() {\n                this.addModal(mobileMenuModalId);\n                this.addModal(mobileCustomModalId);\n            }\n            removeModals() {\n                for (let item of this.modals) {\n                    item.removeFromBody();\n                }\n                this.modals = [];\n            }\n            show(elementId) {\n                const modal = this.getModal(elementId);\n                if (modal) {\n                    modal.show();\n                }\n            }\n            hide(elementId) {\n                const modal = this.getModal(elementId);\n                if (modal) {\n                    modal.hide();\n                }\n            }\n        }\n        let logoImg = '/assets/images/elma365.svg';\n        let companyName = 'MyCompany';\n        let headerText = 'PageHeaderText';\n        let userFIO;\n        let navigation_items = [];\n        const modals = new menuModals();\n        function getLogoSrc() {\n            return logoImg;\n        }\n        function getHeaderText() {\n            return headerText;\n        }\n        function getUserFIO() {\n            return userFIO;\n        }\n        function getCompanyName() {\n            return companyName;\n        }\n        function getStartPageURL() {\n            return `/_portal/${Namespace.code}/_start_page`;\n        }\n        async function onInit() {\n            const promises = [];\n            promises.push(loadUserInfo(), loadNavigationItems());\n            await Promise.all(promises);\n        }\n        async function loadUserInfo() {\n            var _a, _b;\n            const user = await System.users.getCurrentUser().catch(() =\u003e {\n                return undefined;\n            });\n            if (user) {\n                userFIO = `${(_a = user.data.fullname) === null || _a === void 0 ? void 0 : _a.firstname} ${(_b = user.data.fullname) === null || _b === void 0 ? void 0 : _b.lastname}`;\n            }\n        }\n        async function logoutCurrentUser() {\n            const user = await System.users.getCurrentUser();\n            await user.logout();\n        }\n        async function loadNavigationItems() {\n            navigation_items = await Namespace.kedo_ext.getPages().catch(() =\u003e {\n                return [];\n            });\n        }\n        function getNavigationItems() {\n            return navigation_items;\n        }\n        function initModals() {\n            modals.initModals();\n        }\n        function removeModals() {\n            modals.removeModals();\n        }\n        function showMobileMenu() {\n            initModals();\n            modals.show(mobileMenuModalId);\n        }\n        function closeMobileMenu() {\n            removeModals();\n        }\n        return {\n            getLogoSrc,\n            getHeaderText,\n            getUserFIO,\n            getCompanyName,\n            getStartPageURL,\n            onInit,\n            loadUserInfo,\n            logoutCurrentUser,\n            loadNavigationItems,\n            getNavigationItems,\n            initModals,\n            removeModals,\n            showMobileMenu,\n            closeMobileMenu\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n",
    "clientFnDeclarations": [
      {
        "name": "getLogoSrc",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "getHeaderText",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "getUserFIO",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "getCompanyName",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "getStartPageURL",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "onInit",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "loadUserInfo",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "logoutCurrentUser",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "loadNavigationItems",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "getNavigationItems",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "initModals",
        "parameters": [],
        "type": ""
      },
      {
        "name": "removeModals",
        "parameters": [],
        "type": ""
      },
      {
        "name": "showMobileMenu",
        "parameters": [],
        "type": ""
      },
      {
        "name": "closeMobileMenu",
        "parameters": [],
        "type": ""
      }
    ]
  },
  "__createdAt": "2024-04-23T06:55:54.526360681Z",
  "__createdBy": "7e61e9a9-edda-49a3-baa2-87b36c4fbb6c",
  "__updatedAt": "2024-05-13T08:11:57.671028633Z",
  "__updatedBy": "7e61e9a9-edda-49a3-baa2-87b36c4fbb6c",
  "__deletedAt": null
}
