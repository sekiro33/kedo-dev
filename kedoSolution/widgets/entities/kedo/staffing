{
  "__id": "018f1058-ac9f-76ab-931a-1da4938d7fed",
  "namespace": "kedo",
  "code": "staffing",
  "__name": "Штатное расписание ",
  "description": "",
  "extensionZoneCode": "",
  "sort": 0,
  "category": "00000000-0000-0000-0000-000000000000",
  "version": 22,
  "hidden": false,
  "draft": false,
  "readonly": false,
  "descriptor": {
    "icon": "projects",
    "template": {
      "id": "543cede2-af55-4a85-9535-ead10728918f",
      "descriptor": "component",
      "content": {
        "": [
          {
            "id": "59d9ebde-18e5-4c5c-82e2-1b430ea5ac8e",
            "descriptor": "code",
            "values": {
              "html": "\n\u003cdiv class=\"staff-page-wrapper\"\u003e\n  \u003cdiv class=\"staff-header-container\"\u003e\n    \u003cp class=\"staff-header-title\"\u003e\n        \u003cspan class=\"staff-title-partition\"\u003eКЭДО\u003c/span\u003e\n        \u003cspan class=\"staff-title-divider\"\u003e/\u003c/span\u003e\n        \u003cspan class=\"staff-title-app-name\"\u003eШтатное расписание\u003c/span\u003e\n    \u003c/p\u003e\n    \u003cdiv\u003e\n      \u003ca class=\"staff__popup-button staff__new-org-button\"\u003e\n        + Добавить организацию\n      \u003c/a\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"staff-wrapper\"\u003e\n  \u003cdiv class=\"table__row table__header\"\u003e\n      \u003cp class=\"table__name\"\u003eНазвание\u003c/p\u003e\n      \u003cp class=\"table__name\"\u003eКоличество\u003c/p\u003e\n      \u003cp class=\"table__name\"\u003eДата\u003c/p\u003e\n      \u003cp class=\"table__name\"\u003eОклад\u003c/p\u003e\n      \u003cp class=\"table__name\"\u003e\u003c/p\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\n  \u003ctemplate class=\"staff-delete-popup\"\u003e\n    \u003cdiv class=\"staff__backdrop\"\u003e\n      \u003cdiv class=\"staff__popup\"\u003e\n        \u003cdiv class=\"staff__popup-title\"\u003e\n          \u003cp class=\"staff__popup-title-text\"\u003e\u003c/p\u003e\n          \u003cdiv class=\"staff__popup-exit-icon\"\u003e\n            \u003csvg\n              width=\"14\"\n              height=\"14\"\n              viewBox=\"0 0 14 14\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M9.08231 7L13.7951 2.28732C14.0677 2.01477 14.0677 1.57246 13.7951 1.29946L12.7001 0.204419C12.4275 -0.0681396 11.9852 -0.0681396 11.7122 0.204419L6.99978 4.91753L2.28696 0.204856C2.01439 -0.067702 1.57207 -0.067702 1.29907 0.204856L0.204425 1.29946C-0.0681417 1.57202 -0.0681417 2.01433 0.204425 2.28732L4.91725 7L0.204425 11.7127C-0.0681417 11.9852 -0.0681417 12.4275 0.204425 12.7005L1.2995 13.7956C1.57207 14.0681 2.01439 14.0681 2.2874 13.7956L6.99978 9.08247L11.7126 13.7951C11.9852 14.0677 12.4275 14.0677 12.7005 13.7951L13.7956 12.7001C14.0681 12.4275 14.0681 11.9852 13.7956 11.7122L9.08231 7Z\"\n                fill=\"#BFBFBF\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"staff__popup-description\"\u003e\n          \u003cp class=\"staff__popup-description-text\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"staff__popup-controls\"\u003e\n          \u003cbutton class=\"staff__popup-button staff__popup-confirm\"\u003e\n            Да, удалить\n          \u003c/button\u003e\n          \u003cbutton class=\"staff__popup-button staff__popup-cancel\"\u003e\n            Отмена\n          \u003c/button\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \u003ctemplate class=\"staff-add-popup\"\u003e\n    \u003cdiv class=\"staff__backdrop\"\u003e\n      \u003cdiv class=\"staff__popup\"\u003e\n        \u003cdiv class=\"staff__popup-title\"\u003e\n          \u003cp class=\"staff__popup-title-text\"\u003e\u003c/p\u003e\n          \u003cdiv class=\"staff__popup-exit-icon\"\u003e\n            \u003csvg\n              width=\"14\"\n              height=\"14\"\n              viewBox=\"0 0 14 14\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M9.08231 7L13.7951 2.28732C14.0677 2.01477 14.0677 1.57246 13.7951 1.29946L12.7001 0.204419C12.4275 -0.0681396 11.9852 -0.0681396 11.7122 0.204419L6.99978 4.91753L2.28696 0.204856C2.01439 -0.067702 1.57207 -0.067702 1.29907 0.204856L0.204425 1.29946C-0.0681417 1.57202 -0.0681417 2.01433 0.204425 2.28732L4.91725 7L0.204425 11.7127C-0.0681417 11.9852 -0.0681417 12.4275 0.204425 12.7005L1.2995 13.7956C1.57207 14.0681 2.01439 14.0681 2.2874 13.7956L6.99978 9.08247L11.7126 13.7951C11.9852 14.0677 12.4275 14.0677 12.7005 13.7951L13.7956 12.7001C14.0681 12.4275 14.0681 11.9852 13.7956 11.7122L9.08231 7Z\"\n                fill=\"#BFBFBF\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"staff__popup-description\"\u003e\n          \n        \u003c/div\u003e\n        \u003cdiv class=\"staff__popup-controls\"\u003e\n          \u003cbutton class=\"staff__popup-button staff__popup-confirm\"\u003e\n            Добавить\n          \u003c/button\u003e\n          \u003cbutton class=\"staff__popup-button staff__popup-cancel\"\u003e\n            Отмена\n          \u003c/button\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \u003ctemplate class=\"schedule__template--person\"\u003e\n    \u003cdiv class=\"list-item__wrapper list-item__user\"\u003e\n      \u003cdiv class=\"table__row\"\u003e\n        \u003cdiv class=\"list-item-container\"\u003e\n          \u003cdiv class=\"list-item__text-container\"\u003e\n            \u003cp class=\"list-item__text\"\u003e\u003c/p\u003e\n            \u003cp class=\"list-item__sumbol\"\u003e\u003c/p\u003e\n            \u003cp class=\"list-item__new-user\"\u003e\u003c/p\u003e\n          \u003c/div\u003e\n          \n          \u003cdiv class=\"user-card\"\u003e\n            \u003cdiv class=\"user-card__content\"\u003e\n              \u003cdiv class=\"user-card__left-side-content\"\u003e\n                \u003cdiv class=\"user-card__name-container\"\u003e\n                  \u003cp class=\"user-card__name\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"user-card__phone-container\"\u003e\n                  \u003csvg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath d=\"M15.1326 10.312L11.9579 8.95109C11.6729 8.82989 11.3563 8.80427 11.0555 8.87807C10.7548 8.95187 10.486 9.12112 10.2895 9.36046L9.26758 10.6105C7.62832 9.71703 6.281 8.37047 5.38664 6.73171L6.63664 5.70984C6.87598 5.51309 7.0452 5.24416 7.11899 4.94324C7.19278 4.64233 7.16718 4.32562 7.04601 4.04046L5.68726 0.867965C5.55612 0.559222 5.32033 0.306597 5.02135 0.154506C4.72237 0.00241575 4.37934 -0.0394032 4.05258 0.0364024L1.10914 0.71484C0.793309 0.786515 0.511324 0.963658 0.309661 1.21707C0.107999 1.47048 -0.00130566 1.78504 -0.000236369 2.1089C-0.000236369 9.80453 6.23976 16.0027 13.8923 15.9995C14.2161 16.0005 14.5305 15.8911 14.7839 15.6894C15.0372 15.4877 15.2142 15.2056 15.2857 14.8898L15.9638 11.9455C16.0386 11.6189 15.9963 11.2766 15.8444 10.978C15.6924 10.6795 15.4405 10.4438 15.1326 10.312ZM13.8329 14.5023C7.03351 14.4711 1.53101 8.96828 1.49976 2.16515L4.33383 1.51203L5.64914 4.5814L3.52133 6.32234C4.97101 9.41609 6.58976 11.0295 9.67758 12.4786L11.4179 10.3502L14.4863 11.6661L13.8329 14.5023Z\" fill=\"#8C8C8C\"/\u003e\n                  \u003c/svg\u003e\n                  \u003cp class=\"user-card__phone\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"user-card__email-container\"\u003e\n                  \u003csvg width=\"17\" height=\"17\" viewBox=\"0 0 17 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath d=\"M15.4062 2.125H1.59375C0.713535 2.125 0 2.83854 0 3.71875V13.2812C0 14.1615 0.713535 14.875 1.59375 14.875H15.4062C16.2865 14.875 17 14.1615 17 13.2812V3.71875C17 2.83854 16.2865 2.125 15.4062 2.125ZM15.4062 3.71875V5.0736C14.6618 5.67986 13.4749 6.62256 10.9375 8.6094C10.3784 9.04925 9.27071 10.1059 8.5 10.0936C7.72942 10.1061 6.6214 9.04908 6.06246 8.6094C3.52551 6.62286 2.33833 5.67996 1.59375 5.0736V3.71875H15.4062ZM1.59375 13.2812V7.11868C2.35457 7.72467 3.4335 8.57504 5.07802 9.86279C5.80374 10.434 7.07466 11.6951 8.5 11.6875C9.91834 11.6951 11.1732 10.4523 11.9217 9.86305C13.5662 8.57534 14.6454 7.72474 15.4062 7.11872V13.2812H1.59375Z\" fill=\"#8C8C8C\"/\u003e\n                  \u003c/svg\u003e\n                  \u003ca href=\"\" class=\"user-card__email\"\u003e\u003c/a\u003e\n                \u003c/div\u003e\n              \u003c/div\u003e\n              \u003cdiv class=\"user-card__right-side-content\"\u003e\n                \u003cdiv class=\"user-card__image-container\"\u003e\n                  \u003cp class=\"user-card__image-text\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n              \u003c/div\u003e\n            \u003c/div\u003e\n          \u003c/div\u003e\n\n          \u003cdiv class=\"user-card-new\"\u003e\n            \u003cdiv class=\"user-card__content-new\"\u003e\n              \u003cdiv class=\"user-card__left-side-content-new\"\u003e\n                \u003cdiv class=\"user-card__name-container-new\"\u003e\n                  \u003cp class=\"user-card__name-new\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"user-card__phone-container-new\"\u003e\n                  \u003csvg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath d=\"M15.1326 10.312L11.9579 8.95109C11.6729 8.82989 11.3563 8.80427 11.0555 8.87807C10.7548 8.95187 10.486 9.12112 10.2895 9.36046L9.26758 10.6105C7.62832 9.71703 6.281 8.37047 5.38664 6.73171L6.63664 5.70984C6.87598 5.51309 7.0452 5.24416 7.11899 4.94324C7.19278 4.64233 7.16718 4.32562 7.04601 4.04046L5.68726 0.867965C5.55612 0.559222 5.32033 0.306597 5.02135 0.154506C4.72237 0.00241575 4.37934 -0.0394032 4.05258 0.0364024L1.10914 0.71484C0.793309 0.786515 0.511324 0.963658 0.309661 1.21707C0.107999 1.47048 -0.00130566 1.78504 -0.000236369 2.1089C-0.000236369 9.80453 6.23976 16.0027 13.8923 15.9995C14.2161 16.0005 14.5305 15.8911 14.7839 15.6894C15.0372 15.4877 15.2142 15.2056 15.2857 14.8898L15.9638 11.9455C16.0386 11.6189 15.9963 11.2766 15.8444 10.978C15.6924 10.6795 15.4405 10.4438 15.1326 10.312ZM13.8329 14.5023C7.03351 14.4711 1.53101 8.96828 1.49976 2.16515L4.33383 1.51203L5.64914 4.5814L3.52133 6.32234C4.97101 9.41609 6.58976 11.0295 9.67758 12.4786L11.4179 10.3502L14.4863 11.6661L13.8329 14.5023Z\" fill=\"#8C8C8C\"/\u003e\n                  \u003c/svg\u003e\n                  \u003cp class=\"user-card__phone-new\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\"user-card__email-container-new\"\u003e\n                  \u003csvg width=\"17\" height=\"17\" viewBox=\"0 0 17 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\n                    \u003cpath d=\"M15.4062 2.125H1.59375C0.713535 2.125 0 2.83854 0 3.71875V13.2812C0 14.1615 0.713535 14.875 1.59375 14.875H15.4062C16.2865 14.875 17 14.1615 17 13.2812V3.71875C17 2.83854 16.2865 2.125 15.4062 2.125ZM15.4062 3.71875V5.0736C14.6618 5.67986 13.4749 6.62256 10.9375 8.6094C10.3784 9.04925 9.27071 10.1059 8.5 10.0936C7.72942 10.1061 6.6214 9.04908 6.06246 8.6094C3.52551 6.62286 2.33833 5.67996 1.59375 5.0736V3.71875H15.4062ZM1.59375 13.2812V7.11868C2.35457 7.72467 3.4335 8.57504 5.07802 9.86279C5.80374 10.434 7.07466 11.6951 8.5 11.6875C9.91834 11.6951 11.1732 10.4523 11.9217 9.86305C13.5662 8.57534 14.6454 7.72474 15.4062 7.11872V13.2812H1.59375Z\" fill=\"#8C8C8C\"/\u003e\n                  \u003c/svg\u003e\n                  \u003ca href=\"\" class=\"user-card__email-new\"\u003e\u003c/a\u003e\n                \u003c/div\u003e\n              \u003c/div\u003e\n              \u003cdiv class=\"user-card__right-side-content-new\"\u003e\n                \u003cdiv class=\"user-card__image-container-new\"\u003e\n                  \u003cp class=\"user-card__image-text-new\"\u003e\u003c/p\u003e\n                \u003c/div\u003e\n              \u003c/div\u003e\n            \u003c/div\u003e\n          \u003c/div\u003e\n\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__amount\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__date\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__salary\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__actions\"\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \u003ctemplate class=\"schedule__template\"\u003e\n    \u003cdiv class=\"list-item__wrapper\"\u003e\n      \u003cdiv class=\"table__row\"\u003e\n        \u003cdiv class=\"list-item-container\"\u003e\n          \u003cdiv class=\"list-item__arrow\"\u003e\n            \u003csvg\n              width=\"11\"\n              height=\"6\"\n              viewBox=\"0 0 11 6\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M5.2664 0.152345L9.8914 4.73984C10.0383 4.88672 10.0383 5.12422 9.8914 5.27109L9.27265 5.88984C9.12578 6.03672 8.88828 6.03672 8.7414 5.88984L5.00077 2.18672L1.26015 5.88984C1.11327 6.03672 0.875773 6.03672 0.728899 5.88984L0.110149 5.27109C-0.036726 5.12422 -0.036726 4.88672 0.110149 4.73984L4.73515 0.152345C4.88202 0.0054698 5.11952 0.0054698 5.2664 0.152345Z\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cdiv class=\"list-item__folder\"\u003e\n            \u003csvg\n              width=\"25\"\n              height=\"16\"\n              viewBox=\"0 0 25 16\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M22.9131 6.66667H20.834V4.66667C20.834 3.5625 19.9008 2.66667 18.7506 2.66667H11.8059L9.02807 0H2.0834C0.93319 0 0 0.895833 0 2V14C0 15.1042 0.93319 16 2.0834 16H19.4451C20.1612 16 20.8297 15.6458 21.2116 15.0583L24.6796 9.725C25.5477 8.39583 24.5494 6.66667 22.9131 6.66667ZM2.0834 2.25C2.0834 2.1125 2.20059 2 2.34383 2H8.16433L10.9422 4.66667H18.4902C18.6334 4.66667 18.7506 4.77917 18.7506 4.91667V6.66667H6.59744C5.86825 6.66667 5.19114 7.03333 4.81353 7.63333L2.0834 11.975V2.25ZM19.4451 14H3.1251L6.47591 8.66667H22.9174L19.4451 14Z\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cdiv class=\"list-item__text-container\"\u003e\n            \u003cp class=\"list-item__text\"\u003e\u003c/p\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__amount\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__date\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__info-cell\"\u003e\n          \u003cp class=\"list-item__salary\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"list-item__actions list-item__actions--enabled\"\u003e\n          \u003csvg\n            width=\"14\"\n            height=\"3\"\n            viewBox=\"0 0 14 3\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          \u003e\n            \u003cpath\n              d=\"M8.55556 1.5C8.55556 0.671875 7.8588 0 7 0C6.1412 0 5.44444 0.671875 5.44444 1.5C5.44444 2.32812 6.1412 3 7 3C7.8588 3 8.55556 2.32812 8.55556 1.5ZM12.4444 3C11.5856 3 10.8889 2.32812 10.8889 1.5C10.8889 0.671875 11.5856 0 12.4444 0C13.3032 0 14 0.671875 14 1.5C14 2.32812 13.3032 3 12.4444 3ZM1.55556 3C0.696759 3 0 2.32812 0 1.5C0 0.671875 0.696759 0 1.55556 0C2.41435 0 3.11111 0.671875 3.11111 1.5C3.11111 2.32812 2.41435 3 1.55556 3Z\"\n            /\u003e\n          \u003c/svg\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"list-item__children\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \n\n  \u003ctemplate class=\"options-template\"\u003e\n    \u003cdiv class=\"list-item__options-popup\"\u003e\n      \u003cul class=\"option-list\"\u003e\n        \u003ca class=\"option-list__item option-list__add-department\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"12\"\n              height=\"12\"\n              viewBox=\"0 0 12 12\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cline\n                x1=\"5.89288\"\n                x2=\"5.89288\"\n                y2=\"12\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n              \u003cline\n                y1=\"6.10718\"\n                x2=\"12\"\n                y2=\"6.10718\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eПодразделение\u003c/p\u003e\n        \u003c/a\u003e\n        \u003ca class=\"option-list__item option-list__add-position\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"12\"\n              height=\"12\"\n              viewBox=\"0 0 12 12\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cline\n                x1=\"5.89288\"\n                x2=\"5.89288\"\n                y2=\"12\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n              \u003cline\n                y1=\"6.10718\"\n                x2=\"12\"\n                y2=\"6.10718\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eДолжность\u003c/p\u003e\n        \u003c/a\u003e\n        \u003cli\u003e\n          \u003ca href=\"\" class=\"option-list__item option-list__edit\"\u003e\n              \u003cdiv class=\"option-list__icon\"\u003e\n                \u003ci _ngcontent-fwf-c252=\"\" class=\"elma-icons md-14\"\u003etool_pen\u003c/i\u003e\n              \u003c/div\u003e\n              \u003cp class=\"option-list__text option-list__edit-text\"\u003eРедактировать\u003c/p\u003e\n          \u003c/a\u003e\n        \u003c/li\u003e\n        \u003cli class=\"option-list__item option-list__delete\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"13\"\n              height=\"15\"\n              viewBox=\"0 0 13 15\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M7.77679 12.1875H8.47321C8.56557 12.1875 8.65414 12.1505 8.71944 12.0845C8.78474 12.0186 8.82143 11.9292 8.82143 11.8359V5.50781C8.82143 5.41457 8.78474 5.32515 8.71944 5.25922C8.65414 5.19329 8.56557 5.15625 8.47321 5.15625H7.77679C7.68443 5.15625 7.59586 5.19329 7.53056 5.25922C7.46526 5.32515 7.42857 5.41457 7.42857 5.50781V11.8359C7.42857 11.9292 7.46526 12.0186 7.53056 12.0845C7.59586 12.1505 7.68443 12.1875 7.77679 12.1875ZM12.5357 2.34375H10.1444L9.15775 0.682617C9.03393 0.474321 8.85878 0.30196 8.64936 0.182331C8.43994 0.0627019 8.2034 -0.000115529 7.96279 1.59506e-07H5.03721C4.79669 -1.43194e-05 4.56027 0.0628512 4.35097 0.182475C4.14166 0.3021 3.9666 0.474406 3.84283 0.682617L2.85565 2.34375H0.464286C0.341149 2.34375 0.223057 2.39314 0.135986 2.48104C0.0489157 2.56895 0 2.68818 0 2.8125L0 3.28125C0 3.40557 0.0489157 3.5248 0.135986 3.61271C0.223057 3.70061 0.341149 3.75 0.464286 3.75H0.928571V13.5938C0.928571 13.9667 1.07532 14.3244 1.33653 14.5881C1.59774 14.8518 1.95202 15 2.32143 15H10.6786C11.048 15 11.4023 14.8518 11.6635 14.5881C11.9247 14.3244 12.0714 13.9667 12.0714 13.5938V3.75H12.5357C12.6588 3.75 12.7769 3.70061 12.864 3.61271C12.9511 3.5248 13 3.40557 13 3.28125V2.8125C13 2.68818 12.9511 2.56895 12.864 2.48104C12.7769 2.39314 12.6588 2.34375 12.5357 2.34375ZM4.98643 1.4915C5.00195 1.46543 5.0239 1.44386 5.05015 1.42892C5.07639 1.41398 5.10603 1.40616 5.13616 1.40625H7.86384C7.89392 1.40622 7.9235 1.41405 7.94969 1.42899C7.97588 1.44393 7.99779 1.46547 8.01328 1.4915L8.51993 2.34375H4.48007L4.98643 1.4915ZM10.6786 13.5938H2.32143V3.75H10.6786V13.5938ZM4.52679 12.1875H5.22321C5.31557 12.1875 5.40414 12.1505 5.46944 12.0845C5.53474 12.0186 5.57143 11.9292 5.57143 11.8359V5.50781C5.57143 5.41457 5.53474 5.32515 5.46944 5.25922C5.40414 5.19329 5.31557 5.15625 5.22321 5.15625H4.52679C4.43443 5.15625 4.34586 5.19329 4.28056 5.25922C4.21526 5.32515 4.17857 5.41457 4.17857 5.50781V11.8359C4.17857 11.9292 4.21526 12.0186 4.28056 12.0845C4.34586 12.1505 4.43443 12.1875 4.52679 12.1875Z\"\n                fill=\"#4B4B4B\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eУдалить\u003c/p\u003e\n        \u003c/li\u003e\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \u003ctemplate class=\"options-template__legal\"\u003e\n    \u003cdiv class=\"list-item__options-popup\"\u003e\n      \u003cul class=\"option-list\"\u003e\n        \u003ca class=\"option-list__item option-list__add-department\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"12\"\n              height=\"12\"\n              viewBox=\"0 0 12 12\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cline\n                x1=\"5.89288\"\n                x2=\"5.89288\"\n                y2=\"12\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n              \u003cline\n                y1=\"6.10718\"\n                x2=\"12\"\n                y2=\"6.10718\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eПодразделение\u003c/p\u003e\n        \u003c/a\u003e\n        \u003ca class=\"option-list__item option-list__add-position\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"12\"\n              height=\"12\"\n              viewBox=\"0 0 12 12\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cline\n                x1=\"5.89288\"\n                x2=\"5.89288\"\n                y2=\"12\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n              \u003cline\n                y1=\"6.10718\"\n                x2=\"12\"\n                y2=\"6.10718\"\n                stroke=\"#4B4B4B\"\n                stroke-width=\"1.5\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eДолжность\u003c/p\u003e\n        \u003c/a\u003e\n        \u003cli\u003e\n          \u003ca href=\"\" class=\"option-list__item option-list__edit\"\u003e\n              \u003cdiv class=\"option-list__icon\"\u003e\n                \u003ci _ngcontent-fwf-c252=\"\" class=\"elma-icons md-14\"\u003etool_pen\u003c/i\u003e\n              \u003c/div\u003e\n              \u003cp class=\"option-list__text option-list__edit-text\"\u003eРедактировать\u003c/p\u003e\n          \u003c/a\u003e\n        \u003c/li\u003e\n        \u003cli class=\"option-list__item option-list__delete\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"13\"\n              height=\"15\"\n              viewBox=\"0 0 13 15\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M7.77679 12.1875H8.47321C8.56557 12.1875 8.65414 12.1505 8.71944 12.0845C8.78474 12.0186 8.82143 11.9292 8.82143 11.8359V5.50781C8.82143 5.41457 8.78474 5.32515 8.71944 5.25922C8.65414 5.19329 8.56557 5.15625 8.47321 5.15625H7.77679C7.68443 5.15625 7.59586 5.19329 7.53056 5.25922C7.46526 5.32515 7.42857 5.41457 7.42857 5.50781V11.8359C7.42857 11.9292 7.46526 12.0186 7.53056 12.0845C7.59586 12.1505 7.68443 12.1875 7.77679 12.1875ZM12.5357 2.34375H10.1444L9.15775 0.682617C9.03393 0.474321 8.85878 0.30196 8.64936 0.182331C8.43994 0.0627019 8.2034 -0.000115529 7.96279 1.59506e-07H5.03721C4.79669 -1.43194e-05 4.56027 0.0628512 4.35097 0.182475C4.14166 0.3021 3.9666 0.474406 3.84283 0.682617L2.85565 2.34375H0.464286C0.341149 2.34375 0.223057 2.39314 0.135986 2.48104C0.0489157 2.56895 0 2.68818 0 2.8125L0 3.28125C0 3.40557 0.0489157 3.5248 0.135986 3.61271C0.223057 3.70061 0.341149 3.75 0.464286 3.75H0.928571V13.5938C0.928571 13.9667 1.07532 14.3244 1.33653 14.5881C1.59774 14.8518 1.95202 15 2.32143 15H10.6786C11.048 15 11.4023 14.8518 11.6635 14.5881C11.9247 14.3244 12.0714 13.9667 12.0714 13.5938V3.75H12.5357C12.6588 3.75 12.7769 3.70061 12.864 3.61271C12.9511 3.5248 13 3.40557 13 3.28125V2.8125C13 2.68818 12.9511 2.56895 12.864 2.48104C12.7769 2.39314 12.6588 2.34375 12.5357 2.34375ZM4.98643 1.4915C5.00195 1.46543 5.0239 1.44386 5.05015 1.42892C5.07639 1.41398 5.10603 1.40616 5.13616 1.40625H7.86384C7.89392 1.40622 7.9235 1.41405 7.94969 1.42899C7.97588 1.44393 7.99779 1.46547 8.01328 1.4915L8.51993 2.34375H4.48007L4.98643 1.4915ZM10.6786 13.5938H2.32143V3.75H10.6786V13.5938ZM4.52679 12.1875H5.22321C5.31557 12.1875 5.40414 12.1505 5.46944 12.0845C5.53474 12.0186 5.57143 11.9292 5.57143 11.8359V5.50781C5.57143 5.41457 5.53474 5.32515 5.46944 5.25922C5.40414 5.19329 5.31557 5.15625 5.22321 5.15625H4.52679C4.43443 5.15625 4.34586 5.19329 4.28056 5.25922C4.21526 5.32515 4.17857 5.41457 4.17857 5.50781V11.8359C4.17857 11.9292 4.21526 12.0186 4.28056 12.0845C4.34586 12.1505 4.43443 12.1875 4.52679 12.1875Z\"\n                fill=\"#4B4B4B\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eУдалить\u003c/p\u003e\n        \u003c/li\u003e\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\n  \u003ctemplate class=\"options-template__position\"\u003e\n    \u003cdiv class=\"list-item__options-popup\"\u003e\n      \u003cul class=\"option-list\"\u003e\n        \u003cli\u003e\n          \u003ca href=\"\" class=\"option-list__item option-list__edit\"\u003e\n              \u003cdiv class=\"option-list__icon\"\u003e\n                \u003ci _ngcontent-fwf-c252=\"\" class=\"elma-icons md-14\"\u003etool_pen\u003c/i\u003e\n              \u003c/div\u003e\n              \u003cp class=\"option-list__text\"\u003eРедактировать\u003c/p\u003e\n          \u003c/a\u003e\n        \u003c/li\u003e\n        \u003cli class=\"option-list__item option-list__delete\"\u003e\n          \u003cdiv class=\"option-list__icon\"\u003e\n            \u003csvg\n              width=\"13\"\n              height=\"15\"\n              viewBox=\"0 0 13 15\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            \u003e\n              \u003cpath\n                d=\"M7.77679 12.1875H8.47321C8.56557 12.1875 8.65414 12.1505 8.71944 12.0845C8.78474 12.0186 8.82143 11.9292 8.82143 11.8359V5.50781C8.82143 5.41457 8.78474 5.32515 8.71944 5.25922C8.65414 5.19329 8.56557 5.15625 8.47321 5.15625H7.77679C7.68443 5.15625 7.59586 5.19329 7.53056 5.25922C7.46526 5.32515 7.42857 5.41457 7.42857 5.50781V11.8359C7.42857 11.9292 7.46526 12.0186 7.53056 12.0845C7.59586 12.1505 7.68443 12.1875 7.77679 12.1875ZM12.5357 2.34375H10.1444L9.15775 0.682617C9.03393 0.474321 8.85878 0.30196 8.64936 0.182331C8.43994 0.0627019 8.2034 -0.000115529 7.96279 1.59506e-07H5.03721C4.79669 -1.43194e-05 4.56027 0.0628512 4.35097 0.182475C4.14166 0.3021 3.9666 0.474406 3.84283 0.682617L2.85565 2.34375H0.464286C0.341149 2.34375 0.223057 2.39314 0.135986 2.48104C0.0489157 2.56895 0 2.68818 0 2.8125L0 3.28125C0 3.40557 0.0489157 3.5248 0.135986 3.61271C0.223057 3.70061 0.341149 3.75 0.464286 3.75H0.928571V13.5938C0.928571 13.9667 1.07532 14.3244 1.33653 14.5881C1.59774 14.8518 1.95202 15 2.32143 15H10.6786C11.048 15 11.4023 14.8518 11.6635 14.5881C11.9247 14.3244 12.0714 13.9667 12.0714 13.5938V3.75H12.5357C12.6588 3.75 12.7769 3.70061 12.864 3.61271C12.9511 3.5248 13 3.40557 13 3.28125V2.8125C13 2.68818 12.9511 2.56895 12.864 2.48104C12.7769 2.39314 12.6588 2.34375 12.5357 2.34375ZM4.98643 1.4915C5.00195 1.46543 5.0239 1.44386 5.05015 1.42892C5.07639 1.41398 5.10603 1.40616 5.13616 1.40625H7.86384C7.89392 1.40622 7.9235 1.41405 7.94969 1.42899C7.97588 1.44393 7.99779 1.46547 8.01328 1.4915L8.51993 2.34375H4.48007L4.98643 1.4915ZM10.6786 13.5938H2.32143V3.75H10.6786V13.5938ZM4.52679 12.1875H5.22321C5.31557 12.1875 5.40414 12.1505 5.46944 12.0845C5.53474 12.0186 5.57143 11.9292 5.57143 11.8359V5.50781C5.57143 5.41457 5.53474 5.32515 5.46944 5.25922C5.40414 5.19329 5.31557 5.15625 5.22321 5.15625H4.52679C4.43443 5.15625 4.34586 5.19329 4.28056 5.25922C4.21526 5.32515 4.17857 5.41457 4.17857 5.50781V11.8359C4.17857 11.9292 4.21526 12.0186 4.28056 12.0845C4.34586 12.1505 4.43443 12.1875 4.52679 12.1875Z\"\n                fill=\"#4B4B4B\"\n              /\u003e\n            \u003c/svg\u003e\n          \u003c/div\u003e\n          \u003cp class=\"option-list__text\"\u003eУдалить\u003c/p\u003e\n        \u003c/li\u003e\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  \u003c/template\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n",
              "hideContent": true,
              "contentPlaceholder": "HTML"
            }
          },
          {
            "id": "2d8ce82d-ce0e-442f-ae7f-ea3f836473b5",
            "descriptor": "code",
            "values": {
              "html": "\u003cstyle\u003e\n  :root {\n    --hover-color: #1e6599;\n  }\n\n  table__header.table__row {\n    background: #f0f0f0;\n    padding: 16px 0 16px 27px;\n  }\n\n  .table__header.table__row {\n    background: #f0f0f0;\n    padding: 16px 0 16px 27px;\n  }\n\n  .table__header::after {\n    content: \"\";\n    display: none;\n  }\n\n  .table__row {\n    width: 100%;\n    display: grid;\n    grid-template-columns: 8fr 2fr 2fr 2fr 1fr;\n\n    cursor: pointer;\n    border-bottom: 1px solid #e8e8e8;\n  }\n\n  /* .table__row::after {\n  content: \"\";\n  height: 1px;\n  position: absolute;\n  background: #e8e8e8;\n  width: 100%;\n  left: 0;\n  transform: translateY(28px);\n} */\n\n  .table__name {\n    color: #000;\n    font-size: 17px;\n    font-weight: 600;\n    line-height: 24px;\n    text-align: center;\n\n    margin-bottom: 0;\n  }\n\n  .table__name:first-child {\n    text-align: start;\n  }\n\n  .staff-wrapper {\n    width: 100%;\n    position: relative;\n  }\n\n  .list-item__wrapper {}\n\n  .list-item-container {\n    display: flex;\n    align-items: center;\n    padding-left: 27px;\n    padding: 8px 0;\n  }\n\n  .list-item__department {}\n\n  .list-item__arrow {\n    transform: translateY(-2px);\n  }\n\n  .list-item__arrow svg {\n    fill: #5e5e5e;\n    transform: rotate(180deg);\n  }\n\n  .list-item__arrow--active svg {\n    transform: rotate(0deg);\n  }\n\n  .list-item__folder {\n    padding: 0 8px 0 10px;\n  }\n\n  .list-item__folder svg {\n    fill: #5e5e5e;\n  }\n\n  .list-item__text-container {\n    display: flex;\n  }\n\n  .list-item__text {\n    font-size: 15px;\n    font-weight: 600;\n    line-height: 22px;\n    user-select: none;\n\n    margin-bottom: 0;\n  }\n\n  .list-item__new-user {\n    font-size: 15px;\n    font-weight: 600;\n    line-height: 22px;\n    display: none;\n\n    --hover-color: currentColor;\n\n    margin-bottom: 0;\n  }\n\n  .list-item__sumbol {\n    font-size: 15px;\n    font-weight: 600;\n    line-height: 22px;\n    display: none;\n\n    margin-bottom: 0;\n  }\n\n  .list-item__position .list-item__text {\n    color: #1e6599;\n  }\n\n  .list-item__position .list-item__folder {\n    display: none;\n  }\n\n  .list-item__position .list-item__arrow svg {\n    fill: #1e6599;\n  }\n\n  .list-item__position .list-item__arrow {\n    padding-right: 10px;\n  }\n\n  .list-item__info-cell {\n    text-align: center;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .list-item__info-cell p {\n    margin: 0\n  }\n\n  .list-item__children {\n    display: none;\n  }\n\n  .list-item__children--active {\n    display: block;\n  }\n\n  .list-item__actions--enabled {\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    position: relative;\n  }\n\n  .list-item__actions--enabled svg {\n    fill: #bfbfbf;\n  }\n\n  .list-item__actions--active {}\n\n  .list-item__actions--active svg {\n    fill: #1e6599;\n  }\n\n  .list-item__options-popup {\n    border: 1px solid #d9d9d9;\n    border-radius: 4px;\n    box-shadow: 0px 4px 26px rgba(0, 0, 0, 0.1);\n    padding: 8px 0;\n\n    position: absolute;\n    transform: translate(-50%, 54%);\n    display: none;\n    background: white;\n    z-index: 10;\n  }\n\n  .list-item__options-popup--active {\n    display: block;\n  }\n\n  .option-list {\n    list-style: none;\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n\n  .option-list__item {\n    display: flex;\n    align-items: center;\n    padding: 8px 20px 6px;\n    color: #000;\n  }\n\n  .option-list__item:hover {\n    text-decoration: none;\n  }\n\n  .option-list__icon {\n    margin-right: 11px;\n  }\n\n  .option-list__text {\n    font-size: 16px;\n    line-height: 24px;\n    user-select: none;\n\n    margin: 0;\n  }\n\n  .staff__backdrop {\n    width: 100%;\n    height: 100vh;\n\n    position: absolute;\n    z-index: 1000;\n    background: rgba(0, 0, 0, 0.4);\n    justify-content: center;\n    align-items: center;\n  }\n\n  .staff__backdrop--active {\n    display: flex;\n  }\n\n  .staff__popup {\n    background: white;\n    padding: 24px;\n    border: 1px solid #d9d9d9;\n    box-shadow: 0px 6px 28px rgba(0, 0, 0, 0.16);\n    border-radius: 4px;\n    max-width: 500px;\n    min-width: 500px;\n    position: absolute;\n    right: 50%;\n    bottom: 50%;\n    transform: translate(50%, 50%);\n  }\n\n  .staff__popup--active {\n    display: block;\n  }\n\n  .staff__popup-title {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 16px;\n  }\n\n  .staff__popup-title-text {\n    font-weight: 600;\n    font-size: 20px;\n    line-height: 22px;\n  }\n\n  .staff__popup-exit-icon {\n    cursor: pointer;\n    padding: 0 0 8px 8px;\n  }\n\n  .staff__popup-description {\n    margin-bottom: 24px;\n  }\n\n  .staff__popup-description-text {\n    font-size: 15px;\n    line-height: 22px;\n  }\n\n  .staff__popup-controls {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n  }\n\n  .staff__popup-controls p {\n    margin-bottom: 0;\n    color: #df352c;\n  }\n\n  .staff__popup-button {\n    font-weight: 600;\n    font-size: 15px;\n    line-height: 22px;\n    padding: 5px 16px;\n    border: 1px solid #1e6599;\n    cursor: pointer;\n    border-radius: 4px;\n  }\n\n  .staff__popup-button:hover {\n    opacity: 0.8;\n  }\n\n  .staff__popup-confirm {\n    background: #1e6599;\n    color: #fff;\n  }\n\n  .staff__popup-cancel {\n    background: #fff;\n    color: #1e6599;\n  }\n\n  .staff__new-org-button {\n    display: none;\n    background: #1e6599;\n    color: #fff;\n    padding: 8px 16px;\n  }\n\n  .staff__new-org-button--active {\n    display: block;\n  }\n\n  .staff__new-org-button:hover {\n    background: #1e6599;\n    color: #fff;\n    text-decoration: none;\n  }\n\n  .staff-header-container {\n    padding: 30px 30px 30px 24px;\n\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .staff-header-title {\n    font-weight: 600;\n    font-size: 24px;\n    line-height: 32px;\n    margin-bottom: 0;\n  }\n\n  .staff-title-partition {\n    color: #1f6599;\n  }\n\n  .staff-title-divider {\n    color: #d2d2d2;\n  }\n\n  .elma-form-row.\\@compact {\n    flex: 1 0 100% !important;\n    margin-bottom: 7px !important;\n  }\n\n  .elma-form-row.\\@compact .elma-form-label {\n    flex: 0 0 130px !important;\n    max-width: calc(146px + 2em) !important;\n    padding: 1rem 7px 1rem 0 !important;\n    margin-right: 14px !important;\n    font-size: 1.5rem !important;\n  }\n\n  .elma-form-row.\\@compact .elma-form-control {\n    flex-basis: 0 !important;\n    flex-grow: 1 !important;\n    min-width: 160px !important;\n  }\n\n  #subdivision_amount,\n  #subdivision_salary {\n    width: 306px;\n  }\n\n  .staff-page-wrapper {\n    padding-bottom: 8rem;\n  }\n\n  .staff-loader-img {\n    width: 68px;\n    height: 20px;\n    background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20version%3D%221.1%22%20id%3D%22L9%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%0A%20%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%200%200%22%20xml%3Aspace%3D%22preserve%22%3E%0A%20%20%20%20%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M73%2C50c0-12.7-10.3-23-23-23S27%2C37.3%2C27%2C50%20M30.9%2C50c0-10.5%2C8.5-19.1%2C19.1-19.1S69.1%2C39.5%2C69.1%2C50%22%3E%0A%20%20%20%20%20%20%3CanimateTransform%20%0A%20%20%20%20%20%20%20%20%20attributeName%3D%22transform%22%20%0A%20%20%20%20%20%20%20%20%20attributeType%3D%22XML%22%20%0A%20%20%20%20%20%20%20%20%20type%3D%22rotate%22%0A%20%20%20%20%20%20%20%20%20dur%3D%221s%22%20%0A%20%20%20%20%20%20%20%20%20from%3D%220%2050%2050%22%0A%20%20%20%20%20%20%20%20%20to%3D%22360%2050%2050%22%20%0A%20%20%20%20%20%20%20%20%20repeatCount%3D%22indefinite%22%20%2F%3E%0A%20%20%3C%2Fpath%3E%0A%3C%2Fsvg%3E) no-repeat center / contain;\n  }\n\n  .list-item__user .list-item__text {\n    color: #1e6599;\n    --hover-color: currentColor;\n    border-bottom: 2px dashed transparent;\n    cursor: pointer;\n  }\n\n  .list-item__user .list-item__new-user {\n    color: #1e6599;\n    --hover-color: currentColor;\n    border-bottom: 2px dashed transparent;\n    cursor: pointer;\n  }\n\n  .list-item__user .list-item__sumbol {\n    color: #1e6599;\n    border-bottom: 2px dashed transparent;\n    padding-left: 5.5px;\n    padding-right: 5.5px;\n    cursor: pointer;\n  }\n\n  .list-item__user .list-item__text:hover {\n    border-bottom: 2px dashed var(--hover-color);\n  }\n\n  .list-item__user .list-item__new-user:hover {\n    border-bottom: 2px dashed #1e6599;\n  }\n\n  .list-item__user .table__row {\n    cursor: auto;\n  }\n\n  .list-item__user .list-item-container {\n    position: relative;\n  }\n\n  .user-card {\n    position: absolute;\n    top: 35px;\n    z-index: 10;\n    padding: 22px 24px;\n    background: #fff;\n    box-shadow: 0px 2px 8px rgba(37, 41, 65, 0.16);\n    border-radius: 4px;\n    display: none;\n  }\n\n  .user-card--active {\n    display: block;\n  }\n\n  .user-card__name-container {\n    margin-bottom: 30px;\n  }\n\n  .user-card__name {\n    color: #262626;\n    font-weight: 600;\n    line-height: 22px;\n    font-size: 15px;\n  }\n\n  .user-card__phone-container {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n\n  .user-card__phone {\n    font-size: 15px;\n    line-height: 22px;\n    margin-left: 8px;\n  }\n\n  .user-card__email-container {\n    display: flex;\n    align-items: center;\n  }\n\n  .user-card__email {\n    margin-left: 8px;\n  }\n\n  .user-card p {\n    margin-bottom: 0;\n  }\n\n  .user-card__content {\n    display: flex;\n  }\n\n  .user-card__image-container {\n    width: 74px;\n    height: 74px;\n    border-radius: 37px;\n    background: #52b794;\n    margin-left: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .user-card__image-text {\n    color: white;\n    font-size: 4rem;\n  }\n\n\n\n\n  .user-card-new {\n    position: absolute;\n    top: 35px;\n    z-index: 10;\n    padding: 22px 24px;\n    background: #fff;\n    box-shadow: 0px 2px 8px rgba(37, 41, 65, 0.16);\n    border-radius: 4px;\n    display: none;\n  }\n\n  .user-card-new--active {\n    display: block;\n  }\n\n  .user-card__name-container-new {\n    margin-bottom: 30px;\n  }\n\n  .user-card__name-new {\n    color: #262626;\n    font-weight: 600;\n    line-height: 22px;\n    font-size: 15px;\n  }\n\n  .user-card__phone-container-new {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n\n  .user-card__phone-new {\n    font-size: 15px;\n    line-height: 22px;\n    margin-left: 8px;\n  }\n\n  .user-card__email-container-new {\n    display: flex;\n    align-items: center;\n  }\n\n  .user-card__email-new {\n    margin-left: 8px;\n  }\n\n  .user-card-new p {\n    margin-bottom: 0;\n  }\n\n  .user-card__content-new {\n    display: flex;\n  }\n\n  .user-card__image-container-new {\n    width: 74px;\n    height: 74px;\n    border-radius: 37px;\n    background: #52b794;\n    margin-left: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .user-card__image-text-new {\n    color: white;\n    font-size: 4rem;\n  }\n\n  .option-list__edit-text {\n    margin-left: -2px;\n  }\n\n  .option-list__add-position {\n    display: none;\n  }\n\n  .option-list__add-department {\n    display: none;\n  }\n\n  .option-list__edit {\n    display: none;\n  }\n\n  .option-list__delete {\n    display: none;\n  }\n\n  .enabled {\n    display: flex;\n  }\n\u003c/style\u003e",
              "hideContent": true,
              "contentPlaceholder": "CSS"
            }
          },
          {
            "id": "c14c39cb-0ca8-4429-838a-240764795797",
            "descriptor": "code",
            "values": {
              "html": "\u003cdiv class=\"ui-teml\" style=\"display: none;width: 900px\"\u003e\n        \u003cdiv id=\"org-add-popup\"\u003e\n                \u003c%= UI.widget.contextRow(\"organization_name\", { required: true }) %\u003e\n        \u003c/div\u003e\n        \u003cdiv id=\"subdivision-add-popup\"\u003e\n                \u003c%= UI.widget.contextRow(\"subdivision_name\", { required: true }) %\u003e\n        \u003c/div\u003e\n        \u003cdiv id=\"position-add-popup\"\u003e\n                \u003c%= UI.widget.contextRow(\"subdivision_full_name\", { required: true }) %\u003e\n                \u003c%= UI.widget.contextRow(\"subdivision_short_name\", { required: true }) %\u003e\n                \u003c%= UI.widget.contextRow(\"subdivision_amount\", { required: true }) %\u003e\n                \u003c%= UI.widget.contextRow(\"subdivision_salary\", { required: true }) %\u003e\n                \u003c%= UI.widget.contextRow(\"approval_date\", { required: true }) %\u003e\n        \u003c/div\u003e\n\u003c/div\u003e\n",
              "hideContent": true,
              "contentPlaceholder": "CONTEXT UI PRELOAD"
            }
          },
          {
            "id": "96b9b653-fe9b-42ab-b1e5-bae9112f1b7f",
            "descriptor": "code",
            "values": {
              "html": "<% Scripts.renderPage() %>",
              "hideContent": true,
              "contentPlaceholder": "Page render"
            }
          }
        ]
      }
    },
    "fields": [
      {
        "code": "subdivision_full_name",
        "type": "STRING",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Полное название",
          "data": {
            "additionalType": "string"
          },
          "input": false,
          "output": false
        }
      },
      {
        "code": "subdivision_short_name",
        "type": "STRING",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Краткое  название",
          "data": {
            "additionalType": "string"
          },
          "input": false,
          "output": false
        }
      },
      {
        "code": "subdivision_amount",
        "type": "FLOAT",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Количество",
          "data": {
            "additionalType": "integer",
            "showRowSeparator": true
          },
          "input": false,
          "output": false
        }
      },
      {
        "code": "subdivision_salary",
        "type": "MONEY",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Оклад",
          "data": {
            "currency": "RUB"
          },
          "input": false,
          "output": false
        }
      },
      {
        "code": "subdivision_name",
        "type": "STRING",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Название",
          "data": {
            "additionalType": "string"
          },
          "input": false,
          "output": false
        }
      },
      {
        "code": "organization_name",
        "type": "STRING",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Название организации",
          "data": {
            "additionalType": "string"
          }
        }
      },
      {
        "code": "approval_date",
        "type": "DATETIME",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Дата утверждения",
          "data": {
            "additionalType": "date",
            "defaultTimeType": "startOfDay",
            "timeOptional": true
          }
        }
      }
    ],
    "fieldVisibilityConditions": {
      "approval_date": {
        "enabled": false,
        "conditions": []
      },
      "subdivision_name": {
        "enabled": false,
        "conditions": []
      },
      "organization_name": {
        "enabled": false,
        "conditions": []
      },
      "subdivision_amount": {
        "enabled": false,
        "conditions": []
      },
      "subdivision_salary": {
        "enabled": false,
        "conditions": []
      },
      "subdivision_full_name": {
        "enabled": false,
        "conditions": []
      },
      "subdivision_short_name": {
        "enabled": false,
        "conditions": []
      }
    },
    "scriptOptions": {},
    "clientScripts": "/* Client scripts module */\ndeclare const document: any;\ndeclare const console: any;\ndeclare const window: any;\ndeclare const performance: any;\n\ninterface StaffItem {\n  description: string;\n  division_key: null | string;\n  owner_key: null | string;\n  parent_key: null | string;\n  position_key: null | string;\n  ref_key: string;\n  children: StaffItem[] | null;\n}\n\nenum OrgLevel {\n  LegalEntity = \"legal entity\",\n  Position = \"position\",\n  Subdivision = \"subdivision\",\n}\n\nlet elementTemplate: any;\nlet userTemplate: any;\nlet optionsPopupTemplate: any;\nlet optionsLegalPopupTemplate: any;\nlet optionsPositionPopupTemplate: any;\nlet deletePopupTemplate: any;\nlet addPopupTemplate: any;\nlet currentData: any;\nlet staff: any;\nlet staff_external_combination: any;\nlet staff_internal_combination: any;\nlet staffDataApp: any;\nlet positions: any;\nlet orgApps: any;\nlet subdivisionsApps: any;\nlet currentUser: any;\nlet editSubdivisionPermission: boolean;\nlet createSubdivisionPermission: boolean;\nlet createPositionPermission: boolean;\nlet editPositionPermission: boolean;\nlet deleteSubdivisionPermission: boolean;\nlet deletePositionPermission: boolean;\nlet editOrgPermission: boolean;\nlet deleteOrgPermission: boolean;\nlet createOrgPermission: boolean;\nlet staffOrgs: any[] = [];\nlet isSuperuser: boolean;\n\nconst showPopupBtnPreloader = () =\u003e {\n  const btn = document.querySelector(\".staff__popup-confirm\")\n  btn.innerText = \"\";\n  const spinner = document.createElement(\"div\");\n  spinner.classList.add(\"staff-loader-img\");\n  btn.append(spinner)\n}\n\nconst hideFormError = () =\u003e {\n  const error = document.querySelector('.staff__popup-controls p')\n  if (!!error) {\n    error.remove();\n  }\n}\n\nconst showFormError = () =\u003e {\n  const error = document.querySelector('.staff__popup-controls p')\n  if (!error) {\n    const errorElement = document.createElement('p')\n    errorElement.innerText = \"Заполните все поля\"\n\n    const container = document.querySelector(\".staff__popup-controls\")\n    container.append(errorElement)\n  }\n}\n\nconst generateUUID = () =\u003e {\n  let\n    d = new Date().getTime(),\n    d2 = (performance \u0026\u0026 performance.now \u0026\u0026 (performance.now() * 1000)) || 0;\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c =\u003e {\n    let r = Math.random() * 16;\n    if (d \u003e 0) {\n      r = (d + r) % 16 | 0;\n      d = Math.floor(d / 16);\n    } else {\n      r = (d2 + r) % 16 | 0;\n      d2 = Math.floor(d2 / 16);\n    }\n    return (c == 'x' ? r : (r \u0026 0x7 | 0x8)).toString(16);\n  });\n};\n\nconst closeActivePopup = () =\u003e {\n  const activePopup = document.querySelector(\n    \".list-item__options-popup--active\"\n  );\n\n  if (!activePopup) return\n\n  activePopup.classList.remove(\"list-item__options-popup--active\");\n\n  const activeOption = document.querySelector(\n    \".list-item__actions--active\"\n  );\n  if (!!activeOption) {\n    activeOption.classList.remove(\"list-item__actions--active\");\n  }\n}\n\nconst validate = (itemType: OrgLevel): boolean =\u003e {\n  let isValid = true;\n\n  switch (itemType) {\n    case OrgLevel.Subdivision:\n      isValid = !!Context.data.subdivision_name\n      break;\n    case OrgLevel.Position:\n      isValid =\n        !!Context.data.approval_date\n        \u0026\u0026 !!Context.data.subdivision_amount\n        \u0026\u0026 !!Context.data.subdivision_full_name\n        \u0026\u0026 !!Context.data.subdivision_salary\n        \u0026\u0026 !!Context.data.subdivision_short_name;\n      break;\n  }\n\n  return isValid\n}\n\nconst saveNewObject = async () =\u003e {\n  if (!staffDataApp) {\n    const staffDataset = await Namespace.app.staff_data.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all();\n    const sortedApps = staffDataset.sort((a, b) =\u003e {\n      const aDate: any = a.data.__createdAt.asDate()\n      const bDate: any = b.data.__createdAt.asDate()\n      return bDate - aDate\n    })\n    staffDataApp = sortedApps.length \u003e 0 ? sortedApps[0] : undefined\n  }\n  if (!!staffDataApp) {\n    staffDataApp.data.json_staffing_data = JSON.stringify(currentData)\n    await staffDataApp.save()\n  }\n}\n\nconst getData = async () =\u003e {\n  const staffDataset = await Namespace.app.staff_data.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all()\n\n  const sortedApps = staffDataset.sort((a, b) =\u003e {\n    const aDate: any = a.data.__createdAt.asDate()\n    const bDate: any = b.data.__createdAt.asDate()\n    return bDate - aDate\n  })\n  staffDataApp = sortedApps.length \u003e 0 ? sortedApps[0] : undefined\n\n  if (!!staffDataApp) {\n    const jsonData = JSON.parse(staffDataApp.data.json_staffing_data!);\n    if (!Array.isArray(jsonData.children)) {\n      staffDataApp.data.json_staffing_data = JSON.stringify({ children: [] })\n      await staffDataApp.save()\n      jsonData.children = []\n    }\n    currentData = jsonData;\n    return jsonData;\n  }\n  const newObj = Namespace.app.staff_data.create()\n  const currentDate = new Datetime()\n  newObj.data.json_staffing_data = JSON.stringify({ children: [] })\n  newObj.data.__name = `Штатное расписание от ${currentDate.format()}`\n  currentData = { children: [] }\n  await newObj.save();\n  staffDataApp = newObj\n  return { children: [] }\n\n};\n\nfunction deleteSearch(obj: any, targetKey: string): any {\n  if (obj.children) {\n    let itemId: undefined | number;\n    for (let i = 0; i \u003c obj.children.length; i++) {\n      if (obj.children[i].ref_key === targetKey) {\n        itemId = i\n        break;\n      }\n    }\n\n    if (typeof itemId === 'number') {\n      obj.children.splice(itemId, 1)\n      return true;\n    }\n\n    for (let item of obj.children) {\n      let check = deleteSearch(item, targetKey)\n      if (!!check) {\n        return check\n      }\n    }\n  }\n\n  return null\n}\n\nfunction addSearch(obj: any, targetId: string): any {\n  if (obj.ref_key === targetId) {\n    return obj\n  }\n  if (obj.children) {\n    for (let item of obj.children) {\n      let check = addSearch(item, targetId)\n      if (check) {\n        return check\n      }\n    }\n  }\n  return null\n}\n\nconst deleteItem = async (e: any, refKey: string, itemType: OrgLevel) =\u003e {\n\n  switch (itemType) {\n    case OrgLevel.LegalEntity:\n      const orgItem = orgApps.find((f: any) =\u003e f.ref_key == refKey);\n      if (!!orgItem) {\n        await orgItem.delete();\n      }\n      break;\n    case OrgLevel.Subdivision:\n      const subdivisionItem = subdivisionsApps.find((f: any) =\u003e f.ref_key == refKey);\n      if (!!subdivisionItem) {\n        await subdivisionItem.delete();\n      }\n      break;\n    case OrgLevel.Position:\n      const positionItem = positions.find((f: any) =\u003e f.ref_key == refKey);\n      if (!!positionItem) {\n        await positionItem.delete();\n      }\n      break;\n  }\n\n  let foundItem = null;\n\n  deleteSearch(currentData, refKey);\n\n  const refElement = document.querySelector(`[data-key='${refKey}']`);\n  refElement.remove();\n\n\n\n  await saveNewObject();\n  closePopup(e);\n\n\n}\n\nconst addItem = async (itemType: OrgLevel, refKey?: string, newOrg?: boolean) =\u003e {\n  //console.log(refKey)\n  if (!!newOrg) {\n    const newOrg = orgApps.find((f: any) =\u003e f.data.ref_key == refKey!);\n    const newItem: StaffItem = {\n      description: newOrg!.data.__name,\n      division_key: null,\n      owner_key: null,\n      parent_key: null,\n      position_key: null,\n      ref_key: newOrg!.data.ref_key || \"\",\n      children: []\n    }\n    currentData.children.push(newItem);\n    await saveNewObject();\n\n    const root = document.querySelector('.staff-wrapper')\n    renderBranch(newItem, root, 0)\n\n\n  } else {\n    let parent: any;\n\n    for (let i = 0; i \u003c currentData.children.length; i++) {\n      const foundParent = addSearch(currentData.children[i], refKey!);\n      if (!!foundParent) {\n        parent = foundParent;\n        const newItem: StaffItem = {\n          description: \"\",\n          division_key: null,\n          owner_key: currentData.children[i].ref_key,\n          parent_key: foundParent.ref_key,\n          position_key: \"00000000-0000-0000-0000-000000000000\",\n          ref_key: generateUUID(),\n          children: []\n        }\n\n        switch (itemType) {\n          case OrgLevel.LegalEntity:\n            newItem.description = Context.data.subdivision_name || \"\"\n            break;\n          case OrgLevel.Subdivision:\n            newItem.description = Context.data.subdivision_name || \"\";\n\n            //console.log(currentData.children[i].description);\n            //console.log(currentData.children[i].ref_key);\n            //console.log(parent);\n\n            const newAppItem = Namespace.app.structural_subdivision.create();\n            const currentOrg = orgApps.find((f: any) =\u003e f.data.ref_key == (currentData.children[i].ref_key));\n            //const parentSubdivisionApp = subdivisionsApps.find((f: any) =\u003e f.ref_key == (parent.ref_key));\n            const parentSubdivisionApp = await Namespace.app.structural_subdivision.search().where((f: any) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(parent.ref_key)).size(10000).first();\n\n            //console.log(!!parentSubdivisionApp);\n\n            newAppItem.data.organization = currentOrg;\n            newAppItem.data.ref_key = newItem.ref_key;\n            newAppItem.data.__name = newItem.description;\n            newAppItem.data.owner_key = newItem.owner_key || \"00000000-0000-0000-0000-000000000000\";\n            newAppItem.data.parent_key = newItem.owner_key === newItem.parent_key ? \"00000000-0000-0000-0000-000000000000\" : newItem.parent_key || \"00000000-0000-0000-0000-000000000000\";\n            newAppItem.data.position_key = \"00000000-0000-0000-0000-000000000000\";\n            newAppItem.data.subdivision = parentSubdivisionApp;\n\n            await newAppItem.save();\n\n            break;\n          case OrgLevel.Position:\n            newItem.description = Context.data.subdivision_full_name || \"\";\n            newItem.children = null;\n\n            const newAppPositionItem = Namespace.app.position.create();\n            //console.log(currentData.children[i].description);\n            //console.log(currentData.children[i].ref_key);\n            //console.log(parent);\n            //const currentPosOrg = orgApps.find((f: any) =\u003e f.ref_key === (currentData.children[i].ref_key));\n            const currentPosOrg = await Namespace.app.organization.search().where((f: any) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(currentData.children[i].ref_key)).size(10000).first();\n            //console.log(currentPosOrg);\n            //const parentSubdivisionPosApp = subdivisionsApps.find((f: any) =\u003e f.ref_key === (parent.ref_key));\n            const parentSubdivisionPosApp = await Namespace.app.structural_subdivision.search().where((f: any) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(parent.ref_key)).size(10000).first();\n            //console.log(parentSubdivisionPosApp);\n\n            newAppPositionItem.data.organization = currentPosOrg;\n            newAppPositionItem.data.__name = newItem.description;\n            newAppPositionItem.data.owner_key = newItem.owner_key || \"00000000-0000-0000-0000-000000000000\";\n            newAppPositionItem.data.parent_key = newItem.owner_key === newItem.parent_key ? \"00000000-0000-0000-0000-000000000000\" : newItem.parent_key || \"00000000-0000-0000-0000-000000000000\";;\n            newAppPositionItem.data.ref_key = newItem.ref_key;\n            newAppPositionItem.data.position_key = \"00000000-0000-0000-0000-000000000000\";\n            newAppPositionItem.data.quantity = Context.data.subdivision_amount;\n            newAppPositionItem.data.salary = Context.data.subdivision_salary;\n            newAppPositionItem.data.subdivision = parentSubdivisionPosApp;\n            newAppPositionItem.data.approval_date = Context.data.approval_date;\n\n            await newAppPositionItem.save()\n            break;\n        }\n        parent.children.push(newItem)\n        break;\n      };\n    }\n\n    if (!!parent) {\n      const refElement = document.querySelector(`[data-key='${refKey}']`);\n      const arrow = refElement.querySelector(\".list-item__arrow\");\n      arrow.style.visibility = \"visible\";\n      const refElementChildren = refElement.querySelector(\".list-item__children\");\n      refElementChildren.innerHTML = \"\";\n\n      parent.children.forEach((child: StaffItem) =\u003e {\n        renderBranch(child, refElementChildren, parseInt(refElement.dataset.level) + 1)\n      })\n\n      await saveNewObject();\n    }\n  };\n\n  Context.data.subdivision_amount = undefined;\n  Context.data.subdivision_full_name = undefined;\n  Context.data.subdivision_short_name = undefined;\n  Context.data.subdivision_salary = undefined;\n  Context.data.subdivision_name = undefined;\n  Context.data.approval_date = undefined;\n}\n\nconst loadPositions = async (app: any, level: number, root: any) =\u003e {\n  if (!!app) {\n    if (app.data.staff) {\n      let userApps = staff.filter((userApp: any) =\u003e {\n        return !!app.data.staff.find((staffRef: any) =\u003e staffRef.id === userApp.data.__id)\n      })\n      if (app.data.staff_external_combination) {\n        const staffExternalCombination = staff.filter((userApp: any) =\u003e {\n          return !!app.data.staff_external_combination.find((staffRef: any) =\u003e staffRef.id === userApp.data.__id)\n        })\n        userApps = userApps.concat(staffExternalCombination);\n      }\n      if (app.data.staff_internal_combination) {\n        const staffInternalCombination = staff.filter((userApp: any) =\u003e {\n          return !!app.data.staff_internal_combination.find((staffRef: any) =\u003e staffRef.id === userApp.data.__id)\n        })\n        userApps = userApps.concat(staffInternalCombination);\n      }\n\n      const user_ids = userApps.map((f: any) =\u003e f.id);\n      console.log(user_ids);\n\n      for (let user of userApps) {\n        const element = userTemplate.content.cloneNode(true);\n        const descriptionElement = element.querySelector(\".list-item__text\");\n        const descriptionElementNew = element.querySelector(\".list-item__new-user\");\n        const descriptionElementSumbol = element.querySelector(\".list-item__sumbol\");\n\n        descriptionElement.innerText = user.data.__name;\n\n\n        const replacements = await System.replacements.search()\n          .where((f, g) =\u003e g.and(\n            f.absent.eq(user.data.ext_user),\n            f.isInterrupted.eq(false),\n            f.__deletedAt.eq(null)))\n          .first();\n\n        if (replacements \u0026\u0026 replacements.data.replacement) {\n          descriptionElement.style.color = \"#9c9c9c\";\n          descriptionElementNew.innerText = (await replacements.data.replacement.fetch()).data.__name;\n          descriptionElementNew.style.display = \"block\";\n          descriptionElementSumbol.innerText = \"➔\";\n          descriptionElementSumbol.style.display = \"block\";\n        } else {\n          descriptionElementNew.style.display = \"none\";\n          descriptionElementSumbol.style.display = \"none\";\n          descriptionElement.style.color = \"#1e6599\";\n        }\n\n        const nameElement = element.querySelector(\".list-item-container\");\n        nameElement.style.paddingLeft = `${27 + level * 36}px`;\n\n\n        if (replacements \u0026\u0026 replacements.data.replacement) {\n          const replacement_user = await replacements.data.replacement.fetch();\n\n          const replacement_staff = await Namespace.app.staff.search()\n            .where(f =\u003e f.ext_user.eq(replacement_user))\n            .first();\n\n          if (replacement_staff) {\n            const cardNew = element.querySelector(\".user-card-new\");\n            cardNew.dataset.key = replacement_staff.data.__id + 'new'\n\n            const cardNameNew = cardNew.querySelector(\".user-card__name-new\");\n            cardNameNew.innerText = replacement_staff.data.__name;\n\n            if (replacement_staff.data.email) {\n              const cardEmailNew = cardNew.querySelector(\".user-card__email-new\");\n              cardEmailNew.innerText = replacement_staff.data.email?.email;\n              cardEmailNew.href = `mailto: ${replacement_staff.data.email?.email}`\n            }\n\n            if (replacement_staff.data.phone) {\n              const cardPhoneNew = cardNew.querySelector(\".user-card__phone-new\");\n              cardPhoneNew.innerText = replacement_staff.data.phone?.tel;\n            }\n\n            const userImageTextNew = element.querySelector(\".user-card__image-text-new\");\n            userImageTextNew.innerText = replacement_staff.data.full_name!.lastname[0] + replacement_staff.data.full_name!.firstname[0];\n\n            const userTextElementNew = element.querySelector(\".list-item__new-user\");\n\n            userTextElementNew.addEventListener(\"click\", async (e: any) =\u003e {\n              e.stopPropagation();\n              const activeCardNew = document.querySelector(\".user-card-new--active\");\n              if (!!activeCardNew) {\n                activeCardNew.classList.remove(\"user-card-new--active\")\n              }\n              const userCardNew = document.querySelector(`[data-key='${replacement_staff.data.__id}new']`);\n              userCardNew.classList.toggle(\"user-card-new--active\");\n            })\n\n            cardNew.addEventListener(\"click\", (e: any) =\u003e {\n              e.stopPropagation();\n            })\n          }\n        }\n\n        const card = element.querySelector(\".user-card\");\n        card.dataset.key = user.data.__id\n\n        const cardName = card.querySelector(\".user-card__name\");\n        cardName.innerText = user.data.__name;\n\n        if (user.data.email) {\n          const cardEmail = card.querySelector(\".user-card__email\");\n          cardEmail.innerText = user.data.email?.email;\n          cardEmail.href = `mailto: ${user.data.email?.email}`\n        }\n\n        if (user.data.phone) {\n          const cardPhone = card.querySelector(\".user-card__phone\");\n          cardPhone.innerText = user.data.phone?.tel;\n        }\n\n        const userImageText = element.querySelector(\".user-card__image-text\");\n        userImageText.innerText = user.data.full_name.lastname[0] + user.data.full_name.firstname[0];\n\n        const userTextElement = element.querySelector(\".list-item__text\");\n\n        userTextElement.addEventListener(\"click\", async (e: any) =\u003e {\n          e.stopPropagation();\n          const activeCard = document.querySelector(\".user-card--active\");\n          if (!!activeCard) {\n            activeCard.classList.remove(\"user-card--active\")\n          }\n          const userCard = document.querySelector(`[data-key='${user.data.__id}']`);\n          userCard.classList.toggle(\"user-card--active\");\n        })\n\n        card.addEventListener(\"click\", (e: any) =\u003e {\n          e.stopPropagation();\n        })\n\n        root.append(element)\n      }\n    }\n  }\n}\n\nconst renderBranch = async (branch: any, root: any, level: number) =\u003e {\n  const element = elementTemplate.content.cloneNode(true);\n  const descriptionElement = element.querySelector(\".list-item__text\");\n  descriptionElement.innerText = branch.description;\n\n  const nameElement = element.querySelector(\".list-item-container\");\n  nameElement.style.paddingLeft = `${27 + level * 36}px`;\n\n  const wrapper = element.querySelector('.list-item__wrapper');\n  wrapper.dataset.key = branch.ref_key;\n  wrapper.dataset.level = level;\n\n  if (branch.children || level === 0 || branch.is_subdiv) {\n    nameElement.classList.add(\"list-item__department\");\n    const tableRow = element.querySelector(\".table__row\");\n    tableRow.addEventListener(\"click\", () =\u003e {\n      closeActivePopup();\n      const arrow = tableRow.querySelector(\".list-item__arrow\");\n      arrow.classList.toggle(\"list-item__arrow--active\");\n      tableRow.nextElementSibling.classList.toggle(\n        \"list-item__children--active\"\n      );\n    });\n    const newRoot = element.querySelector(\".list-item__children\");\n    const departments = branch.children ? branch.children.filter((child: any) =\u003e !!child.children) : [];\n    const positions = branch.children ? branch.children.filter((child: any) =\u003e !child.children) : [];\n    departments.forEach((child: any) =\u003e {\n      renderBranch(child, newRoot, level + 1);\n    });\n\n    positions.forEach((child: any) =\u003e {\n      renderBranch(child, newRoot, level + 1);\n    });\n\n    const actionsElement = element.querySelector(\".list-item__actions\");\n\n    if (!branch.children || branch.children.length === 0) {\n      const arrow = tableRow.querySelector(\".list-item__arrow\");\n      arrow.style.visibility = \"hidden\";\n    }\n\n    //PERMISSIONS\n\n    let optionsPopup: any;\n    optionsPopup = optionsPopupTemplate.content.cloneNode(true);\n\n    if (createPositionPermission) {\n      if (level != 0) {\n        const addPositionBtn = optionsPopup.querySelector(\n          \".option-list__add-position\"\n        );\n\n        addPositionBtn.classList.add('enabled')\n\n        addPositionBtn.addEventListener(\"click\", () =\u003e {\n          openAddPopup(OrgLevel.Position, branch.ref_key)\n        });\n      }\n    }\n\n    if (createSubdivisionPermission) {\n      const addDepBtn = optionsPopup.querySelector(\n        \".option-list__add-department\"\n      );\n\n      addDepBtn.classList.add('enabled')\n\n      //ADD EVENT\n      addDepBtn.addEventListener(\"click\", () =\u003e {\n        openAddPopup(OrgLevel.Subdivision, branch.ref_key);\n      });\n    }\n\n    let app: any;\n    if (level === 0) {\n      app = orgApps?.find((org: any) =\u003e {\n        return org.data.ref_key === branch.ref_key\n      })\n\n      if (!app) {\n        app = await Namespace.app.organization.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n      }\n\n      //разграничение прав по организациям\n      if (!isSuperuser) {\n        let found = false;\n        for (let org of staffOrgs) {\n          let orgApp = await org.fetch();\n          if (app.data.__id === orgApp.data.__id) {\n            found = true;\n            break;\n          }\n        }\n\n        if (!found) {\n          return;\n        }\n      }\n\n    } else {\n      app = subdivisionsApps?.find((subDiv: any) =\u003e {\n        return subDiv.data.ref_key === branch.ref_key\n      })\n\n      if (!app) {\n        app = await Namespace.app.structural_subdivision.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n      }\n    }\n\n    descriptionElement.innerText = app.data.__name;\n\n    const editPermission = level === 0 ? editOrgPermission : editSubdivisionPermission;\n\n    if (editPermission) {\n      const editBtn = optionsPopup.querySelector(\".option-list__edit\");\n      editBtn.classList.add('enabled');\n      editBtn.href = `${window.location.href}(p:item/kedo/${level === 0 ? \"organization\" : \"structural_subdivision\"}/${app!.data.__id}/edit)`\n    }\n\n    const deletePermission = level === 0 ? deleteOrgPermission : editSubdivisionPermission;\n\n    if (deleteOrgPermission) {\n      const deleteBtn = optionsPopup.querySelector(\".option-list__delete\");\n      deleteBtn.classList.add(\"enabled\")\n\n      //DELETE EVENT\n      deleteBtn.addEventListener(\"click\", () =\u003e {\n        openDeletePopup(level === 0 ? OrgLevel.LegalEntity : OrgLevel.Subdivision, branch.ref_key)\n      });\n    }\n\n    actionsElement.append(optionsPopup);\n\n    actionsElement.addEventListener(\"click\", (event: any) =\u003e {\n      event.stopPropagation();\n      const isCloseCurrent = !!event.target.querySelector(\n        \".list-item__options-popup--active\"\n      );\n\n      if (!isCloseCurrent) {\n        const activePopup = document.querySelector(\n          \".list-item__options-popup--active\"\n        );\n        if (!!activePopup) {\n          activePopup.classList.remove(\"list-item__options-popup--active\");\n        }\n\n        const activeOption = document.querySelector(\n          \".list-item__actions--active\"\n        );\n        if (!!activeOption) {\n          activeOption.classList.remove(\"list-item__actions--active\");\n        }\n      }\n\n      actionsElement.classList.toggle(\"list-item__actions--active\");\n      const popup = actionsElement.querySelector(\".list-item__options-popup\");\n      popup.classList.toggle(\"list-item__options-popup--active\");\n    });\n\n    if (!editPermission \u0026\u0026 !deletePermission \u0026\u0026 !createPositionPermission \u0026\u0026 !createSubdivisionPermission) {\n      actionsElement.style.display = 'none'\n    }\n  } else {\n    nameElement.classList.add(\"list-item__position\");\n    const amountElement = element.querySelector(\".list-item__amount\");\n    const dateElement = element.querySelector(\".list-item__date\");\n    const salaryElement = element.querySelector(\".list-item__salary\");\n    const tableRow = element.querySelector(\".table__row\");\n\n    //-----------------------------\n\n    const actionsElement = element.querySelector(\".list-item__actions\");\n\n    const optionsPopup = optionsPositionPopupTemplate.content.cloneNode(true);\n    let app = positions?.find((pos: any) =\u003e {\n      return pos.data.ref_key === branch.ref_key\n    })\n\n    if (!app) {\n      app = await Namespace.app.position.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n    }\n    const positionsLength = app?.data.staff?.length + app?.data.staff_internal_combination?.length + app?.data.staff_external_combination?.length;\n\n    if (!positionsLength) {\n      const arrow = element.querySelector('.list-item__arrow')\n      arrow.style.visibility = \"hidden\"\n    }\n    amountElement.innerText = app?.data.quantity || \"\";\n    dateElement.innerText = app?.data.approval_date?.format(\"DD.MM.YYYY\") || \"\";\n    salaryElement.innerText = app?.data.salary?.asFloat() || \"\";\n\n    if (editPositionPermission) {\n      const editBtn = optionsPopup.querySelector(\".option-list__edit\");\n      editBtn.classList.add('enabled');\n      editBtn.href = `${window.location.href}(p:item/kedo/position/${app!.data.__id}/edit)`\n    }\n\n    if (deletePositionPermission) {\n      const deleteBtn = optionsPopup.querySelector(\".option-list__delete\");\n      deleteBtn.classList.add('enabled');\n      deleteBtn.addEventListener(\"click\", () =\u003e {\n        openDeletePopup(OrgLevel.Position, branch.ref_key)\n      });\n    }\n\n    if (!editPositionPermission \u0026\u0026 !deletePositionPermission) {\n      actionsElement.style.display = 'none'\n    }\n\n    actionsElement.append(optionsPopup);\n\n    tableRow.addEventListener(\"click\", async () =\u003e {\n      closeActivePopup();\n      const arrow = tableRow.querySelector(\".list-item__arrow\");\n      arrow.classList.toggle(\"list-item__arrow--active\");\n      tableRow.nextElementSibling.classList.toggle(\n        \"list-item__children--active\"\n      );\n      const refElement = document.querySelector(`[data-key='${app?.data.ref_key}']`);\n      const childrenContainer = refElement.querySelector('.list-item__children');\n      if (childrenContainer.children?.length === 0) {\n        loadPositions(app, ++level, childrenContainer)\n      }\n    })\n\n    actionsElement.addEventListener(\"click\", (event: any) =\u003e {\n      event.stopPropagation();\n      const isCloseCurrent = !!event.target.querySelector(\n        \".list-item__options-popup--active\"\n      );\n\n      if (!isCloseCurrent) {\n        const activePopup = document.querySelector(\n          \".list-item__options-popup--active\"\n        );\n        if (!!activePopup) {\n          activePopup.classList.remove(\"list-item__options-popup--active\");\n        }\n\n        const activeOption = document.querySelector(\n          \".list-item__actions--active\"\n        );\n        if (!!activeOption) {\n          activeOption.classList.remove(\"list-item__actions--active\");\n        }\n      }\n\n      actionsElement.classList.toggle(\"list-item__actions--active\");\n      const popup = actionsElement.querySelector(\".list-item__options-popup\");\n      popup.classList.toggle(\"list-item__options-popup--active\");\n    });\n  }\n\n  root.append(element);\n};\n\nconst renderList = async (data: any, rootElement: any) =\u003e {\n  if (data.children) {\n    for (let i = 0; i \u003c data.children.length; i++) {\n      renderBranch(data.children[i], rootElement, 0);\n    }\n  }\n};\n\nconst init = async () =\u003e {\n  const root = document.querySelector(\".staff-wrapper\");\n\n  const data = await getData();\n\n  const addOrgBtn = document.querySelector('.staff__new-org-button');\n\n  if (createOrgPermission) {\n    addOrgBtn.classList.add('staff__new-org-button--active')\n    addOrgBtn.href = `${window.location.href}(p:item/kedo/organization)`;\n\n    addOrgBtn.addEventListener(\"click\", () =\u003e {\n      let popupInterval: any\n\n      popupInterval = window.setInterval(async () =\u003e {\n        const modal = document.querySelector(\".complex-popup\");\n        //console.log('start1')\n        if (!!modal) {\n          //console.log('start1 modal found')\n          const confirmBtn = modal.querySelector(\".btn.btn-primary\")\n          const numberOfOrgs = await Namespace.app.organization.search().count();\n\n          confirmBtn.addEventListener(\"click\", async () =\u003e {\n            //console.log('start2')\n            let checkInterval: any;\n\n            checkInterval = window.setInterval(async () =\u003e {\n              const testOrgNumber = await Namespace.app.organization.search().count();\n\n              if (testOrgNumber \u003e numberOfOrgs) {\n                window.clearInterval(checkInterval)\n                const allOrg = await Namespace.app.organization.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all();\n                const sortedOrgs = allOrg.sort((a, b) =\u003e {\n                  const aDate: any = a.data.__createdAt.asDate()\n                  const bDate: any = b.data.__createdAt.asDate()\n                  return bDate - aDate\n                })\n                const newOrg = sortedOrgs[0]\n                if (newOrg) {\n                  //console.log('new org')\n                  //console.log(newOrg)\n                  newOrg.data.ref_key = generateUUID()\n                  //console.log(newOrg.data.ref_key)\n                  await newOrg.save()\n                  orgApps.push(newOrg)\n\n                  await addItem(OrgLevel.LegalEntity, newOrg.data.ref_key, true)\n                }\n              }\n            }, 1500)\n\n          })\n\n          window.clearInterval(popupInterval);\n        }\n      }, 1000)\n    })\n\n\n\n  }\n\n  renderList(data, root);\n};\n\nconst closeOptionsPopup = () =\u003e {\n  const activeActions = document.querySelector(\n    \".list-item__actions--active\"\n  );\n  if (!!activeActions) {\n    activeActions.classList.remove(\"list-item__actions--active\");\n  }\n\n  const activeOptions = document.querySelector(\".list-item__options-popup--active\");\n  if (!!activeOptions) {\n    activeOptions.classList.remove(\"list-item__options-popup--active\");\n  }\n}\n\nconst closePopup = (e: any, containerId?: string) =\u003e {\n  e.stopPropagation()\n  if (containerId) {\n    const elements = document.querySelector(`#${containerId}`)\n    const preloadContainer = document.querySelector('.ui-teml');\n\n    preloadContainer.append(elements)\n  }\n\n  const wrapper = document.querySelector(\".staff__backdrop\")\n  wrapper.remove();\n  closeOptionsPopup()\n}\n\nconst openDeletePopup = (type: OrgLevel, refKey: string) =\u003e {\n  let title: string = \"\";\n  let description: string = \"\";\n\n  switch (type) {\n    case OrgLevel.LegalEntity:\n      title = \"Удалить организацию ?\";\n      description = \"Организация и данные о ней удалятся навсегда — восстановить его её получится.\";\n      break;\n    case OrgLevel.Subdivision:\n      title = \"Удалить подразделение ?\";\n      description = \"Подразделение и данные о нём удалятся навсегда — восстановить его не получится.\";\n      break;\n    case OrgLevel.Position:\n      title = \"Удалить должность ?\";\n      description = \"Должность и данные о ней удалятся навсегда — восстановить её не получится.\";\n      break;\n  }\n  const popup = deletePopupTemplate.content.cloneNode(true);\n  const popupTitle = popup.querySelector(\".staff__popup-title-text\");\n  popupTitle.innerText = title;\n\n  const popupDescription = popup.querySelector(\".staff__popup-description-text\");\n  popupDescription.innerText = description;\n\n  const innerPopup = popup.querySelector(\".staff__popup\");\n  innerPopup.addEventListener(\"click\", (e: any) =\u003e {\n    e.stopPropagation()\n  })\n\n  const backdrop = popup.querySelector(\".staff__backdrop\")\n  backdrop.addEventListener(\"click\", closePopup)\n\n  const cancelIcon = popup.querySelector('.staff__popup-exit-icon')\n  cancelIcon.addEventListener(\"click\", closePopup)\n\n  const cancelBtn = popup.querySelector('.staff__popup-cancel')\n  cancelBtn.addEventListener(\"click\", closePopup)\n\n  const confirmBtn = popup.querySelector('.staff__popup-confirm')\n  confirmBtn.addEventListener(\"click\", async (e: any) =\u003e {\n    showPopupBtnPreloader()\n    await deleteItem(e, refKey, type)\n  })\n\n  const wrapper = document.querySelector(\".app-wrapper\");\n  wrapper.append(popup)\n}\n\nconst openAddPopup = (itemType: OrgLevel, refKey?: string) =\u003e {\n  let elementId: string = \"\";\n  let title: string = \"\";\n  switch (itemType) {\n    case OrgLevel.LegalEntity:\n      return;\n      title = \"Добавить организацию\";\n      elementId = \"org-add-popup\";\n      break;\n    case OrgLevel.Subdivision:\n      title = \"Добавить подразделение\";\n      elementId = \"subdivision-add-popup\";\n      break;\n    case OrgLevel.Position:\n      title = \"Добавить должность\";\n      elementId = \"position-add-popup\";\n      break;\n  }\n\n  const innerPopupContent = document.querySelector(`#${elementId}`)\n\n  const popup = addPopupTemplate.content.cloneNode(true);\n  const popupTitle = popup.querySelector(\".staff__popup-title-text\");\n  popupTitle.innerText = title;\n\n  const popupDescription = popup.querySelector(\".staff__popup-description\");\n  popupDescription.append(innerPopupContent);\n\n  const innerPopup = popup.querySelector(\".staff__popup\");\n  innerPopup.addEventListener(\"click\", (e: any) =\u003e {\n    e.stopPropagation();\n  })\n\n  const backdrop = popup.querySelector(\".staff__backdrop\");\n  backdrop.addEventListener(\"click\", (e: any) =\u003e {\n    closePopup(e, elementId);\n  })\n\n  const cancelIcon = popup.querySelector('.staff__popup-exit-icon');\n  cancelIcon.addEventListener(\"click\", (e: any) =\u003e {\n    closePopup(e, elementId);\n  })\n\n  const cancelBtn = popup.querySelector('.staff__popup-cancel');\n  cancelBtn.addEventListener(\"click\", (e: any) =\u003e {\n    closePopup(e, elementId);\n  })\n\n  //@TODO confirm add function\n  const confirmBtn = popup.querySelector('.staff__popup-confirm');\n  confirmBtn.addEventListener(\"click\", async (e: any) =\u003e {\n    const isValid = validate(itemType)\n    if (isValid) {\n      hideFormError()\n      showPopupBtnPreloader()\n      await addItem(itemType, refKey);\n      closePopup(e, elementId);\n    } else {\n      showFormError()\n    }\n  })\n\n  const wrapper = document.querySelector(\".app-wrapper\");\n  wrapper.append(popup);\n\n}\n\nasync function renderPage() {\n  elementTemplate = document.querySelector(\".schedule__template\");\n  optionsPopupTemplate = document.querySelector(\".options-template\");\n  userTemplate = document.querySelector(\".schedule__template--person\")\n  optionsLegalPopupTemplate = document.querySelector(\n    \".options-template__legal\"\n  );\n  optionsPositionPopupTemplate = document.querySelector(\n    \".options-template__position\"\n  );\n  deletePopupTemplate = document.querySelector(\".staff-delete-popup\");\n  addPopupTemplate = document.querySelector(\".staff-add-popup\")\n\n  const pageWrapper = document.querySelector('.staff-page-wrapper');\n\n  pageWrapper.addEventListener(\"click\", () =\u003e {\n    const activeCard = document.querySelector(\".user-card--active\");\n    if (!activeCard) return;\n\n    activeCard.classList.remove(\"user-card--active\");\n  })\n\n  pageWrapper.addEventListener(\"click\", () =\u003e {\n    const activeCard = document.querySelector(\".user-card-new--active\");\n    if (!activeCard) return;\n\n    activeCard.classList.remove(\"user-card-new--active\");\n  })\n\n  const positionsPromise = Namespace.app.position.search().where((f: any) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n  const subdivisionsAppsPromise = Namespace.app.structural_subdivision.search().where((f: any) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n  const orgAppsPromise = Namespace.app.organization.search().where((f: any) =\u003e f.__deletedAt.eq(null)).size(1000).all();\n  const currentUserPromise = System.users.getCurrentUser();\n\n  const positionPermissionPromise = Namespace.app.position.getPermissions();\n  const orgPermissionPromise = Namespace.app.organization.getPermissions();\n  const subdivisionPermissionPromise = Namespace.app.structural_subdivision.getPermissions();\n  //console.log(await positionPermissionPromise)\n\n  let positionPermissions: any, orgPermissions: any, subdivisionPermissions: any;\n\n  [positionPermissions, orgPermissions, subdivisionPermissions, positions, orgApps, subdivisionsApps, currentUser] = await Promise.all(\n    [positionPermissionPromise, orgPermissionPromise, subdivisionPermissionPromise, positionsPromise, orgAppsPromise, subdivisionsAppsPromise, currentUserPromise]);\n\n  // FILL PERMISSIONS\n  //console.log(orgPermissions);\n\n  isSuperuser = !!currentUser.data.groupIds.find((group: any) =\u003e group.id === '331e62d2-072e-58ac-9581-74abcc67f050' || group.id === 'd6000da0-c9aa-55eb-9882-f118b432730b')\n\n  if (isSuperuser) {\n    createOrgPermission = true;\n    editOrgPermission = true;\n    deleteOrgPermission = true;\n    createSubdivisionPermission = true;\n    editSubdivisionPermission = true;\n    deleteSubdivisionPermission = true;\n    createPositionPermission = true;\n    editPositionPermission = true;\n    deletePositionPermission = true;\n  } else {\n\n    //разграничение прав по организациям\n    const staff = await Namespace.app.staff.search().where((f, g) =\u003e g.and(\n      f.__deletedAt.eq(null),\n      f.ext_user.eq(currentUser)\n    )).first();\n\n    //console.log(staff);\n\n    if (staff \u0026\u0026 staff.data.employment_table) {\n      for (let item of staff.data.employment_table) {\n        if (item.organization) {\n          staffOrgs.push(item.organization);\n        }\n      };\n      //console.log(staffOrg);\n    }\n\n    //org\n    const orgPermissionGroups = orgPermissions.__permissions.values;\n    const orgPermissionsSet = new Set();\n    for (let i = 0; i \u003c orgPermissionGroups.length; i++) {\n      const userGroupPermiss = currentUser.data.groupIds?.find((group: any) =\u003e group.id === orgPermissionGroups[i].group.id);\n      if (!userGroupPermiss) continue;\n\n      orgPermissionGroups[i].types?.forEach((typePermiss: string) =\u003e {\n        orgPermissionsSet.add(typePermiss)\n      })\n    };\n\n    createOrgPermission = orgPermissionsSet.has('create');\n    editOrgPermission = orgPermissionsSet.has('update');\n    deleteOrgPermission = orgPermissionsSet.has('delete');\n    //------------\n\n    //subdivision\n    const subPermissionGroups = subdivisionPermissions.__permissions.values;\n    const subPermissionsSet = new Set();\n    for (let i = 0; i \u003c subPermissionGroups.length; i++) {\n      const userGroupPermiss = currentUser.data.groupIds?.find((group: any) =\u003e group.id === subPermissionGroups[i].group.id);\n      if (!userGroupPermiss) continue;\n\n      subPermissionGroups[i].types?.forEach((typePermiss: string) =\u003e {\n        subPermissionsSet.add(typePermiss)\n      })\n    };\n\n    createSubdivisionPermission = subPermissionsSet.has('create');\n    editSubdivisionPermission = subPermissionsSet.has('update');\n    deleteSubdivisionPermission = subPermissionsSet.has('delete');\n    //------------\n\n    //position\n    const posPermissionGroups = positionPermissions.__permissions.values;\n    const posPermissionsSet = new Set();\n    for (let i = 0; i \u003c posPermissionGroups.length; i++) {\n      const userGroupPermiss = currentUser.data.groupIds?.find((group: any) =\u003e group.id === posPermissionGroups[i].group.id);\n      if (!userGroupPermiss) continue;\n\n      posPermissionGroups[i].types?.forEach((typePermiss: string) =\u003e {\n        posPermissionsSet.add(typePermiss)\n      })\n    };\n\n    createPositionPermission = posPermissionsSet.has('create');\n    editPositionPermission = posPermissionsSet.has('update');\n    deletePositionPermission = posPermissionsSet.has('delete');\n    //------------\n  }\n\n  init();\n\n  staff = await Namespace.app.staff.search().where((f: any) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n}",
    "clientScriptOptions": {
      "allowServer": true
    },
    "serverScripts": "/* Server scripts module */\n",
    "serverScriptOptions": {}
  },
  "dataNamespace": "",
  "dataCode": "",
  "runtime": {
    "version": 1,
    "clientScripts": "System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server, System) {\n        let OrgLevel;\n        (function (OrgLevel) {\n            OrgLevel[\"LegalEntity\"] = \"legal entity\";\n            OrgLevel[\"Position\"] = \"position\";\n            OrgLevel[\"Subdivision\"] = \"subdivision\";\n        })(OrgLevel || (OrgLevel = {}));\n        let elementTemplate;\n        let userTemplate;\n        let optionsPopupTemplate;\n        let optionsLegalPopupTemplate;\n        let optionsPositionPopupTemplate;\n        let deletePopupTemplate;\n        let addPopupTemplate;\n        let currentData;\n        let staff;\n        let staff_external_combination;\n        let staff_internal_combination;\n        let staffDataApp;\n        let positions;\n        let orgApps;\n        let subdivisionsApps;\n        let currentUser;\n        let editSubdivisionPermission;\n        let createSubdivisionPermission;\n        let createPositionPermission;\n        let editPositionPermission;\n        let deleteSubdivisionPermission;\n        let deletePositionPermission;\n        let editOrgPermission;\n        let deleteOrgPermission;\n        let createOrgPermission;\n        let staffOrgs = [];\n        let isSuperuser;\n        const showPopupBtnPreloader = () =\u003e {\n            const btn = document.querySelector(\".staff__popup-confirm\");\n            btn.innerText = \"\";\n            const spinner = document.createElement(\"div\");\n            spinner.classList.add(\"staff-loader-img\");\n            btn.append(spinner);\n        };\n        const hideFormError = () =\u003e {\n            const error = document.querySelector('.staff__popup-controls p');\n            if (!!error) {\n                error.remove();\n            }\n        };\n        const showFormError = () =\u003e {\n            const error = document.querySelector('.staff__popup-controls p');\n            if (!error) {\n                const errorElement = document.createElement('p');\n                errorElement.innerText = \"Заполните все поля\";\n                const container = document.querySelector(\".staff__popup-controls\");\n                container.append(errorElement);\n            }\n        };\n        const generateUUID = () =\u003e {\n            let d = new Date().getTime(), d2 = (performance \u0026\u0026 performance.now \u0026\u0026 (performance.now() * 1000)) || 0;\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c =\u003e {\n                let r = Math.random() * 16;\n                if (d \u003e 0) {\n                    r = (d + r) % 16 | 0;\n                    d = Math.floor(d / 16);\n                }\n                else {\n                    r = (d2 + r) % 16 | 0;\n                    d2 = Math.floor(d2 / 16);\n                }\n                return (c == 'x' ? r : (r \u0026 0x7 | 0x8)).toString(16);\n            });\n        };\n        const closeActivePopup = () =\u003e {\n            const activePopup = document.querySelector(\".list-item__options-popup--active\");\n            if (!activePopup)\n                return;\n            activePopup.classList.remove(\"list-item__options-popup--active\");\n            const activeOption = document.querySelector(\".list-item__actions--active\");\n            if (!!activeOption) {\n                activeOption.classList.remove(\"list-item__actions--active\");\n            }\n        };\n        const validate = (itemType) =\u003e {\n            let isValid = true;\n            switch (itemType) {\n                case OrgLevel.Subdivision:\n                    isValid = !!Context.data.subdivision_name;\n                    break;\n                case OrgLevel.Position:\n                    isValid =\n                        !!Context.data.approval_date\n                            \u0026\u0026 !!Context.data.subdivision_amount\n                            \u0026\u0026 !!Context.data.subdivision_full_name\n                            \u0026\u0026 !!Context.data.subdivision_salary\n                            \u0026\u0026 !!Context.data.subdivision_short_name;\n                    break;\n            }\n            return isValid;\n        };\n        const saveNewObject = async () =\u003e {\n            if (!staffDataApp) {\n                const staffDataset = await Namespace.app.staff_data.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all();\n                const sortedApps = staffDataset.sort((a, b) =\u003e {\n                    const aDate = a.data.__createdAt.asDate();\n                    const bDate = b.data.__createdAt.asDate();\n                    return bDate - aDate;\n                });\n                staffDataApp = sortedApps.length \u003e 0 ? sortedApps[0] : undefined;\n            }\n            if (!!staffDataApp) {\n                staffDataApp.data.json_staffing_data = JSON.stringify(currentData);\n                await staffDataApp.save();\n            }\n        };\n        const getData = async () =\u003e {\n            const staffDataset = await Namespace.app.staff_data.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all();\n            const sortedApps = staffDataset.sort((a, b) =\u003e {\n                const aDate = a.data.__createdAt.asDate();\n                const bDate = b.data.__createdAt.asDate();\n                return bDate - aDate;\n            });\n            staffDataApp = sortedApps.length \u003e 0 ? sortedApps[0] : undefined;\n            if (!!staffDataApp) {\n                const jsonData = JSON.parse(staffDataApp.data.json_staffing_data);\n                if (!Array.isArray(jsonData.children)) {\n                    staffDataApp.data.json_staffing_data = JSON.stringify({ children: [] });\n                    await staffDataApp.save();\n                    jsonData.children = [];\n                }\n                currentData = jsonData;\n                return jsonData;\n            }\n            const newObj = Namespace.app.staff_data.create();\n            const currentDate = new Datetime();\n            newObj.data.json_staffing_data = JSON.stringify({ children: [] });\n            newObj.data.__name = `Штатное расписание от ${currentDate.format()}`;\n            currentData = { children: [] };\n            await newObj.save();\n            staffDataApp = newObj;\n            return { children: [] };\n        };\n        function deleteSearch(obj, targetKey) {\n            if (obj.children) {\n                let itemId;\n                for (let i = 0; i \u003c obj.children.length; i++) {\n                    if (obj.children[i].ref_key === targetKey) {\n                        itemId = i;\n                        break;\n                    }\n                }\n                if (typeof itemId === 'number') {\n                    obj.children.splice(itemId, 1);\n                    return true;\n                }\n                for (let item of obj.children) {\n                    let check = deleteSearch(item, targetKey);\n                    if (!!check) {\n                        return check;\n                    }\n                }\n            }\n            return null;\n        }\n        function addSearch(obj, targetId) {\n            if (obj.ref_key === targetId) {\n                return obj;\n            }\n            if (obj.children) {\n                for (let item of obj.children) {\n                    let check = addSearch(item, targetId);\n                    if (check) {\n                        return check;\n                    }\n                }\n            }\n            return null;\n        }\n        const deleteItem = async (e, refKey, itemType) =\u003e {\n            switch (itemType) {\n                case OrgLevel.LegalEntity:\n                    const orgItem = orgApps.find((f) =\u003e f.ref_key == refKey);\n                    if (!!orgItem) {\n                        await orgItem.delete();\n                    }\n                    break;\n                case OrgLevel.Subdivision:\n                    const subdivisionItem = subdivisionsApps.find((f) =\u003e f.ref_key == refKey);\n                    if (!!subdivisionItem) {\n                        await subdivisionItem.delete();\n                    }\n                    break;\n                case OrgLevel.Position:\n                    const positionItem = positions.find((f) =\u003e f.ref_key == refKey);\n                    if (!!positionItem) {\n                        await positionItem.delete();\n                    }\n                    break;\n            }\n            let foundItem = null;\n            deleteSearch(currentData, refKey);\n            const refElement = document.querySelector(`[data-key='${refKey}']`);\n            refElement.remove();\n            await saveNewObject();\n            closePopup(e);\n        };\n        const addItem = async (itemType, refKey, newOrg) =\u003e {\n            if (!!newOrg) {\n                const newOrg = orgApps.find((f) =\u003e f.data.ref_key == refKey);\n                const newItem = {\n                    description: newOrg.data.__name,\n                    division_key: null,\n                    owner_key: null,\n                    parent_key: null,\n                    position_key: null,\n                    ref_key: newOrg.data.ref_key || \"\",\n                    children: []\n                };\n                currentData.children.push(newItem);\n                await saveNewObject();\n                const root = document.querySelector('.staff-wrapper');\n                renderBranch(newItem, root, 0);\n            }\n            else {\n                let parent;\n                for (let i = 0; i \u003c currentData.children.length; i++) {\n                    const foundParent = addSearch(currentData.children[i], refKey);\n                    if (!!foundParent) {\n                        parent = foundParent;\n                        const newItem = {\n                            description: \"\",\n                            division_key: null,\n                            owner_key: currentData.children[i].ref_key,\n                            parent_key: foundParent.ref_key,\n                            position_key: \"00000000-0000-0000-0000-000000000000\",\n                            ref_key: generateUUID(),\n                            children: []\n                        };\n                        switch (itemType) {\n                            case OrgLevel.LegalEntity:\n                                newItem.description = Context.data.subdivision_name || \"\";\n                                break;\n                            case OrgLevel.Subdivision:\n                                newItem.description = Context.data.subdivision_name || \"\";\n                                const newAppItem = Namespace.app.structural_subdivision.create();\n                                const currentOrg = orgApps.find((f) =\u003e f.data.ref_key == (currentData.children[i].ref_key));\n                                const parentSubdivisionApp = await Namespace.app.structural_subdivision.search().where((f) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(parent.ref_key)).size(10000).first();\n                                newAppItem.data.organization = currentOrg;\n                                newAppItem.data.ref_key = newItem.ref_key;\n                                newAppItem.data.__name = newItem.description;\n                                newAppItem.data.owner_key = newItem.owner_key || \"00000000-0000-0000-0000-000000000000\";\n                                newAppItem.data.parent_key = newItem.owner_key === newItem.parent_key ? \"00000000-0000-0000-0000-000000000000\" : newItem.parent_key || \"00000000-0000-0000-0000-000000000000\";\n                                newAppItem.data.position_key = \"00000000-0000-0000-0000-000000000000\";\n                                newAppItem.data.subdivision = parentSubdivisionApp;\n                                await newAppItem.save();\n                                break;\n                            case OrgLevel.Position:\n                                newItem.description = Context.data.subdivision_full_name || \"\";\n                                newItem.children = null;\n                                const newAppPositionItem = Namespace.app.position.create();\n                                const currentPosOrg = await Namespace.app.organization.search().where((f) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(currentData.children[i].ref_key)).size(10000).first();\n                                const parentSubdivisionPosApp = await Namespace.app.structural_subdivision.search().where((f) =\u003e f.__deletedAt.eq(null) \u0026\u0026 f.ref_key.eq(parent.ref_key)).size(10000).first();\n                                newAppPositionItem.data.organization = currentPosOrg;\n                                newAppPositionItem.data.__name = newItem.description;\n                                newAppPositionItem.data.owner_key = newItem.owner_key || \"00000000-0000-0000-0000-000000000000\";\n                                newAppPositionItem.data.parent_key = newItem.owner_key === newItem.parent_key ? \"00000000-0000-0000-0000-000000000000\" : newItem.parent_key || \"00000000-0000-0000-0000-000000000000\";\n                                ;\n                                newAppPositionItem.data.ref_key = newItem.ref_key;\n                                newAppPositionItem.data.position_key = \"00000000-0000-0000-0000-000000000000\";\n                                newAppPositionItem.data.quantity = Context.data.subdivision_amount;\n                                newAppPositionItem.data.salary = Context.data.subdivision_salary;\n                                newAppPositionItem.data.subdivision = parentSubdivisionPosApp;\n                                newAppPositionItem.data.approval_date = Context.data.approval_date;\n                                await newAppPositionItem.save();\n                                break;\n                        }\n                        parent.children.push(newItem);\n                        break;\n                    }\n                    ;\n                }\n                if (!!parent) {\n                    const refElement = document.querySelector(`[data-key='${refKey}']`);\n                    const arrow = refElement.querySelector(\".list-item__arrow\");\n                    arrow.style.visibility = \"visible\";\n                    const refElementChildren = refElement.querySelector(\".list-item__children\");\n                    refElementChildren.innerHTML = \"\";\n                    parent.children.forEach((child) =\u003e {\n                        renderBranch(child, refElementChildren, parseInt(refElement.dataset.level) + 1);\n                    });\n                    await saveNewObject();\n                }\n            }\n            ;\n            Context.data.subdivision_amount = undefined;\n            Context.data.subdivision_full_name = undefined;\n            Context.data.subdivision_short_name = undefined;\n            Context.data.subdivision_salary = undefined;\n            Context.data.subdivision_name = undefined;\n            Context.data.approval_date = undefined;\n        };\n        const loadPositions = async (app, level, root) =\u003e {\n            var _a, _b, _c, _d, _e, _f;\n            if (!!app) {\n                if (app.data.staff) {\n                    let userApps = staff.filter((userApp) =\u003e {\n                        return !!app.data.staff.find((staffRef) =\u003e staffRef.id === userApp.data.__id);\n                    });\n                    if (app.data.staff_external_combination) {\n                        const staffExternalCombination = staff.filter((userApp) =\u003e {\n                            return !!app.data.staff_external_combination.find((staffRef) =\u003e staffRef.id === userApp.data.__id);\n                        });\n                        userApps = userApps.concat(staffExternalCombination);\n                    }\n                    if (app.data.staff_internal_combination) {\n                        const staffInternalCombination = staff.filter((userApp) =\u003e {\n                            return !!app.data.staff_internal_combination.find((staffRef) =\u003e staffRef.id === userApp.data.__id);\n                        });\n                        userApps = userApps.concat(staffInternalCombination);\n                    }\n                    const user_ids = userApps.map((f) =\u003e f.id);\n                    console.log(user_ids);\n                    for (let user of userApps) {\n                        const element = userTemplate.content.cloneNode(true);\n                        const descriptionElement = element.querySelector(\".list-item__text\");\n                        const descriptionElementNew = element.querySelector(\".list-item__new-user\");\n                        const descriptionElementSumbol = element.querySelector(\".list-item__sumbol\");\n                        descriptionElement.innerText = user.data.__name;\n                        const replacements = await System.replacements.search()\n                            .where((f, g) =\u003e g.and(f.absent.eq(user.data.ext_user), f.isInterrupted.eq(false), f.__deletedAt.eq(null)))\n                            .first();\n                        if (replacements \u0026\u0026 replacements.data.replacement) {\n                            descriptionElement.style.color = \"#9c9c9c\";\n                            descriptionElementNew.innerText = (await replacements.data.replacement.fetch()).data.__name;\n                            descriptionElementNew.style.display = \"block\";\n                            descriptionElementSumbol.innerText = \"➔\";\n                            descriptionElementSumbol.style.display = \"block\";\n                        }\n                        else {\n                            descriptionElementNew.style.display = \"none\";\n                            descriptionElementSumbol.style.display = \"none\";\n                            descriptionElement.style.color = \"#1e6599\";\n                        }\n                        const nameElement = element.querySelector(\".list-item-container\");\n                        nameElement.style.paddingLeft = `${27 + level * 36}px`;\n                        if (replacements \u0026\u0026 replacements.data.replacement) {\n                            const replacement_user = await replacements.data.replacement.fetch();\n                            const replacement_staff = await Namespace.app.staff.search()\n                                .where(f =\u003e f.ext_user.eq(replacement_user))\n                                .first();\n                            if (replacement_staff) {\n                                const cardNew = element.querySelector(\".user-card-new\");\n                                cardNew.dataset.key = replacement_staff.data.__id + 'new';\n                                const cardNameNew = cardNew.querySelector(\".user-card__name-new\");\n                                cardNameNew.innerText = replacement_staff.data.__name;\n                                if (replacement_staff.data.email) {\n                                    const cardEmailNew = cardNew.querySelector(\".user-card__email-new\");\n                                    cardEmailNew.innerText = (_a = replacement_staff.data.email) === null || _a === void 0 ? void 0 : _a.email;\n                                    cardEmailNew.href = `mailto: ${(_b = replacement_staff.data.email) === null || _b === void 0 ? void 0 : _b.email}`;\n                                }\n                                if (replacement_staff.data.phone) {\n                                    const cardPhoneNew = cardNew.querySelector(\".user-card__phone-new\");\n                                    cardPhoneNew.innerText = (_c = replacement_staff.data.phone) === null || _c === void 0 ? void 0 : _c.tel;\n                                }\n                                const userImageTextNew = element.querySelector(\".user-card__image-text-new\");\n                                userImageTextNew.innerText = replacement_staff.data.full_name.lastname[0] + replacement_staff.data.full_name.firstname[0];\n                                const userTextElementNew = element.querySelector(\".list-item__new-user\");\n                                userTextElementNew.addEventListener(\"click\", async (e) =\u003e {\n                                    e.stopPropagation();\n                                    const activeCardNew = document.querySelector(\".user-card-new--active\");\n                                    if (!!activeCardNew) {\n                                        activeCardNew.classList.remove(\"user-card-new--active\");\n                                    }\n                                    const userCardNew = document.querySelector(`[data-key='${replacement_staff.data.__id}new']`);\n                                    userCardNew.classList.toggle(\"user-card-new--active\");\n                                });\n                                cardNew.addEventListener(\"click\", (e) =\u003e {\n                                    e.stopPropagation();\n                                });\n                            }\n                        }\n                        const card = element.querySelector(\".user-card\");\n                        card.dataset.key = user.data.__id;\n                        const cardName = card.querySelector(\".user-card__name\");\n                        cardName.innerText = user.data.__name;\n                        if (user.data.email) {\n                            const cardEmail = card.querySelector(\".user-card__email\");\n                            cardEmail.innerText = (_d = user.data.email) === null || _d === void 0 ? void 0 : _d.email;\n                            cardEmail.href = `mailto: ${(_e = user.data.email) === null || _e === void 0 ? void 0 : _e.email}`;\n                        }\n                        if (user.data.phone) {\n                            const cardPhone = card.querySelector(\".user-card__phone\");\n                            cardPhone.innerText = (_f = user.data.phone) === null || _f === void 0 ? void 0 : _f.tel;\n                        }\n                        const userImageText = element.querySelector(\".user-card__image-text\");\n                        userImageText.innerText = user.data.full_name.lastname[0] + user.data.full_name.firstname[0];\n                        const userTextElement = element.querySelector(\".list-item__text\");\n                        userTextElement.addEventListener(\"click\", async (e) =\u003e {\n                            e.stopPropagation();\n                            const activeCard = document.querySelector(\".user-card--active\");\n                            if (!!activeCard) {\n                                activeCard.classList.remove(\"user-card--active\");\n                            }\n                            const userCard = document.querySelector(`[data-key='${user.data.__id}']`);\n                            userCard.classList.toggle(\"user-card--active\");\n                        });\n                        card.addEventListener(\"click\", (e) =\u003e {\n                            e.stopPropagation();\n                        });\n                        root.append(element);\n                    }\n                }\n            }\n        };\n        const renderBranch = async (branch, root, level) =\u003e {\n            var _a, _b, _c, _d, _e;\n            const element = elementTemplate.content.cloneNode(true);\n            const descriptionElement = element.querySelector(\".list-item__text\");\n            descriptionElement.innerText = branch.description;\n            const nameElement = element.querySelector(\".list-item-container\");\n            nameElement.style.paddingLeft = `${27 + level * 36}px`;\n            const wrapper = element.querySelector('.list-item__wrapper');\n            wrapper.dataset.key = branch.ref_key;\n            wrapper.dataset.level = level;\n            if (branch.children || level === 0 || branch.is_subdiv) {\n                nameElement.classList.add(\"list-item__department\");\n                const tableRow = element.querySelector(\".table__row\");\n                tableRow.addEventListener(\"click\", () =\u003e {\n                    closeActivePopup();\n                    const arrow = tableRow.querySelector(\".list-item__arrow\");\n                    arrow.classList.toggle(\"list-item__arrow--active\");\n                    tableRow.nextElementSibling.classList.toggle(\"list-item__children--active\");\n                });\n                const newRoot = element.querySelector(\".list-item__children\");\n                const departments = branch.children ? branch.children.filter((child) =\u003e !!child.children) : [];\n                const positions = branch.children ? branch.children.filter((child) =\u003e !child.children) : [];\n                departments.forEach((child) =\u003e {\n                    renderBranch(child, newRoot, level + 1);\n                });\n                positions.forEach((child) =\u003e {\n                    renderBranch(child, newRoot, level + 1);\n                });\n                const actionsElement = element.querySelector(\".list-item__actions\");\n                if (!branch.children || branch.children.length === 0) {\n                    const arrow = tableRow.querySelector(\".list-item__arrow\");\n                    arrow.style.visibility = \"hidden\";\n                }\n                let optionsPopup;\n                optionsPopup = optionsPopupTemplate.content.cloneNode(true);\n                if (createPositionPermission) {\n                    if (level != 0) {\n                        const addPositionBtn = optionsPopup.querySelector(\".option-list__add-position\");\n                        addPositionBtn.classList.add('enabled');\n                        addPositionBtn.addEventListener(\"click\", () =\u003e {\n                            openAddPopup(OrgLevel.Position, branch.ref_key);\n                        });\n                    }\n                }\n                if (createSubdivisionPermission) {\n                    const addDepBtn = optionsPopup.querySelector(\".option-list__add-department\");\n                    addDepBtn.classList.add('enabled');\n                    addDepBtn.addEventListener(\"click\", () =\u003e {\n                        openAddPopup(OrgLevel.Subdivision, branch.ref_key);\n                    });\n                }\n                let app;\n                if (level === 0) {\n                    app = orgApps === null || orgApps === void 0 ? void 0 : orgApps.find((org) =\u003e {\n                        return org.data.ref_key === branch.ref_key;\n                    });\n                    if (!app) {\n                        app = await Namespace.app.organization.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n                    }\n                    if (!isSuperuser) {\n                        let found = false;\n                        for (let org of staffOrgs) {\n                            let orgApp = await org.fetch();\n                            if (app.data.__id === orgApp.data.__id) {\n                                found = true;\n                                break;\n                            }\n                        }\n                        if (!found) {\n                            return;\n                        }\n                    }\n                }\n                else {\n                    app = subdivisionsApps === null || subdivisionsApps === void 0 ? void 0 : subdivisionsApps.find((subDiv) =\u003e {\n                        return subDiv.data.ref_key === branch.ref_key;\n                    });\n                    if (!app) {\n                        app = await Namespace.app.structural_subdivision.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n                    }\n                }\n                descriptionElement.innerText = app.data.__name;\n                const editPermission = level === 0 ? editOrgPermission : editSubdivisionPermission;\n                if (editPermission) {\n                    const editBtn = optionsPopup.querySelector(\".option-list__edit\");\n                    editBtn.classList.add('enabled');\n                    editBtn.href = `${window.location.href}(p:item/kedo/${level === 0 ? \"organization\" : \"structural_subdivision\"}/${app.data.__id}/edit)`;\n                }\n                const deletePermission = level === 0 ? deleteOrgPermission : editSubdivisionPermission;\n                if (deleteOrgPermission) {\n                    const deleteBtn = optionsPopup.querySelector(\".option-list__delete\");\n                    deleteBtn.classList.add(\"enabled\");\n                    deleteBtn.addEventListener(\"click\", () =\u003e {\n                        openDeletePopup(level === 0 ? OrgLevel.LegalEntity : OrgLevel.Subdivision, branch.ref_key);\n                    });\n                }\n                actionsElement.append(optionsPopup);\n                actionsElement.addEventListener(\"click\", (event) =\u003e {\n                    event.stopPropagation();\n                    const isCloseCurrent = !!event.target.querySelector(\".list-item__options-popup--active\");\n                    if (!isCloseCurrent) {\n                        const activePopup = document.querySelector(\".list-item__options-popup--active\");\n                        if (!!activePopup) {\n                            activePopup.classList.remove(\"list-item__options-popup--active\");\n                        }\n                        const activeOption = document.querySelector(\".list-item__actions--active\");\n                        if (!!activeOption) {\n                            activeOption.classList.remove(\"list-item__actions--active\");\n                        }\n                    }\n                    actionsElement.classList.toggle(\"list-item__actions--active\");\n                    const popup = actionsElement.querySelector(\".list-item__options-popup\");\n                    popup.classList.toggle(\"list-item__options-popup--active\");\n                });\n                if (!editPermission \u0026\u0026 !deletePermission \u0026\u0026 !createPositionPermission \u0026\u0026 !createSubdivisionPermission) {\n                    actionsElement.style.display = 'none';\n                }\n            }\n            else {\n                nameElement.classList.add(\"list-item__position\");\n                const amountElement = element.querySelector(\".list-item__amount\");\n                const dateElement = element.querySelector(\".list-item__date\");\n                const salaryElement = element.querySelector(\".list-item__salary\");\n                const tableRow = element.querySelector(\".table__row\");\n                const actionsElement = element.querySelector(\".list-item__actions\");\n                const optionsPopup = optionsPositionPopupTemplate.content.cloneNode(true);\n                let app = positions === null || positions === void 0 ? void 0 : positions.find((pos) =\u003e {\n                    return pos.data.ref_key === branch.ref_key;\n                });\n                if (!app) {\n                    app = await Namespace.app.position.search().where(f =\u003e f.ref_key.eq(branch.ref_key)).first();\n                }\n                const positionsLength = ((_a = app === null || app === void 0 ? void 0 : app.data.staff) === null || _a === void 0 ? void 0 : _a.length) + ((_b = app === null || app === void 0 ? void 0 : app.data.staff_internal_combination) === null || _b === void 0 ? void 0 : _b.length) + ((_c = app === null || app === void 0 ? void 0 : app.data.staff_external_combination) === null || _c === void 0 ? void 0 : _c.length);\n                if (!positionsLength) {\n                    const arrow = element.querySelector('.list-item__arrow');\n                    arrow.style.visibility = \"hidden\";\n                }\n                amountElement.innerText = (app === null || app === void 0 ? void 0 : app.data.quantity) || \"\";\n                dateElement.innerText = ((_d = app === null || app === void 0 ? void 0 : app.data.approval_date) === null || _d === void 0 ? void 0 : _d.format(\"DD.MM.YYYY\")) || \"\";\n                salaryElement.innerText = ((_e = app === null || app === void 0 ? void 0 : app.data.salary) === null || _e === void 0 ? void 0 : _e.asFloat()) || \"\";\n                if (editPositionPermission) {\n                    const editBtn = optionsPopup.querySelector(\".option-list__edit\");\n                    editBtn.classList.add('enabled');\n                    editBtn.href = `${window.location.href}(p:item/kedo/position/${app.data.__id}/edit)`;\n                }\n                if (deletePositionPermission) {\n                    const deleteBtn = optionsPopup.querySelector(\".option-list__delete\");\n                    deleteBtn.classList.add('enabled');\n                    deleteBtn.addEventListener(\"click\", () =\u003e {\n                        openDeletePopup(OrgLevel.Position, branch.ref_key);\n                    });\n                }\n                if (!editPositionPermission \u0026\u0026 !deletePositionPermission) {\n                    actionsElement.style.display = 'none';\n                }\n                actionsElement.append(optionsPopup);\n                tableRow.addEventListener(\"click\", async () =\u003e {\n                    var _a;\n                    closeActivePopup();\n                    const arrow = tableRow.querySelector(\".list-item__arrow\");\n                    arrow.classList.toggle(\"list-item__arrow--active\");\n                    tableRow.nextElementSibling.classList.toggle(\"list-item__children--active\");\n                    const refElement = document.querySelector(`[data-key='${app === null || app === void 0 ? void 0 : app.data.ref_key}']`);\n                    const childrenContainer = refElement.querySelector('.list-item__children');\n                    if (((_a = childrenContainer.children) === null || _a === void 0 ? void 0 : _a.length) === 0) {\n                        loadPositions(app, ++level, childrenContainer);\n                    }\n                });\n                actionsElement.addEventListener(\"click\", (event) =\u003e {\n                    event.stopPropagation();\n                    const isCloseCurrent = !!event.target.querySelector(\".list-item__options-popup--active\");\n                    if (!isCloseCurrent) {\n                        const activePopup = document.querySelector(\".list-item__options-popup--active\");\n                        if (!!activePopup) {\n                            activePopup.classList.remove(\"list-item__options-popup--active\");\n                        }\n                        const activeOption = document.querySelector(\".list-item__actions--active\");\n                        if (!!activeOption) {\n                            activeOption.classList.remove(\"list-item__actions--active\");\n                        }\n                    }\n                    actionsElement.classList.toggle(\"list-item__actions--active\");\n                    const popup = actionsElement.querySelector(\".list-item__options-popup\");\n                    popup.classList.toggle(\"list-item__options-popup--active\");\n                });\n            }\n            root.append(element);\n        };\n        const renderList = async (data, rootElement) =\u003e {\n            if (data.children) {\n                for (let i = 0; i \u003c data.children.length; i++) {\n                    renderBranch(data.children[i], rootElement, 0);\n                }\n            }\n        };\n        const init = async () =\u003e {\n            const root = document.querySelector(\".staff-wrapper\");\n            const data = await getData();\n            const addOrgBtn = document.querySelector('.staff__new-org-button');\n            if (createOrgPermission) {\n                addOrgBtn.classList.add('staff__new-org-button--active');\n                addOrgBtn.href = `${window.location.href}(p:item/kedo/organization)`;\n                addOrgBtn.addEventListener(\"click\", () =\u003e {\n                    let popupInterval;\n                    popupInterval = window.setInterval(async () =\u003e {\n                        const modal = document.querySelector(\".complex-popup\");\n                        if (!!modal) {\n                            const confirmBtn = modal.querySelector(\".btn.btn-primary\");\n                            const numberOfOrgs = await Namespace.app.organization.search().count();\n                            confirmBtn.addEventListener(\"click\", async () =\u003e {\n                                let checkInterval;\n                                checkInterval = window.setInterval(async () =\u003e {\n                                    const testOrgNumber = await Namespace.app.organization.search().count();\n                                    if (testOrgNumber \u003e numberOfOrgs) {\n                                        window.clearInterval(checkInterval);\n                                        const allOrg = await Namespace.app.organization.search().where(f =\u003e f.__deletedAt.eq(null)).size(10000).all();\n                                        const sortedOrgs = allOrg.sort((a, b) =\u003e {\n                                            const aDate = a.data.__createdAt.asDate();\n                                            const bDate = b.data.__createdAt.asDate();\n                                            return bDate - aDate;\n                                        });\n                                        const newOrg = sortedOrgs[0];\n                                        if (newOrg) {\n                                            newOrg.data.ref_key = generateUUID();\n                                            await newOrg.save();\n                                            orgApps.push(newOrg);\n                                            await addItem(OrgLevel.LegalEntity, newOrg.data.ref_key, true);\n                                        }\n                                    }\n                                }, 1500);\n                            });\n                            window.clearInterval(popupInterval);\n                        }\n                    }, 1000);\n                });\n            }\n            renderList(data, root);\n        };\n        const closeOptionsPopup = () =\u003e {\n            const activeActions = document.querySelector(\".list-item__actions--active\");\n            if (!!activeActions) {\n                activeActions.classList.remove(\"list-item__actions--active\");\n            }\n            const activeOptions = document.querySelector(\".list-item__options-popup--active\");\n            if (!!activeOptions) {\n                activeOptions.classList.remove(\"list-item__options-popup--active\");\n            }\n        };\n        const closePopup = (e, containerId) =\u003e {\n            e.stopPropagation();\n            if (containerId) {\n                const elements = document.querySelector(`#${containerId}`);\n                const preloadContainer = document.querySelector('.ui-teml');\n                preloadContainer.append(elements);\n            }\n            const wrapper = document.querySelector(\".staff__backdrop\");\n            wrapper.remove();\n            closeOptionsPopup();\n        };\n        const openDeletePopup = (type, refKey) =\u003e {\n            let title = \"\";\n            let description = \"\";\n            switch (type) {\n                case OrgLevel.LegalEntity:\n                    title = \"Удалить организацию ?\";\n                    description = \"Организация и данные о ней удалятся навсегда — восстановить его её получится.\";\n                    break;\n                case OrgLevel.Subdivision:\n                    title = \"Удалить подразделение ?\";\n                    description = \"Подразделение и данные о нём удалятся навсегда — восстановить его не получится.\";\n                    break;\n                case OrgLevel.Position:\n                    title = \"Удалить должность ?\";\n                    description = \"Должность и данные о ней удалятся навсегда — восстановить её не получится.\";\n                    break;\n            }\n            const popup = deletePopupTemplate.content.cloneNode(true);\n            const popupTitle = popup.querySelector(\".staff__popup-title-text\");\n            popupTitle.innerText = title;\n            const popupDescription = popup.querySelector(\".staff__popup-description-text\");\n            popupDescription.innerText = description;\n            const innerPopup = popup.querySelector(\".staff__popup\");\n            innerPopup.addEventListener(\"click\", (e) =\u003e {\n                e.stopPropagation();\n            });\n            const backdrop = popup.querySelector(\".staff__backdrop\");\n            backdrop.addEventListener(\"click\", closePopup);\n            const cancelIcon = popup.querySelector('.staff__popup-exit-icon');\n            cancelIcon.addEventListener(\"click\", closePopup);\n            const cancelBtn = popup.querySelector('.staff__popup-cancel');\n            cancelBtn.addEventListener(\"click\", closePopup);\n            const confirmBtn = popup.querySelector('.staff__popup-confirm');\n            confirmBtn.addEventListener(\"click\", async (e) =\u003e {\n                showPopupBtnPreloader();\n                await deleteItem(e, refKey, type);\n            });\n            const wrapper = document.querySelector(\".app-wrapper\");\n            wrapper.append(popup);\n        };\n        const openAddPopup = (itemType, refKey) =\u003e {\n            let elementId = \"\";\n            let title = \"\";\n            switch (itemType) {\n                case OrgLevel.LegalEntity:\n                    return;\n                    title = \"Добавить организацию\";\n                    elementId = \"org-add-popup\";\n                    break;\n                case OrgLevel.Subdivision:\n                    title = \"Добавить подразделение\";\n                    elementId = \"subdivision-add-popup\";\n                    break;\n                case OrgLevel.Position:\n                    title = \"Добавить должность\";\n                    elementId = \"position-add-popup\";\n                    break;\n            }\n            const innerPopupContent = document.querySelector(`#${elementId}`);\n            const popup = addPopupTemplate.content.cloneNode(true);\n            const popupTitle = popup.querySelector(\".staff__popup-title-text\");\n            popupTitle.innerText = title;\n            const popupDescription = popup.querySelector(\".staff__popup-description\");\n            popupDescription.append(innerPopupContent);\n            const innerPopup = popup.querySelector(\".staff__popup\");\n            innerPopup.addEventListener(\"click\", (e) =\u003e {\n                e.stopPropagation();\n            });\n            const backdrop = popup.querySelector(\".staff__backdrop\");\n            backdrop.addEventListener(\"click\", (e) =\u003e {\n                closePopup(e, elementId);\n            });\n            const cancelIcon = popup.querySelector('.staff__popup-exit-icon');\n            cancelIcon.addEventListener(\"click\", (e) =\u003e {\n                closePopup(e, elementId);\n            });\n            const cancelBtn = popup.querySelector('.staff__popup-cancel');\n            cancelBtn.addEventListener(\"click\", (e) =\u003e {\n                closePopup(e, elementId);\n            });\n            const confirmBtn = popup.querySelector('.staff__popup-confirm');\n            confirmBtn.addEventListener(\"click\", async (e) =\u003e {\n                const isValid = validate(itemType);\n                if (isValid) {\n                    hideFormError();\n                    showPopupBtnPreloader();\n                    await addItem(itemType, refKey);\n                    closePopup(e, elementId);\n                }\n                else {\n                    showFormError();\n                }\n            });\n            const wrapper = document.querySelector(\".app-wrapper\");\n            wrapper.append(popup);\n        };\n        async function renderPage() {\n            var _a, _b, _c, _d, _e, _f;\n            elementTemplate = document.querySelector(\".schedule__template\");\n            optionsPopupTemplate = document.querySelector(\".options-template\");\n            userTemplate = document.querySelector(\".schedule__template--person\");\n            optionsLegalPopupTemplate = document.querySelector(\".options-template__legal\");\n            optionsPositionPopupTemplate = document.querySelector(\".options-template__position\");\n            deletePopupTemplate = document.querySelector(\".staff-delete-popup\");\n            addPopupTemplate = document.querySelector(\".staff-add-popup\");\n            const pageWrapper = document.querySelector('.staff-page-wrapper');\n            pageWrapper.addEventListener(\"click\", () =\u003e {\n                const activeCard = document.querySelector(\".user-card--active\");\n                if (!activeCard)\n                    return;\n                activeCard.classList.remove(\"user-card--active\");\n            });\n            pageWrapper.addEventListener(\"click\", () =\u003e {\n                const activeCard = document.querySelector(\".user-card-new--active\");\n                if (!activeCard)\n                    return;\n                activeCard.classList.remove(\"user-card-new--active\");\n            });\n            const positionsPromise = Namespace.app.position.search().where((f) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n            const subdivisionsAppsPromise = Namespace.app.structural_subdivision.search().where((f) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n            const orgAppsPromise = Namespace.app.organization.search().where((f) =\u003e f.__deletedAt.eq(null)).size(1000).all();\n            const currentUserPromise = System.users.getCurrentUser();\n            const positionPermissionPromise = Namespace.app.position.getPermissions();\n            const orgPermissionPromise = Namespace.app.organization.getPermissions();\n            const subdivisionPermissionPromise = Namespace.app.structural_subdivision.getPermissions();\n            let positionPermissions, orgPermissions, subdivisionPermissions;\n            [positionPermissions, orgPermissions, subdivisionPermissions, positions, orgApps, subdivisionsApps, currentUser] = await Promise.all([positionPermissionPromise, orgPermissionPromise, subdivisionPermissionPromise, positionsPromise, orgAppsPromise, subdivisionsAppsPromise, currentUserPromise]);\n            isSuperuser = !!currentUser.data.groupIds.find((group) =\u003e group.id === '331e62d2-072e-58ac-9581-74abcc67f050' || group.id === 'd6000da0-c9aa-55eb-9882-f118b432730b');\n            if (isSuperuser) {\n                createOrgPermission = true;\n                editOrgPermission = true;\n                deleteOrgPermission = true;\n                createSubdivisionPermission = true;\n                editSubdivisionPermission = true;\n                deleteSubdivisionPermission = true;\n                createPositionPermission = true;\n                editPositionPermission = true;\n                deletePositionPermission = true;\n            }\n            else {\n                const staff = await Namespace.app.staff.search().where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(currentUser))).first();\n                if (staff \u0026\u0026 staff.data.employment_table) {\n                    for (let item of staff.data.employment_table) {\n                        if (item.organization) {\n                            staffOrgs.push(item.organization);\n                        }\n                    }\n                    ;\n                }\n                const orgPermissionGroups = orgPermissions.__permissions.values;\n                const orgPermissionsSet = new Set();\n                for (let i = 0; i \u003c orgPermissionGroups.length; i++) {\n                    const userGroupPermiss = (_a = currentUser.data.groupIds) === null || _a === void 0 ? void 0 : _a.find((group) =\u003e group.id === orgPermissionGroups[i].group.id);\n                    if (!userGroupPermiss)\n                        continue;\n                    (_b = orgPermissionGroups[i].types) === null || _b === void 0 ? void 0 : _b.forEach((typePermiss) =\u003e {\n                        orgPermissionsSet.add(typePermiss);\n                    });\n                }\n                ;\n                createOrgPermission = orgPermissionsSet.has('create');\n                editOrgPermission = orgPermissionsSet.has('update');\n                deleteOrgPermission = orgPermissionsSet.has('delete');\n                const subPermissionGroups = subdivisionPermissions.__permissions.values;\n                const subPermissionsSet = new Set();\n                for (let i = 0; i \u003c subPermissionGroups.length; i++) {\n                    const userGroupPermiss = (_c = currentUser.data.groupIds) === null || _c === void 0 ? void 0 : _c.find((group) =\u003e group.id === subPermissionGroups[i].group.id);\n                    if (!userGroupPermiss)\n                        continue;\n                    (_d = subPermissionGroups[i].types) === null || _d === void 0 ? void 0 : _d.forEach((typePermiss) =\u003e {\n                        subPermissionsSet.add(typePermiss);\n                    });\n                }\n                ;\n                createSubdivisionPermission = subPermissionsSet.has('create');\n                editSubdivisionPermission = subPermissionsSet.has('update');\n                deleteSubdivisionPermission = subPermissionsSet.has('delete');\n                const posPermissionGroups = positionPermissions.__permissions.values;\n                const posPermissionsSet = new Set();\n                for (let i = 0; i \u003c posPermissionGroups.length; i++) {\n                    const userGroupPermiss = (_e = currentUser.data.groupIds) === null || _e === void 0 ? void 0 : _e.find((group) =\u003e group.id === posPermissionGroups[i].group.id);\n                    if (!userGroupPermiss)\n                        continue;\n                    (_f = posPermissionGroups[i].types) === null || _f === void 0 ? void 0 : _f.forEach((typePermiss) =\u003e {\n                        posPermissionsSet.add(typePermiss);\n                    });\n                }\n                ;\n                createPositionPermission = posPermissionsSet.has('create');\n                editPositionPermission = posPermissionsSet.has('update');\n                deletePositionPermission = posPermissionsSet.has('delete');\n            }\n            init();\n            staff = await Namespace.app.staff.search().where((f) =\u003e f.__deletedAt.eq(null)).size(10000).all();\n        }\n        return {\n            deleteSearch,\n            addSearch,\n            renderPage\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n",
    "clientFnDeclarations": [
      {
        "name": "deleteSearch",
        "parameters": [
          {
            "name": "[object Object]",
            "type": "[object Object]"
          },
          {
            "name": "[object Object]",
            "type": "[object Object]"
          }
        ],
        "type": "[object Object]"
      },
      {
        "name": "addSearch",
        "parameters": [
          {
            "name": "[object Object]",
            "type": "[object Object]"
          },
          {
            "name": "[object Object]",
            "type": "[object Object]"
          }
        ],
        "type": "[object Object]"
      },
      {
        "name": "renderPage",
        "parameters": [],
        "type": ""
      }
    ]
  },
  "__createdAt": "2024-04-24T13:43:17.912804807Z",
  "__createdBy": "e6fbb566-3df2-420e-a7f3-03b97d2ac599",
  "__updatedAt": "2024-05-06T14:34:07.990115147Z",
  "__updatedBy": "e6fbb566-3df2-420e-a7f3-03b97d2ac599",
  "__deletedAt": null
}
