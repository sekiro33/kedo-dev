{"__id":"018fb8c3-2bfd-71df-bb13-3e25dbe8c63f","namespace":"kedo","code":"_all_employees","__name":"Трудоустройство сотрудников","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":4,"hidden":true,"draft":false,"readonly":false,"descriptor":{"types":["page"],"template":{"id":"02e8a3f3-a395-4d19-98c3-181cfb9bb044","descriptor":"custom-page","values":{"systemFunctions":{}},"content":{"":[{"id":"9502c068-73ea-45c4-92a4-3442a7882f38","descriptor":"page-content","content":{"":[{"id":"02d0bb19-a4ae-4cba-8808-d69c2a5e71b3","descriptor":"code","values":{"contentPlaceholder":"HTML CSS","html":"  \u003cdiv class=\"kedo__employment\"\u003e\n    \u003cdiv class=\"kedo__employment-title-wrapper\"\u003e\n      \u003cdiv class=\"kedo__employment-title-img\"\u003e\n        \u003csvg width=\"13\" height=\"15\" viewBox=\"0 0 13 15\" fill=\"none\"\u003e\n          \u003cg\u003e\n            \u003cpath\n              d=\"M6.96429 6.09375C7.33159 6.09375 7.69065 5.98378 7.99606 5.77776C8.30146 5.57173 8.5395 5.27889 8.68006 4.93628C8.82062 4.59367 8.8574 4.21667 8.78574 3.85296C8.71409 3.48924 8.53721 3.15515 8.27748 2.89292C8.01776 2.6307 7.68685 2.45212 7.3266 2.37978C6.96635 2.30743 6.59294 2.34456 6.25359 2.48648C5.91424 2.62839 5.62419 2.86871 5.42013 3.17706C5.21606 3.4854 5.10714 3.84791 5.10714 4.21875C5.10714 4.71603 5.30281 5.19294 5.65109 5.54458C5.99937 5.89621 6.47174 6.09375 6.96429 6.09375ZM13 11.25V0.46875C13 0.34443 12.9511 0.225201 12.864 0.137294C12.7769 0.049386 12.6588 0 12.5357 0L2.32143 0C1.70575 0 1.11528 0.24693 0.679931 0.686468C0.244578 1.12601 0 1.72215 0 2.34375L0 12.6562C0 13.2779 0.244578 13.874 0.679931 14.3135C1.11528 14.7531 1.70575 15 2.32143 15H12.5357C12.6588 15 12.7769 14.9506 12.864 14.8627C12.9511 14.7748 13 14.6556 13 14.5312V14.0625C13 13.9539 12.9627 13.8487 12.8944 13.7648C12.8262 13.6809 12.7312 13.6236 12.6257 13.6025C12.5038 13.2217 12.5038 12.0908 12.6257 11.71C12.7312 11.6889 12.8262 11.6316 12.8944 11.5477C12.9627 11.4638 13 11.3586 13 11.25ZM11.433 13.5938H2.32143C2.07516 13.5938 1.83897 13.495 1.66483 13.3192C1.49069 13.1433 1.39286 12.9049 1.39286 12.6562C1.39286 12.4076 1.49069 12.1692 1.66483 11.9933C1.83897 11.8175 2.07516 11.7188 2.32143 11.7188H11.433C11.3547 12.2256 11.3547 13.0869 11.433 13.5938ZM11.6071 10.3125H2.32143C2.00177 10.3122 1.68553 10.379 1.39286 10.5088V2.34375C1.39286 2.09511 1.49069 1.85665 1.66483 1.68084C1.83897 1.50502 2.07516 1.40625 2.32143 1.40625H11.6071V10.3125ZM4.17857 9.375H9.75C9.87314 9.375 9.99123 9.32561 10.0783 9.23771C10.1654 9.1498 10.2143 9.03057 10.2143 8.90625V8.25C10.2143 7.31807 9.34114 6.5625 8.26429 6.5625H8.12065C7.75438 6.71721 7.36131 6.79688 6.96429 6.79688C6.56726 6.79688 6.17419 6.71721 5.80792 6.5625H5.66283C4.58598 6.5625 3.71283 7.31807 3.71283 8.25V8.90625C3.71283 8.96793 3.72489 9.029 3.74831 9.08597C3.77174 9.14294 3.80607 9.19468 3.84933 9.23822C3.8926 9.28177 3.94395 9.31627 4.00045 9.33974C4.05695 9.36321 4.11748 9.37519 4.17857 9.375Z\"\n              fill=\"white\" /\u003e\n          \u003c/g\u003e\n        \u003c/svg\u003e\n      \u003c/div\u003e\n      \u003ch3 class=\"kedo__employment-title\"\u003eСотрудники в процессе трудоустройства\u003c/h3\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"kedo__employment-files-wrapper\"\u003e\n      \u003cdiv class=\"kedo__employment-table-head\"\u003e\n        \u003cdiv class=\"kedo__employment-table-head-text-wrapper\"\u003e\n          \u003cp class=\"kedo__employment-table-head-text\"\u003eСотрудник\u003c/p\u003e\n          \u003cdiv class=\"kedo__employment-table-head-arrow\"\u003e\u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"kedo__employment-table-head-text-wrapper\"\u003e\n          \u003cp class=\"kedo__employment-table-head-text\"\u003eДата\u003c/p\u003e\n          \u003cdiv class=\"kedo__employment-table-head-arrow\"\u003e\u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"kedo__employment-table-head-text-wrapper\"\u003e\n          \u003cp class=\"kedo__employment-table-head-text\"\u003eСтатус оформления\u003c/p\u003e\n          \u003cdiv class=\"kedo__employment-table-head-arrow\"\u003e\u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"kedo__employment-table-head-text-wrapper\"\u003e\n          \u003cp class=\"kedo__employment-table-head-text\"\u003eПримечание\u003c/p\u003e\n          \u003cdiv class=\"kedo__employment-table-head-arrow\"\u003e\u003c/div\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n      \u003cul class=\"kedo__employment-table-section-list\"\u003e\n      \u003c/ul\u003e\n    \u003c/div\u003e\n     \u003c% if (Context.data.view_message) { %\u003e\n      \u003cdiv style = font-size:17pt\u003eОтсутствуют субъекты проходящие регистрацию и/или трудоустройство в КЭДО \u003c/div\u003e\n      \u003c% } %\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"kedo-loader-wrapper-employment\"\u003e\n  \u003cdiv class=\"kedo-loader-img\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003ctemplate class=\"kedo__employment-table-section-list-item-template\"\u003e\n  \u003cli class=\"kedo__employment-table-section-list-item\"\u003e\n    \u003ca href=\"\"  class=\"kedo__employment-table-string-user-name\"\u003e\u003c/a\u003e\n    \u003cp class=\"kedo__employment-table-string-date\"\u003e\u003c/p\u003e\n    \u003cdiv class=\"kedo__employment-table-string-status-wrapper\"\u003e\n      \u003cdiv class=\"kedo__employment-table-string-status-img\"\u003e\u003c/div\u003e\n      \u003cp class=\"kedo__employment-table-string-status-text\"\u003e\u003c/p\u003e\n    \u003c/div\u003e\n    \u003cdiv\u003e\n      \u003ca href=\"#\" class=\"kedo__employment-table-string-task kedo__employment-table-string-task_link\"\u003e\u003c/a\u003e\n      \u003cp class=\"kedo__employment-table-string-task kedo__employment-table-string-task_text\"\u003e\u003c/p\u003e\n    \u003c/div\u003e\n  \u003c/li\u003e\n\u003c/template\u003e\n\n\u003cstyle\u003e\n.kedo__employment {\n  --color-primary: #1e6599;\n  --color-primary-hover: #367eb2;\n  width: 100%;\n  padding: 25px 32px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-align: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  position: relative;\n}\n.kedo__employment-title-wrapper {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-bottom: 25px;\n}\n.kedo__employment-title-img {\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  margin-right: 8px;\n  background: #5082E6;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  /* background: #5082E6 url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2213%22%20height%3D%2215%22%20viewBox%3D%220%200%2013%2015%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip0_488_2563%29%22%3E%0A%3Cpath%20d%3D%22M6.96429%206.09375C7.33159%206.09375%207.69065%205.98378%207.99606%205.77776C8.30146%205.57173%208.5395%205.27889%208.68006%204.93628C8.82062%204.59367%208.8574%204.21667%208.78574%203.85296C8.71409%203.48924%208.53721%203.15515%208.27748%202.89292C8.01776%202.6307%207.68685%202.45212%207.3266%202.37978C6.96635%202.30743%206.59294%202.34456%206.25359%202.48648C5.91424%202.62839%205.62419%202.86871%205.42013%203.17706C5.21606%203.4854%205.10714%203.84791%205.10714%204.21875C5.10714%204.71603%205.30281%205.19294%205.65109%205.54458C5.99937%205.89621%206.47174%206.09375%206.96429%206.09375ZM13%2011.25V0.46875C13%200.34443%2012.9511%200.225201%2012.864%200.137294C12.7769%200.049386%2012.6588%200%2012.5357%200L2.32143%200C1.70575%200%201.11528%200.24693%200.679931%200.686468C0.244578%201.12601%200%201.72215%200%202.34375L0%2012.6562C0%2013.2779%200.244578%2013.874%200.679931%2014.3135C1.11528%2014.7531%201.70575%2015%202.32143%2015H12.5357C12.6588%2015%2012.7769%2014.9506%2012.864%2014.8627C12.9511%2014.7748%2013%2014.6556%2013%2014.5312V14.0625C13%2013.9539%2012.9627%2013.8487%2012.8944%2013.7648C12.8262%2013.6809%2012.7312%2013.6236%2012.6257%2013.6025C12.5038%2013.2217%2012.5038%2012.0908%2012.6257%2011.71C12.7312%2011.6889%2012.8262%2011.6316%2012.8944%2011.5477C12.9627%2011.4638%2013%2011.3586%2013%2011.25ZM11.433%2013.5938H2.32143C2.07516%2013.5938%201.83897%2013.495%201.66483%2013.3192C1.49069%2013.1433%201.39286%2012.9049%201.39286%2012.6562C1.39286%2012.4076%201.49069%2012.1692%201.66483%2011.9933C1.83897%2011.8175%202.07516%2011.7188%202.32143%2011.7188H11.433C11.3547%2012.2256%2011.3547%2013.0869%2011.433%2013.5938ZM11.6071%2010.3125H2.32143C2.00177%2010.3122%201.68553%2010.379%201.39286%2010.5088V2.34375C1.39286%202.09511%201.49069%201.85665%201.66483%201.68084C1.83897%201.50502%202.07516%201.40625%202.32143%201.40625H11.6071V10.3125ZM4.17857%209.375H9.75C9.87314%209.375%209.99123%209.32561%2010.0783%209.23771C10.1654%209.1498%2010.2143%209.03057%2010.2143%208.90625V8.25C10.2143%207.31807%209.34114%206.5625%208.26429%206.5625H8.12065C7.75438%206.71721%207.36131%206.79688%206.96429%206.79688C6.56726%206.79688%206.17419%206.71721%205.80792%206.5625H5.66283C4.58598%206.5625%203.71283%207.31807%203.71283%208.25V8.90625C3.71283%208.96793%203.72489%209.029%203.74831%209.08597C3.77174%209.14294%203.80607%209.19468%203.84933%209.23822C3.8926%209.28177%203.94395%209.31627%204.00045%209.33974C4.05695%209.36321%204.11748%209.37519%204.17857%209.375Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_488_2563%22%3E%0A%3Crect%20width%3D%2213%22%20height%3D%2215%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A) no-repeat 8px center / 13px 15px; */\n}\n.kedo__employment-title {\n  font-style: normal;\n  font-weight: 600;\n  font-size: 24px;\n  line-height: 32px;\n  margin: 0;\n  padding: 0;\n}\n.kedo__employment-files-wrapper {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-align: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n  margin-bottom: 8px;\n  min-height: 200px;\n}\n.kedo__employment-table-head {\n  display: -ms-grid;\n  display: grid;\n  grid-template-columns: 30% 20% 20% 30%;\n  gap: 1%;\n  border-bottom: 1px solid #CAD1D8;\n  padding: 0 0 6px;\n}\n.kedo__employment-table-head-text-wrapper {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.kedo__employment-table-head-text {\n  font-style: normal;\n  font-weight: 600;\n  font-size: 15px;\n  line-height: 22px;\n  color: #8C8C8C;\n  margin: 0;\n  padding: 0;\n}\n.kedo__employment-table-head-arrow {\n  width: 10px;\n  height: 6px;\n  margin-left: 9px;\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%228%22%20height%3D%225%22%20viewBox%3D%220%200%208%205%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M0.5%201L4%204.5L7.5%201%22%20stroke%3D%22%238C8C8C%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-section-list {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-align: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n}\n.kedo__employment-table-section-list-item {\n  display: -ms-grid;\n  display: grid;\n  grid-template-columns: 30% 20% 20% 30%;\n  gap: 1%;\n  border-bottom: 1px solid #CAD1D8;\n  padding: 15px 0 15px;\n  margin: 0;\n}\n.kedo__employment-table-section-list-item:last-child{\n  border-bottom: none;\n}\n.kedo__employment-table-string-user-name {\n  font-style: normal;\n  font-weight: 400;\n  font-size: 15px;\n  line-height: 22px;\n  color: #1E6599;\n  margin: 0;\n  padding: 0;\n  text-decoration: none;\n  overflow: hidden;\n}\n.kedo__employment-table-string-user-name:hover{\n  cursor: pointer;\n  text-decoration: underline;\n}\n.kedo__employment-table-string-date {\n  margin: 0;\n  padding: 0;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 14px;\n  line-height: 140%;\n  color: #323232;\n  overflow: hidden;\n}\n.kedo__employment-table-string-status-wrapper {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.kedo__employment-table-string-status-img {\n  width: 16px;\n  height: 16px;\n  margin-right: 8px;\n}\n.kedo__employment-table-string-status-img_status_0-4 {\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16%208C16%2012.4183%2012.4183%2016%208%2016C3.58172%2016%200%2012.4183%200%208C0%203.58172%203.58172%200%208%200C12.4183%200%2016%203.58172%2016%208ZM2.4%208C2.4%2011.0928%204.90721%2013.6%208%2013.6C11.0928%2013.6%2013.6%2011.0928%2013.6%208C13.6%204.90721%2011.0928%202.4%208%202.4C4.90721%202.4%202.4%204.90721%202.4%208Z%22%20fill%3D%22%23E2E5E7%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-string-status-img_status_1-4 {\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16%208C16%2012.4183%2012.4183%2016%208%2016C3.58172%2016%200%2012.4183%200%208C0%203.58172%203.58172%200%208%200C12.4183%200%2016%203.58172%2016%208ZM2.4%208C2.4%2011.0928%204.90721%2013.6%208%2013.6C11.0928%2013.6%2013.6%2011.0928%2013.6%208C13.6%204.90721%2011.0928%202.4%208%202.4C4.90721%202.4%202.4%204.90721%202.4%208Z%22%20fill%3D%22%23E2E5E7%22%2F%3E%0A%3Cpath%20d%3D%22M16%208C16%206.94942%2015.7931%205.90914%2015.391%204.93853C14.989%203.96793%2014.3997%203.08601%2013.6569%202.34315C12.914%201.60028%2012.0321%201.011%2011.0615%200.608964C10.0909%200.206926%209.05057%200%208%200V2.4C8.7354%202.4%209.4636%202.54485%2010.143%202.82627C10.8225%203.1077%2011.4398%203.52019%2011.9598%204.0402C12.4798%204.56021%2012.8923%205.17755%2013.1737%205.85697C13.4552%206.5364%2013.6%207.2646%2013.6%208H16Z%22%20fill%3D%22%231E6599%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-string-status-img_status_2-4 {\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16%208C16%2012.4183%2012.4183%2016%208%2016C3.58172%2016%200%2012.4183%200%208C0%203.58172%203.58172%200%208%200C12.4183%200%2016%203.58172%2016%208ZM2.4%208C2.4%2011.0928%204.90721%2013.6%208%2013.6C11.0928%2013.6%2013.6%2011.0928%2013.6%208C13.6%204.90721%2011.0928%202.4%208%202.4C4.90721%202.4%202.4%204.90721%202.4%208Z%22%20fill%3D%22%23E2E5E7%22%2F%3E%0A%3Cpath%20d%3D%22M8%2016C9.05058%2016%2010.0909%2015.7931%2011.0615%2015.391C12.0321%2014.989%2012.914%2014.3997%2013.6569%2013.6569C14.3997%2012.914%2014.989%2012.0321%2015.391%2011.0615C15.7931%2010.0909%2016%209.05057%2016%208C16%206.94942%2015.7931%205.90913%2015.391%204.93853C14.989%203.96793%2014.3997%203.08601%2013.6569%202.34314C12.914%201.60028%2012.0321%201.011%2011.0615%200.608962C10.0909%200.206925%209.05057%20-5.1348e-07%208%200L8%202.4C8.7354%202.4%209.4636%202.54485%2010.143%202.82627C10.8224%203.1077%2011.4398%203.52019%2011.9598%204.0402C12.4798%204.56021%2012.8923%205.17755%2013.1737%205.85697C13.4552%206.53639%2013.6%207.2646%2013.6%208C13.6%208.7354%2013.4552%209.4636%2013.1737%2010.143C12.8923%2010.8224%2012.4798%2011.4398%2011.9598%2011.9598C11.4398%2012.4798%2010.8225%2012.8923%2010.143%2013.1737C9.4636%2013.4552%208.7354%2013.6%208%2013.6V16Z%22%20fill%3D%22%231E6599%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-string-status-img_status_3-4 {\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16%208C16%2012.4183%2012.4183%2016%208%2016C3.58172%2016%200%2012.4183%200%208C0%203.58172%203.58172%200%208%200C12.4183%200%2016%203.58172%2016%208ZM2.4%208C2.4%2011.0928%204.90721%2013.6%208%2013.6C11.0928%2013.6%2013.6%2011.0928%2013.6%208C13.6%204.90721%2011.0928%202.4%208%202.4C4.90721%202.4%202.4%204.90721%202.4%208Z%22%20fill%3D%22%23E2E5E7%22%2F%3E%0A%3Cpath%20d%3D%22M0%208C0%209.58225%200.469192%2011.129%201.34824%2012.4446C2.22729%2013.7602%203.47672%2014.7855%204.93853%2015.391C6.40034%2015.9965%208.00887%2016.155%209.56072%2015.8463C11.1126%2015.5376%2012.538%2014.7757%2013.6569%2013.6569C14.7757%2012.538%2015.5376%2011.1126%2015.8463%209.56072C16.155%208.00887%2015.9965%206.40034%2015.391%204.93853C14.7855%203.47672%2013.7602%202.22729%2012.4446%201.34824C11.129%200.469192%209.58225%20-1.88681e-08%208%200L8%202.4C9.10758%202.4%2010.1903%202.72843%2011.1112%203.34377C12.0321%203.95911%2012.7499%204.83371%2013.1737%205.85697C13.5976%206.88024%2013.7085%208.00621%2013.4924%209.09251C13.2763%2010.1788%2012.743%2011.1766%2011.9598%2011.9598C11.1766%2012.743%2010.1788%2013.2763%209.09251%2013.4924C8.00621%2013.7085%206.88024%2013.5976%205.85697%2013.1737C4.83371%2012.7499%203.95911%2012.0321%203.34377%2011.1112C2.72843%2010.1903%202.4%209.10758%202.4%208H0Z%22%20fill%3D%22%231E6599%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-string-status-img_status_4-4 {\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16%208C16%2012.4183%2012.4183%2016%208%2016C3.58172%2016%200%2012.4183%200%208C0%203.58172%203.58172%200%208%200C12.4183%200%2016%203.58172%2016%208ZM2.4%208C2.4%2011.0928%204.90721%2013.6%208%2013.6C11.0928%2013.6%2013.6%2011.0928%2013.6%208C13.6%204.90721%2011.0928%202.4%208%202.4C4.90721%202.4%202.4%204.90721%202.4%208Z%22%20fill%3D%22%231E6599%22%2F%3E%0A%3C%2Fsvg%3E%0A) no-repeat center / contain;\n}\n.kedo__employment-table-string-status-text {\n  margin: 0;\n  padding: 0;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 15px;\n  line-height: 22px;\n  color: #000000;\n  overflow: hidden;\n}\n\n.kedo__employment-btn-all{\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  padding: 5px 12px;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 15px;\n  line-height: 22px;\n  text-decoration: none;\n}\n\n.kedo-button{\n  border: none;\n  border-radius: 4px;\n  -webkit-transition: 0.3s;\n  -o-transition: 0.3s;\n  transition: 0.3s;\n}\n.kedo-button_color_blue{\n  background: var(--color-primary);\n  color: #FFFFFF;\n}\n.kedo-button_color_blue:hover{\n  cursor: pointer;\n  background: var(--color-primary-hover);\n  color: #FFFFFF;\n  text-decoration: none;\n}\n\n.kedo-loader-wrapper-employment {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.2);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  opacity: 0;\n  visibility: hidden;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-transition: 0.5s;\n  -o-transition: 0.5s;\n  transition: 0.5s;\n}\n.kedo-loader-wrapper-employment_active{\n  opacity: 1;\n  visibility: visible;\n}\n.kedo-loader-img {\n  width: 200px;\n  height: 200px;\n  background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20version%3D%221.1%22%20id%3D%22L9%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%0A%20%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%200%200%22%20xml%3Aspace%3D%22preserve%22%3E%0A%20%20%20%20%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M73%2C50c0-12.7-10.3-23-23-23S27%2C37.3%2C27%2C50%20M30.9%2C50c0-10.5%2C8.5-19.1%2C19.1-19.1S69.1%2C39.5%2C69.1%2C50%22%3E%0A%20%20%20%20%20%20%3CanimateTransform%20%0A%20%20%20%20%20%20%20%20%20attributeName%3D%22transform%22%20%0A%20%20%20%20%20%20%20%20%20attributeType%3D%22XML%22%20%0A%20%20%20%20%20%20%20%20%20type%3D%22rotate%22%0A%20%20%20%20%20%20%20%20%20dur%3D%221s%22%20%0A%20%20%20%20%20%20%20%20%20from%3D%220%2050%2050%22%0A%20%20%20%20%20%20%20%20%20to%3D%22360%2050%2050%22%20%0A%20%20%20%20%20%20%20%20%20repeatCount%3D%22indefinite%22%20%2F%3E%0A%20%20%3C%2Fpath%3E%0A%3C%2Fsvg%3E) no-repeat center / contain;\n}\n\u003c/style\u003e","hideContent":true}},{"id":"f3776976-2256-4b1d-83c3-454533524f48","descriptor":"code","values":{"hideContent":true,"contentPlaceholder":"renderWidget","html":"\u003c% Scripts.renderWidget() %\u003e"}}]}}]}},"fields":[{"code":"all_documents_uploaded","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Все документы загружены","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"iteration_number","type":"FLOAT","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":0,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Номер итерации","data":{"additionalType":"integer","showRowSeparator":true}}},{"code":"chunk_data_array","type":"JSON","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Массив данных чанка","data":{}}},{"code":"error","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Ошибка","data":{"additionalType":"string"}}},{"code":"external_user","type":"SYS_COLLECTION","searchable":false,"indexed":false,"deleted":false,"array":true,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{"code":"_user_profiles","filter":{"value":{"tf":{}},"enabled":false},"bindings":null,"namespace":"_system_catalogs","isDependent":false,"linkedFieldCode":""},"view":{"name":"Внешний пользователь","data":{}}},{"code":"view_message","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"view_message","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"},"input":true,"output":true}}],"fieldVisibilityConditions":{"error":{"enabled":false,"conditions":[]},"view_message":{"enabled":false,"conditions":[]},"external_user":{"enabled":false,"conditions":[]},"chunk_data_array":{"enabled":false,"conditions":[]},"iteration_number":{"enabled":false,"conditions":[]},"user_application":{"enabled":false,"conditions":[]},"custom_application":{"enabled":false,"conditions":[]},"all_documents_uploaded":{"enabled":false,"conditions":[]},"application_kedo_documents":{"enabled":false,"conditions":[]}},"scriptOptions":{},"clientScripts":"/* Client scripts module */\ndeclare const document: any;\ndeclare const console: any;\ndeclare const window: any;\n\nlet chunkDataArray:any[];\nlet allUsers: any[] = []\nlet allTasks: ProcessTaskItem[]\nlet processesError: ProcessInstanceItem[]\nlet externalUsers: ApplicationItem\u003cApplication$_system_catalogs$_user_profiles$Data, any\u003e[] = [];\n\ninterface stringData{\n    staffNameText: string,\n    staffId: string,\n    staffDate: string,\n    lastUpdateDate: TDatetime,\n    statusText: string,\n    statusCode: string,\n    userId: string\n}\n\nlet isScrollListenerAdded = false;\nconst host = window.location.host;\n\nlet itemTemp: any;\nlet itemsWrapper: any;\nlet loader: any;\n\nlet adminUsers: UserItem[] = [];\nlet currentUser: CurrentUserItem;\n\nlet isUserAdmin = false;\n\nasync function getAdminUsers(){\n    const groupsAdmin = await System.userGroups\n        .search()\n        .where((f, g) =\u003e g.or(\n            f.code.eq(\"administrators\"),\n            f.code.eq(\"supervisor\")\n        ))\n        .all();\n\n    if(!groupsAdmin) return;\n\n    for(let i = 0; i \u003c groupsAdmin.length; i++){\n        const users = await groupsAdmin[i].users();\n        adminUsers.push(...users)\n    }\n}\nasync function getCurrentUser(){\n    currentUser = await System.users.getCurrentUser()\n}\n\nasync function getAllUsers(){\n    allUsers = await System.users.search().size(10000).all()\n    externalUsers = await Context.fields.external_user.app.search().where(i =\u003e i.__deletedAt.eq(null)).all();\n}\n\nasync function getProcessInstances(){\n    processesError = await Namespace.app.staff.processes.Employment\n        ._searchInstances()\n        .where((f, g) =\u003e g.or(\n            f.__state.like(ProcessInstanceState.error),\n            f.__state.like(ProcessInstanceState.cancel)\n        ))\n        .size(10000)\n        .all()\n}\n\nasync function getAppsArr(){\n    try{\n        await findUserArrClientScript();\n        // await Server.rpc.findUserArr();\n    }\n    catch(err){\n        throw new Error(`findUserArr error ${err}`);\n    }\n}\n\nasync function renderItems(){ \n    if (chunkDataArray.length === 0) {\n        hideLoader()\n        Context.data.view_message = true;\n        return\n    }\n\n    showLoader();\n\n    // for(let i = 0; i \u003c Context.data.chunk_data_array.length; i++){\n    for(let i = 0; i \u003c chunkDataArray.length; i++){\n        const app : stringData = chunkDataArray[i]\n        // const app : stringData = Context.data.chunk_data_array[i]\n        const itemEl = itemTemp.content.cloneNode(true);\n\n        //continue if the process was dial for 5 or more days\n        const currentDate: TDatetime = new Datetime()\n        // if (app.lastUpdateDate.before(currentDate.addDate(0, 0, -5))) {\n        //     console.log(\"skip\")\n        //     continue;\n        // }\n\n        // staff\n        const userName = itemEl.querySelector('.kedo__employment-table-string-user-name');\n        userName.textContent = !app.staffNameText ? 'Имя не определено' : app.staffNameText;\n        if(app.staffId){\n            userName.href = `https://${host}/kedo/staff(p:item/kedo/staff/${app.staffId})`\n        } else {\n            userName.href = `./`\n        }\n\n        // date\n        const dateEl = itemEl.querySelector('.kedo__employment-table-string-date');\n        if(app.staffDate){\n            const date = new Date(app.staffDate);\n\n            dateEl.textContent = `${date.toLocaleString('ru-RU', { year:'2-digit', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric' })}`;\n        } else {\n            dateEl.textContent = `Дата не определена`;\n        }\n\n        // status\n        const statusText = itemEl.querySelector('.kedo__employment-table-string-status-text');\n        const statusImg = itemEl.querySelector('.kedo__employment-table-string-status-img');\n\n        statusText.textContent = !app.statusText ? 'Статус не определен' : app.statusText;\n\n        if(app.statusText \u0026\u0026 app.statusCode){\n            switch(app.statusCode){\n                case 'invited':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_0-4');\n                    break;\n                case 'filling_pnd':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_0-4');\n                    break;\n\n                case 'input_data':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                    break;\n                case 'editing_pnd':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                    break;                       \n\n                case 'acquaintance_with_the_agreement':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                    break;                        \n                case 'conclude_an_agreement':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                    break;\n                case 'UNEP_release_confirmation':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                    break;                        \n\n                case 'signing_documents':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_3-4');\n                    break;\n                case 'waiting_for_document_editing':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                    break;\n                case 'signed_documents':\n                    statusImg.classList.add('kedo__employment-table-string-status-img_status_4-4');\n                    break;\n            }\n        }\n\n        // process\n        // let user: UserItem|undefined = undefined\n        // if(app.userId \u0026\u0026 allUsers){\n        //     user = allUsers.find(item =\u003e item.id === app.userId)\n        // }\n\n        let process: ProcessInstanceItem|undefined;\n        if(processesError){\n            process = processesError.find(item =\u003e {\n                if(item.data.__item \u0026\u0026 item.data.__item.id === app.staffId){\n                    return true\n                }\n                return false;\n            })\n        }\n\n        if(process){\n            if(isUserAdmin){\n                const taskLink = itemEl.querySelector('.kedo__employment-table-string-task_link');\n                if(process.data.__state === ProcessInstanceState.error){\n                    taskLink.textContent = \"Ошибка в процессе\";\n                } else if (process.data.__state === ProcessInstanceState.cancel){\n                    taskLink.textContent = \"Процесс отменен\";\n                }\n                taskLink.href = `https://${host}/kedo/all_employees(p:history/${process.id})` \n            } else {\n                const taskLink = itemEl.querySelector('.kedo__employment-table-string-task_text');\n                if(process.data.__state === ProcessInstanceState.error){\n                    taskLink.textContent = \"Ошибка в процессе, обратитесь к администратору\";\n                } else if (process.data.__state === ProcessInstanceState.cancel){\n                    taskLink.textContent = \"Процесс отменен, обратитесь к администратору\";\n                }\n            }\n        }\n        \n        itemsWrapper.append(itemEl);\n    }\n\n    hideLoader();\n}\n\nfunction showLoader(){\n    loader.classList.add('kedo-loader-wrapper-employment_active');\n}\nfunction hideLoader(){\n    loader.classList.remove('kedo-loader-wrapper-employment_active');\n}\n\nasync function getChunkData(){\n    try{\n        await getAppsArr();\n    }\n    catch(err){\n        throw new Error(`getAppsArr error ${err}`);\n    }\n}\n\nasync function renderWidget(){\n    itemTemp = document.querySelector('.kedo__employment-table-section-list-item-template');\n    itemsWrapper = document.querySelector('.kedo__employment-table-section-list');\n    loader = document.querySelector('.kedo-loader-wrapper-employment');\n\n    showLoader();\n    \n    await Promise.all([await getAllUsers(), await getProcessInstances(), await getAdminUsers(), await getCurrentUser()]);\n\n    if(adminUsers.find(item =\u003e item.id === currentUser.id)){\n        isUserAdmin = true;\n    }\n\n    await getChunkData();\n\n    await renderItems();\n        \n    // lazy loading\n    let contentBody = document.querySelector('.content-body');\n    let kedoUsersContainer = document.querySelector('.kedo__employment');\n    let documentsBottomPoint: number = 0;\n    let timeOut: any;\n\n    async function handleWindowScroll(){\n        window.clearTimeout(timeOut);\n\n        timeOut = window.setTimeout(async() =\u003e {\n            documentsBottomPoint = kedoUsersContainer.offsetTop + kedoUsersContainer.offsetHeight;\n            \n            if(documentsBottomPoint - contentBody.scrollTop - window.innerHeight \u003c 0){\n                await renderItems();\n                if(!Context.data.all_documents_uploaded){\n                    await getAppsArr();\n                }\n                if(Context.data.all_documents_uploaded){\n                    Context.data.custom_application = [];\n                }\n                \n                documentsBottomPoint = kedoUsersContainer.offsetTop + kedoUsersContainer.offsetHeight\n            }\n        }, 300)\n    }\n\n    if(!isScrollListenerAdded){\n        contentBody.addEventListener('scroll', handleWindowScroll);\n        isScrollListenerAdded = true;\n    }\n\n    await getChunkData();\n}\n\n// ================================================================================================\n\nconst numberOfUnloadedElements: number = 20;\nlet countOfIterations: number;\nlet firstElementNumber: number;\nlet numberOfAllElements: number = 0;\n\nasync function findUserArrClientScript(): Promise\u003cvoid\u003e {\n    try{\n        // Context.data.chunk_data_array = []\n        chunkDataArray = []\n        \n        let userSearch = Namespace.app.staff.search()\n\n        if(!numberOfAllElements){\n            numberOfAllElements = await userSearch.count();\n        }\n        \n        if(!countOfIterations){\n            countOfIterations = Math.ceil(numberOfAllElements / numberOfUnloadedElements);\n        }\n\n        firstElementNumber = Context.data.iteration_number! * numberOfUnloadedElements;\n        const amountOfElements = (Context.data.iteration_number != countOfIterations - 1) ? numberOfUnloadedElements : (numberOfAllElements - firstElementNumber);\n\n        if(Context.data.iteration_number === countOfIterations){\n            Context.data.all_documents_uploaded = true\n        }\n        \n        try {\n            let result: ApplicationItem\u003cApplication$kedo$staff$Data, Application$kedo$staff$Params\u003e[];\n            result = await userSearch\n                .where(f =\u003e f.__deletedAt.eq(null))\n                .size(amountOfElements)\n\n                .from(firstElementNumber)\n                .all()\n            \n            if(result){\n                for (let i = 0; i \u003c result.length; i++){\n                    await addElementToGeneralArray(result[i]);\n                }\n\n                Context.data.iteration_number! += 1;\n            }\n        } catch (err) {\n            throw new Error(`userSearch error ${err}`);\n        };\n    }\n    catch(err){\n        throw new Error(`userSearch error ${err}`);\n    }\n}\n\nasync function addElementToGeneralArray(element: ApplicationItem\u003cApplication$kedo$staff$Data,any\u003e){\n    if(element){\n        // user\n        let staffNameText: string;\n        let staffId: string;\n        let userId: string;\n\n        staffNameText = !element.data.__name ? '' : element.data.__name;\n        staffId = !element.data.__id ? '' : element.data.__id;\n        userId = !element.data.ext_user ? '' : element.data.ext_user.id;\n        \n        //task\n        if (!!element.data.ext_user) {\n            let externalUser = allUsers.find(u =\u003e u.data.__id == element.data.ext_user?.id)\n            let tasks = await System.processes._searchTasks().where(i =\u003e i.performers.has(externalUser)).all();\n        }\n\n        // date\n        let staffDate: string;\n        staffDate = !element.data.__createdAt ? '' : element.data.__createdAt.format();\n\n        //last update date\n        let lastUpdateDate: TDatetime;\n        lastUpdateDate = element.data.__updatedAt ?? null \n        \n        // status\n        let statusText: string = '';\n        let statusCode: string = '';\n\n        if(element.data.__status){\n            statusText = !element.data.__status.name ? '' : element.data.__status.name;\n            statusCode = !element.data.__status.code ? '' : element.data.__status.code;\n        }\n\n        if(statusCode === element.fields.__status.variants.signed_documents.code){\n            return;\n        }\n\n        let elementData: stringData = {\n            staffNameText,\n            staffId,\n            staffDate,\n            lastUpdateDate,\n            statusText,\n            statusCode,\n            userId\n        }\n\n        chunkDataArray.push(elementData);\n        // Context.data.chunk_data_array.push(elementData);\n    }\n}\n","clientScriptOptions":{"allowServer":true},"serverScripts":"\n\n// const numberOfUnloadedElements: number = 20;\n// let countOfIterations: number;\n// let firstElementNumber: number;\n// let numberOfAllElements: number = 0;\n\n// interface stringData{\n//     userNameText: string,\n//     userId: string,\n//     userDate: string,\n//     statusText: string,\n//     statusCode: string\n// }\n\n// async function findUserArr(): Promise\u003cvoid\u003e {\n    \n//     try{\n//         Context.data.chunk_data_array = []\n        \n//         let userSearch = Namespace.app.staff.search()\n\n//         if(!numberOfAllElements){\n//             numberOfAllElements = await userSearch.count();\n//         }\n        \n//         if(!countOfIterations){\n//             countOfIterations = Math.ceil(numberOfAllElements / numberOfUnloadedElements);\n//         }\n\n//         firstElementNumber = Context.data.iteration_number! * numberOfUnloadedElements;\n//         const amountOfElements = (Context.data.iteration_number != countOfIterations - 1) ? numberOfUnloadedElements : (numberOfAllElements - firstElementNumber);\n\n//         if(Context.data.iteration_number === countOfIterations){\n//             Context.data.all_documents_uploaded = true\n//         }\n        \n//         try {\n//             let result: ApplicationItem\u003cApplication$kedo$staff$Data, Application$kedo$staff$Params\u003e[];\n//             result = await userSearch\n//                 .size(amountOfElements)\n//                 .from(firstElementNumber)\n//                 .all()\n            \n//             if(result){\n//                 for (let i = 0; i \u003c result.length; i++){\n//                     await addElementToGeneralArray(result[i]);\n//                 }\n\n//                 Context.data.iteration_number! += 1;\n//             }\n//         } catch (err) {\n//             throw new Error(`userSearch error ${err}`);\n//         };\n//     }\n//     catch(err){\n//         throw new Error(`userSearch error ${err}`);\n//     }\n// }\n\n// async function addElementToGeneralArray(element: ApplicationItem\u003cApplication$kedo$staff$Data,any\u003e){\n//     if(element){\n//         // user\n//         let userNameText: string;\n//         let userId: string;\n\n//         userNameText = !element.data.__name ? '' : element.data.__name;\n//         userId = !element.data.__id ? '' : element.data.__id;\n        \n//         // date\n//         let userDate: string;\n//         userDate = !element.data.__createdAt ? '' : element.data.__createdAt.format();\n        \n//         // status\n//         let statusText: string = '';\n//         let statusCode: string = '';\n\n//         if(element.data.__status){\n//             statusText = !element.data.__status.name ? '' : element.data.__status.name;\n//             statusCode = !element.data.__status.code ? '' : element.data.__status.code;\n//         }\n\n//         let elementData: stringData = {\n//             userNameText,\n//             userId,\n//             userDate,\n//             statusText,\n//             statusCode\n//         }\n\n//         Context.data.chunk_data_array.push(elementData);\n//     }\n// }","serverScriptOptions":{}},"dataNamespace":"","dataCode":"","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server, System) {\n        let chunkDataArray;\n        let allUsers = [];\n        let allTasks;\n        let processesError;\n        let externalUsers = [];\n        let isScrollListenerAdded = false;\n        const host = window.location.host;\n        let itemTemp;\n        let itemsWrapper;\n        let loader;\n        let adminUsers = [];\n        let currentUser;\n        let isUserAdmin = false;\n        async function getAdminUsers() {\n            const groupsAdmin = await System.userGroups\n                .search()\n                .where((f, g) =\u003e g.or(f.code.eq(\"administrators\"), f.code.eq(\"supervisor\")))\n                .all();\n            if (!groupsAdmin)\n                return;\n            for (let i = 0; i \u003c groupsAdmin.length; i++) {\n                const users = await groupsAdmin[i].users();\n                adminUsers.push(...users);\n            }\n        }\n        async function getCurrentUser() {\n            currentUser = await System.users.getCurrentUser();\n        }\n        async function getAllUsers() {\n            allUsers = await System.users.search().size(10000).all();\n            externalUsers = await Context.fields.external_user.app.search().where(i =\u003e i.__deletedAt.eq(null)).all();\n        }\n        async function getProcessInstances() {\n            processesError = await Namespace.app.staff.processes.Employment\n                ._searchInstances()\n                .where((f, g) =\u003e g.or(f.__state.like(ProcessInstanceState.error), f.__state.like(ProcessInstanceState.cancel)))\n                .size(10000)\n                .all();\n        }\n        async function getAppsArr() {\n            try {\n                await findUserArrClientScript();\n            }\n            catch (err) {\n                throw new Error(`findUserArr error ${err}`);\n            }\n        }\n        async function renderItems() {\n            if (chunkDataArray.length === 0) {\n                hideLoader();\n                Context.data.view_message = true;\n                return;\n            }\n            showLoader();\n            for (let i = 0; i \u003c chunkDataArray.length; i++) {\n                const app = chunkDataArray[i];\n                const itemEl = itemTemp.content.cloneNode(true);\n                const currentDate = new Datetime();\n                const userName = itemEl.querySelector('.kedo__employment-table-string-user-name');\n                userName.textContent = !app.staffNameText ? 'Имя не определено' : app.staffNameText;\n                if (app.staffId) {\n                    userName.href = `https://${host}/kedo/staff(p:item/kedo/staff/${app.staffId})`;\n                }\n                else {\n                    userName.href = `./`;\n                }\n                const dateEl = itemEl.querySelector('.kedo__employment-table-string-date');\n                if (app.staffDate) {\n                    const date = new Date(app.staffDate);\n                    dateEl.textContent = `${date.toLocaleString('ru-RU', { year: '2-digit', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric' })}`;\n                }\n                else {\n                    dateEl.textContent = `Дата не определена`;\n                }\n                const statusText = itemEl.querySelector('.kedo__employment-table-string-status-text');\n                const statusImg = itemEl.querySelector('.kedo__employment-table-string-status-img');\n                statusText.textContent = !app.statusText ? 'Статус не определен' : app.statusText;\n                if (app.statusText \u0026\u0026 app.statusCode) {\n                    switch (app.statusCode) {\n                        case 'invited':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_0-4');\n                            break;\n                        case 'filling_pnd':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_0-4');\n                            break;\n                        case 'input_data':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                            break;\n                        case 'editing_pnd':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                            break;\n                        case 'acquaintance_with_the_agreement':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                            break;\n                        case 'conclude_an_agreement':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                            break;\n                        case 'UNEP_release_confirmation':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_2-4');\n                            break;\n                        case 'signing_documents':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_3-4');\n                            break;\n                        case 'waiting_for_document_editing':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_1-4');\n                            break;\n                        case 'signed_documents':\n                            statusImg.classList.add('kedo__employment-table-string-status-img_status_4-4');\n                            break;\n                    }\n                }\n                let process;\n                if (processesError) {\n                    process = processesError.find(item =\u003e {\n                        if (item.data.__item \u0026\u0026 item.data.__item.id === app.staffId) {\n                            return true;\n                        }\n                        return false;\n                    });\n                }\n                if (process) {\n                    if (isUserAdmin) {\n                        const taskLink = itemEl.querySelector('.kedo__employment-table-string-task_link');\n                        if (process.data.__state === ProcessInstanceState.error) {\n                            taskLink.textContent = \"Ошибка в процессе\";\n                        }\n                        else if (process.data.__state === ProcessInstanceState.cancel) {\n                            taskLink.textContent = \"Процесс отменен\";\n                        }\n                        taskLink.href = `https://${host}/kedo/all_employees(p:history/${process.id})`;\n                    }\n                    else {\n                        const taskLink = itemEl.querySelector('.kedo__employment-table-string-task_text');\n                        if (process.data.__state === ProcessInstanceState.error) {\n                            taskLink.textContent = \"Ошибка в процессе, обратитесь к администратору\";\n                        }\n                        else if (process.data.__state === ProcessInstanceState.cancel) {\n                            taskLink.textContent = \"Процесс отменен, обратитесь к администратору\";\n                        }\n                    }\n                }\n                itemsWrapper.append(itemEl);\n            }\n            hideLoader();\n        }\n        function showLoader() {\n            loader.classList.add('kedo-loader-wrapper-employment_active');\n        }\n        function hideLoader() {\n            loader.classList.remove('kedo-loader-wrapper-employment_active');\n        }\n        async function getChunkData() {\n            try {\n                await getAppsArr();\n            }\n            catch (err) {\n                throw new Error(`getAppsArr error ${err}`);\n            }\n        }\n        async function renderWidget() {\n            itemTemp = document.querySelector('.kedo__employment-table-section-list-item-template');\n            itemsWrapper = document.querySelector('.kedo__employment-table-section-list');\n            loader = document.querySelector('.kedo-loader-wrapper-employment');\n            showLoader();\n            await Promise.all([await getAllUsers(), await getProcessInstances(), await getAdminUsers(), await getCurrentUser()]);\n            if (adminUsers.find(item =\u003e item.id === currentUser.id)) {\n                isUserAdmin = true;\n            }\n            await getChunkData();\n            await renderItems();\n            let contentBody = document.querySelector('.content-body');\n            let kedoUsersContainer = document.querySelector('.kedo__employment');\n            let documentsBottomPoint = 0;\n            let timeOut;\n            async function handleWindowScroll() {\n                window.clearTimeout(timeOut);\n                timeOut = window.setTimeout(async () =\u003e {\n                    documentsBottomPoint = kedoUsersContainer.offsetTop + kedoUsersContainer.offsetHeight;\n                    if (documentsBottomPoint - contentBody.scrollTop - window.innerHeight \u003c 0) {\n                        await renderItems();\n                        if (!Context.data.all_documents_uploaded) {\n                            await getAppsArr();\n                        }\n                        if (Context.data.all_documents_uploaded) {\n                            Context.data.custom_application = [];\n                        }\n                        documentsBottomPoint = kedoUsersContainer.offsetTop + kedoUsersContainer.offsetHeight;\n                    }\n                }, 300);\n            }\n            if (!isScrollListenerAdded) {\n                contentBody.addEventListener('scroll', handleWindowScroll);\n                isScrollListenerAdded = true;\n            }\n            await getChunkData();\n        }\n        const numberOfUnloadedElements = 20;\n        let countOfIterations;\n        let firstElementNumber;\n        let numberOfAllElements = 0;\n        async function findUserArrClientScript() {\n            try {\n                chunkDataArray = [];\n                let userSearch = Namespace.app.staff.search();\n                if (!numberOfAllElements) {\n                    numberOfAllElements = await userSearch.count();\n                }\n                if (!countOfIterations) {\n                    countOfIterations = Math.ceil(numberOfAllElements / numberOfUnloadedElements);\n                }\n                firstElementNumber = Context.data.iteration_number * numberOfUnloadedElements;\n                const amountOfElements = (Context.data.iteration_number != countOfIterations - 1) ? numberOfUnloadedElements : (numberOfAllElements - firstElementNumber);\n                if (Context.data.iteration_number === countOfIterations) {\n                    Context.data.all_documents_uploaded = true;\n                }\n                try {\n                    let result;\n                    result = await userSearch\n                        .where(f =\u003e f.__deletedAt.eq(null))\n                        .size(amountOfElements)\n                        .from(firstElementNumber)\n                        .all();\n                    if (result) {\n                        for (let i = 0; i \u003c result.length; i++) {\n                            await addElementToGeneralArray(result[i]);\n                        }\n                        Context.data.iteration_number += 1;\n                    }\n                }\n                catch (err) {\n                    throw new Error(`userSearch error ${err}`);\n                }\n                ;\n            }\n            catch (err) {\n                throw new Error(`userSearch error ${err}`);\n            }\n        }\n        async function addElementToGeneralArray(element) {\n            var _a;\n            if (element) {\n                let staffNameText;\n                let staffId;\n                let userId;\n                staffNameText = !element.data.__name ? '' : element.data.__name;\n                staffId = !element.data.__id ? '' : element.data.__id;\n                userId = !element.data.ext_user ? '' : element.data.ext_user.id;\n                if (!!element.data.ext_user) {\n                    let externalUser = allUsers.find(u =\u003e { var _a; return u.data.__id == ((_a = element.data.ext_user) === null || _a === void 0 ? void 0 : _a.id); });\n                    let tasks = await System.processes._searchTasks().where(i =\u003e i.performers.has(externalUser)).all();\n                }\n                let staffDate;\n                staffDate = !element.data.__createdAt ? '' : element.data.__createdAt.format();\n                let lastUpdateDate;\n                lastUpdateDate = (_a = element.data.__updatedAt) !== null \u0026\u0026 _a !== void 0 ? _a : null;\n                let statusText = '';\n                let statusCode = '';\n                if (element.data.__status) {\n                    statusText = !element.data.__status.name ? '' : element.data.__status.name;\n                    statusCode = !element.data.__status.code ? '' : element.data.__status.code;\n                }\n                if (statusCode === element.fields.__status.variants.signed_documents.code) {\n                    return;\n                }\n                let elementData = {\n                    staffNameText,\n                    staffId,\n                    staffDate,\n                    lastUpdateDate,\n                    statusText,\n                    statusCode,\n                    userId\n                };\n                chunkDataArray.push(elementData);\n            }\n        }\n        return {\n            getAdminUsers,\n            getCurrentUser,\n            getAllUsers,\n            getProcessInstances,\n            getAppsArr,\n            renderItems,\n            showLoader,\n            hideLoader,\n            getChunkData,\n            renderWidget,\n            findUserArrClientScript,\n            addElementToGeneralArray\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"getAdminUsers","parameters":[],"type":""},{"name":"getCurrentUser","parameters":[],"type":""},{"name":"getAllUsers","parameters":[],"type":""},{"name":"getProcessInstances","parameters":[],"type":""},{"name":"getAppsArr","parameters":[],"type":""},{"name":"renderItems","parameters":[],"type":""},{"name":"showLoader","parameters":[],"type":""},{"name":"hideLoader","parameters":[],"type":""},{"name":"getChunkData","parameters":[],"type":""},{"name":"renderWidget","parameters":[],"type":""},{"name":"findUserArrClientScript","parameters":[],"type":"[object Object]"},{"name":"addElementToGeneralArray","parameters":[{"name":"[object Object]","type":"[object Object]"}],"type":""}],"clientDependencies":{"applications":[],"collections":[{"namespace":"system","code":"groups"},{"namespace":"system","code":"users"},{"namespace":"_system_catalogs","code":"_user_profiles"},{"namespace":"kedo","code":"staff"}],"pages":[{"namespace":"global","code":"kedo"}]}},"__createdAt":"2024-05-27T06:35:49.625412274Z","__createdBy":"59e0911f-230a-4b6d-becf-6b302a91977a","__updatedAt":"2024-05-29T14:05:22.809335542Z","__updatedBy":"59e0911f-230a-4b6d-becf-6b302a91977a","__deletedAt":null}
