{"__id":"018c8758-1446-7aff-9909-abbace264c43","namespace":"kedo.work_schedules","code":"view","__name":"Форма просмотра","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":3,"hidden":false,"draft":false,"readonly":false,"descriptor":{"types":["form"],"template":{"id":"ad2a2b72-dcc9-4650-a082-b84d702b645a","descriptor":"item-form-complex-popup","descriptorVersion":2,"values":{"formGroup":{"path":["item"]}},"content":{"[footer]":[{"id":"59529a5d-df43-4113-bc20-f919cd6f999d","descriptor":"zone-content","values":{"zoneCode":"[footer]"}}],"[content]":[{"id":"c18e9118-cda2-49f4-ae50-5414c9b970b2","descriptor":"modal-body","values":{"shadow":true},"content":{"":[{"id":"1e7a4fac-297b-4b67-bc27-cffbb3dd2262","descriptor":"dynamic-form-row","values":{"__outlet":"","__baseURL":"","bindingMode":false,"__relativeURL":"","__isConstValues":[],"showDisplayName":true,"control":{"path":["item","year"]},"tooltip":null,"required":false,"hideEmpty":false,"__readOnly":true}},{"id":"23aa0ada-e53d-4331-852e-106ff669ca45","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["item","utc"]},"tooltip":null,"__outlet":"","hideEmpty":false,"bindingMode":false,"__isConstValues":[],"required":false,"__baseURL":"","__readOnly":true,"__relativeURL":""}},{"id":"217bcabc-e517-4bf4-9f84-15db50314e8d","descriptor":"dynamic-form-row","values":{"control":{"path":["item","start_date"]},"__outlet":"","required":false,"hideEmpty":false,"__isConstValues":[],"tooltip":null,"__baseURL":"","__readOnly":true,"bindingMode":false,"__relativeURL":"","showDisplayName":true}},{"id":"913d7478-3398-4b0e-927e-1061855d7476","descriptor":"dynamic-form-row","values":{"required":false,"hideEmpty":false,"__readOnly":true,"bindingMode":false,"__relativeURL":"","showDisplayName":true,"control":{"path":["item","work_days"]},"tooltip":null,"__outlet":"","__baseURL":"","__isConstValues":[]}},{"id":"ed81c75d-c970-4433-b8f3-8efa1fcc9a70","descriptor":"dynamic-form-row","values":{"__readOnly":true,"bindingMode":false,"__relativeURL":"","__isConstValues":[],"control":{"path":["item","day_offs"]},"tooltip":null,"__outlet":"","showDisplayName":true,"required":false,"__baseURL":"","hideEmpty":false}},{"id":"7dd0907b-7770-46cd-9470-3754d4266fec","descriptor":"code","values":{"html":"\u003clink rel=\"stylesheet\" src=\"\u003c%= UI.widget.filePath %\u003e/vanilla-calendar.min.css\"\u003e\n\u003clink rel=\"stylesheet\" src=\"\u003c%= UI.widget.filePath %\u003e/light.min.css\"\u003e\n\u003clink rel=\"stylesheet\" src=\"\u003c%= UI.widget.filePath %\u003e/dark.min.css\"\u003e\n\n\u003cdiv class=\"custom-calendar\"\u003e\u003c/div\u003e\n\n\u003cstyle\u003e\n    @import url(\"\u003c%= UI.widget.filePath %\u003e/vanilla-calendar.min.css\");\n    @import url(\"\u003c%= UI.widget.filePath %\u003e/light.min.css\");\n    @import url(\"\u003c%= UI.widget.filePath %\u003e/dark.min.css\");\n\n    .custom-calendar {\n        width: 100%;\n        height: 60rem;\n    }\n\n    .vanilla-calendar-day__btn {\n        font-size: 1rem;\n        pointer-events: none;\n    }\n\n    .vanilla-calendar-month,\n    .vanilla-calendar-year {\n        font-size: 2rem;\n    }\n\n    .vanilla-calendar-week__day {\n        font-size: 1rem;\n    }\n\n    .vanilla-calendar-day {\n        width: 80%;\n    }\n\n    .vanilla-calendar-day__popup {\n        padding: 1.5rem 1rem 0.5rem;\n        width: 20rem;\n        font-size: 1.5rem;\n    }\n\u003c/style\u003e","hideContent":true,"contentPlaceholder":"calendar"}},{"id":"222e8145-cdc4-448e-8c45-b330b4782430","descriptor":"dynamic-form-row","values":{"__outlet":"","required":false,"__readOnly":true,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["item","id_1c"]},"__baseURL":"","hideEmpty":false,"__relativeURL":"","tooltip":null}}]}}],"[sidebar]":[{"id":"32a2c1e4-d376-4aea-8808-09ff7d74034b","descriptor":"sidebar-widget","content":{"":[{"id":"484d74f7-e2f0-413b-83fd-42416ffc4c9f","descriptor":"portal-user-profile-status","values":{"formGroup":{"path":["item"]}}}]}},{"id":"2f4caa85-bf2f-4379-b888-119b342093c8","descriptor":"sidebar-widget","values":{"title":"Статус в Диадок"},"content":{"":[{"id":"6dbf42cc-a55b-4720-827a-93d271b847b0","descriptor":"diadoc-status","values":{"tooltip":"app-integration@diadoc-status","itemModel":{"path":["itemModel"]},"applicationItem":{"path":["item"]}}}]}},{"id":"cbd8cadb-d5e7-4b19-91da-5881637efc78","descriptor":"sidebar-widget","values":{"title":"Статус подписи"},"content":{"":[{"id":"5476c0e0-829c-4d53-b03b-88b0d6534fb0","descriptor":"app-sign-status","values":{"itemModel":{"path":["itemModel"]}}}]}},{"id":"1c6ef61f-6d0e-41d1-8a1f-211bc70f3d92","descriptor":"sidebar-widget","content":{"":[{"id":"3a3d29c6-7fca-42eb-95f8-74789b8b7f22","descriptor":"docflow-approval-lists","values":{"item":{"path":["itemModel"]}}}]}},{"id":"8326be58-15ff-4903-8ab0-e20b08b8306b","descriptor":"sidebar-widget","content":{"":[{"id":"3a3d29c6-7fca-42eb-95f8-74789b8b7f22","descriptor":"docflow-inform-lists","values":{"item":{"path":["itemModel"]}}}]}},{"id":"a3c6e12f-c346-4519-932b-7ab965384039","descriptor":"sidebar-widget","content":{"":[{"id":"4cc755bb-f919-4ff7-8e47-5c59047dad62","descriptor":"item-status","values":{"item":{"path":["itemModel"]},"application":{"path":["application"]}}}]}},{"id":"ff81ce95-4e79-44b7-9084-d7b0e0f764c3","descriptor":"sidebar-widget","content":{"":[{"id":"d23366cd-07b0-4ae4-bb2c-73a203ec7786","descriptor":"item-tasks","descriptorVersion":4,"values":{"itemModel":{"path":["itemModel"]},"formGroup":{"path":["item"]}}}]}},{"id":"3ab3e301-da8a-4030-ba48-4e02c136b812","descriptor":"sidebar-widget","content":{"":[{"id":"5c77c4f0-b9f3-4d77-ac9c-5aaadde543dd","descriptor":"messages-target","values":{"target":{"path":["target"]}}}]}}],"[headerControls]":[{"id":"d8e970da-6c0b-49fb-963c-d2515788b7b1","descriptor":"item-subscribe","values":{"application":{"path":["application"]},"item":{"path":["itemModel"]}}},{"id":"5a72dd17-31f2-4412-a056-a474e01ac17c","descriptor":"button","values":{"icon":"send_approve","view":"icon","action":{"path":["docflowSendAction"]},"tooltip":"Отправить","runProcessSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"createAppItemSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}}}},{"id":"b0237e26-4b99-4ce8-9d6f-a78b44c9263b","descriptor":"button","values":{"icon":"lock","view":"icon","label":"Права доступа","action":{"path":["accessSettings"]},"runProcessSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"createAppItemSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}}}},{"id":"17a52e8f-7486-4031-bd01-5838fcfc8f70","descriptor":"extension-zone-toolbar-widget","values":{"item":{"path":["__itemRef"]}}},{"id":"13599e1c-12ed-11eb-adc1-0242ac120002","descriptor":"edo-diadoc-full-widget","values":{"icon":"lock","item":{"path":["item"]},"view":"icon","label":"Права доступа","itemModel":{"path":["itemModel"]}}},{"id":"1d3e0cf2-9996-43a6-945d-4b949ff7939e","descriptor":"app-signing","descriptorVersion":3,"values":{"label":"Права доступа","itemModel":{"path":["itemModel"]}}}],"[headerUpperTitle]":[{"id":"7fe87b6f-803f-40af-ae04-2c46f1919291","descriptor":"app-navigation-crumbs-tree-widget","values":{"item":{"path":["itemModel"]},"application":{"path":["application"]}}}],"[headerCustomization]":[]}},"fieldVisibilityConditions":{},"scriptOptions":{},"clientScripts":"declare const console: any;\ndeclare const document: any;\ndeclare const window: any;\n\nimport VanillaCalendar from \"vanilla-calendar.min.js\";\n\ntype dateInfo = {\n    isHoliday?: boolean,\n    isDayOff?: boolean,\n    date: string,\n    dateForCalendar: string,\n    isPreDayOff?: boolean,\n    description?: string\n};\n\nasync function onInit(): Promise\u003cvoid\u003e {\n    const waitForCalendar = window.setInterval(() =\u003e {\n        const customCalendar = document.querySelector(\".custom-calendar\");\n        if (!customCalendar) {\n            return;\n        };\n        window.clearInterval(waitForCalendar);\n        const jsonData = \u003cdateInfo[]\u003eJSON.parse(Context.data.json_data!);\n        console.log(jsonData)\n        console.log(Context.data.dates_table)\n        const mappedDescriptions: {[key: string]: {modifier: string, html: string}} = {};\n        const holidays = jsonData.filter(day =\u003e day.isHoliday);\n        holidays.forEach(day =\u003e {\n            mappedDescriptions[day.dateForCalendar] = {\n                modifier: \"bg-red\",\n                html: day.description || \"\"\n            };\n        });\n        const calendar = new VanillaCalendar(\".custom-calendar\", {\n            settings: {\n                selected: {\n                    holidays: jsonData.filter(day =\u003e day.isDayOff).map(day =\u003e day.dateForCalendar),\n                    dates: Object.keys(mappedDescriptions)\n                },\n                visibility: {\n                    weekend: false\n                },\n                lang: 'ru',\n            },\n            date: {\n                min: Context.data.start_date!.format(\"YYYY-MM-DD\"),\n                max: new TDate(Context.data.year!, 12, 31).format(\"YYYY-MM-DD\")\n            },\n            popups: mappedDescriptions\n        });\n        calendar.init()\n    }, 200)\n}","clientScriptOptions":{"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{},"widgetZones":[{"code":"[footer]"}],"dataFieldCode":"item"},"dataNamespace":"kedo","dataCode":"work_schedules","runtime":{"version":1,"clientScripts":"System.register([\"vanilla-calendar.min.js\"], function (exports_1, context_1) {\n    \"use strict\";\n    var vanilla_calendar_min_js_1;\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        async function onInit() {\n            const waitForCalendar = window.setInterval(() =\u003e {\n                const customCalendar = document.querySelector(\".custom-calendar\");\n                if (!customCalendar) {\n                    return;\n                }\n                ;\n                window.clearInterval(waitForCalendar);\n                const jsonData = JSON.parse(Context.data.json_data);\n                console.log(jsonData);\n                console.log(Context.data.dates_table);\n                const mappedDescriptions = {};\n                const holidays = jsonData.filter(day =\u003e day.isHoliday);\n                holidays.forEach(day =\u003e {\n                    mappedDescriptions[day.dateForCalendar] = {\n                        modifier: \"bg-red\",\n                        html: day.description || \"\"\n                    };\n                });\n                const calendar = new vanilla_calendar_min_js_1.default(\".custom-calendar\", {\n                    settings: {\n                        selected: {\n                            holidays: jsonData.filter(day =\u003e day.isDayOff).map(day =\u003e day.dateForCalendar),\n                            dates: Object.keys(mappedDescriptions)\n                        },\n                        visibility: {\n                            weekend: false\n                        },\n                        lang: 'ru',\n                    },\n                    date: {\n                        min: Context.data.start_date.format(\"YYYY-MM-DD\"),\n                        max: new TDate(Context.data.year, 12, 31).format(\"YYYY-MM-DD\")\n                    },\n                    popups: mappedDescriptions\n                });\n                calendar.init();\n            }, 200);\n        }\n        return {\n            onInit\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [\n            function (vanilla_calendar_min_js_1_1) {\n                vanilla_calendar_min_js_1 = vanilla_calendar_min_js_1_1;\n            }\n        ],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"onInit","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-12-20T13:09:05.731963822Z","__createdBy":"7303b866-4220-4086-a09e-348a76b12c73","__updatedAt":"2024-02-14T11:07:46.365011366Z","__updatedBy":"7303b866-4220-4086-a09e-348a76b12c73","__deletedAt":null}
