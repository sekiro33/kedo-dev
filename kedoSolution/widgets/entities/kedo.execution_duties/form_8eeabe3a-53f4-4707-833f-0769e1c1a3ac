{"__id":"018c8758-16cb-7b0f-a587-8c651fbe3157","namespace":"kedo.execution_duties","code":"form_8eeabe3a-53f4-4707-833f-0769e1c1a3ac","__name":"Редактирование заявки ИО","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":3,"hidden":true,"draft":false,"readonly":false,"descriptor":{"types":["form"],"template":{"id":"3eff0fc8-f4cb-46aa-856c-ba8f2417d45f","descriptor":"item-form-complex-popup","descriptorVersion":2,"values":{"formGroup":{"path":["context"]},"formType":"task-form"},"content":{"[footer]":[{"id":"31979bac-00bd-4123-a901-9d14190c8dde","descriptor":"buttons-panel","values":{"buttons":{"path":["actionButtons"]}}}],"[content]":[{"id":"c18e9118-cda2-49f4-ae50-5414c9b970b2","descriptor":"modal-body","values":{"shadow":true},"content":{"":[{"id":"4dc20d06-ff2b-4d8a-90e7-dbec76c2a81d","descriptor":"dynamic-form-row","values":{"hideEmpty":true,"__readOnly":true,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","reject_comment"]},"tooltip":null,"required":false}},{"id":"bd655d9e-cd2b-4dbe-9c60-b79efa19bf86","descriptor":"dynamic-form-row","values":{"tooltip":null,"required":false,"hideEmpty":false,"onChangeValue":{"kind":"Function","name":"date_correct","type":"client"},"showDisplayName":true,"control":{"path":["context","start_date"]},"__readOnly":null,"bindingMode":false,"__isConstValues":[]}},{"id":"1be84ff0-20b9-4512-abe8-2ccc8f9e9611","descriptor":"dynamic-form-row","values":{"onChangeValue":{"kind":"Function","name":"date_correct","type":"client"},"control":{"path":["context","end_date"]},"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"tooltip":null,"required":false,"hideEmpty":false}},{"id":"3f230064-46cc-4694-b4c3-07187702b67c","descriptor":"dynamic-form-row","values":{"control":{"path":["context","substitution_type"]},"hideEmpty":false,"bindingMode":false,"__isConstValues":[],"tooltip":null,"required":false,"__readOnly":null,"onChangeValue":{"kind":"Function","name":"subtitusuion_set","type":"client"},"showDisplayName":true}},{"id":"d643f130-e333-41ea-9ad0-4eab642fe6b6","descriptor":"dynamic-form-row","values":{"hideEmpty":false,"displayName":"Замещающий","__isConstValues":[],"showDisplayName":true,"required":false,"tooltip":null,"__hidden":{"path":["substitute_show"],"modifier":"not"},"__readOnly":null,"bindingMode":false,"showCreateItem":false,"control":{"path":["context","system_substitute_staff"]}}},{"id":"ecc9b66a-e7a4-4ab3-a581-47e7fb700997","descriptor":"dynamic-form-row","values":{"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","inf_about_acting"]},"hideEmpty":false,"__readOnly":null,"bindingMode":false,"tooltip":null,"__hidden":{"path":["inf_about_acting_show"],"modifier":"not"},"required":false}}]}}],"[sidebar]":[{"id":"39d7757a-529f-4526-98f3-fddc66becf85","descriptor":"sidebar-widget","content":{"":[{"id":"abe4b782-6e2d-49cc-a57e-81b636422ee5","descriptor":"target-widget","values":{"context":{"path":["context"]}}}]}},{"id":"231b371a-64ae-4b61-8014-cba6da318ac9","descriptor":"sidebar-widget","content":{"":[{"id":"5e39b91d-aea4-467e-862f-0f8766eb44df","descriptor":"linked-item","values":{"context":{"path":["context"]}}}]}},{"id":"a4469de0-d7f3-11ec-9d64-0242ac120002","descriptor":"sidebar-widget","content":{"":[{"id":"3ead7c41-6dfa-4144-80da-2bfb5f0ccf59","descriptor":"item-reminder","values":{"formGroup":{"path":["context"]}}}]}},{"id":"56d1d0e8-aa83-4cdd-ae43-294b26ad4d04","descriptor":"sidebar-widget","content":{"":[{"id":"e1525e34-14ba-456b-b703-f407945c01e0","descriptor":"item-tasks","descriptorVersion":4,"values":{"itemModel":{"path":["itemModel"]},"formGroup":{"path":["context"]}}}]}},{"id":"eef018f2-1d3a-4600-a19d-791733b28b5e","descriptor":"sidebar-widget","content":{"":[{"id":"e0a17dec-603a-461a-becf-861637630584","descriptor":"messages-target","values":{"target":{"path":["target"]}}}]}}],"[formInfoPanel]":[{"id":"1bc6bb93-fff1-46b9-a9e0-4458b76782a3","descriptor":"validation-info-block","values":{"__validateResult":{"path":["context","__validateResult"]}}}],"[headerControls]":[{"id":"475aa008-aaff-402f-8de2-408bae1f1928","descriptor":"task-percent-widget","values":{"task":{"path":["task"]}}},{"id":"702d9c59-77ae-4dd5-b71a-a5fe7b58858f","descriptor":"extension-zone-toolbar-widget","values":{"item":{"path":["__itemRef"]}}},{"id":"f7b11c79-4267-4f5b-a002-dd629d549682","descriptor":"process-item-map","values":{"skipRulesCheck":true,"task":{"path":["task"]}}},{"id":"ff2500ee-6573-49cd-a9e8-2d5c93350f26","descriptor":"button","values":{"label":"bpm.tasks.item@menu","action":{"path":["menuAction"]},"runProcessSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"createAppItemSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"icon":"menu_vertical","view":"icon"}}],"[headerCustomization]":[]}},"fields":[{"code":"inf_about_acting_show","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"inf_about_acting_show","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"substitute_show","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"substitute_show","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}}],"fieldVisibilityConditions":{"substitute_show":{"enabled":false,"conditions":[]},"inf_about_acting_show":{"enabled":false,"conditions":[]}},"scriptOptions":{},"clientScripts":"/* Client scripts module */\n\nasync function subtitusuion_set(): Promise\u003cvoid\u003e {\n    if (Context.data.substitution_type) {\n        ViewContext.data.inf_about_acting_show = false;\n        ViewContext.data.substitute_show = false;\n        if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.substitution_performance.code) {\n            ViewContext.data.inf_about_acting_show = true;\n            ViewContext.data.substitute_show = true;\n        }\n        if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.substitution.code) ViewContext.data.substitute_show = true;\n        if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.performance.code) ViewContext.data.inf_about_acting_show = true;\n    }\n    else {\n        ViewContext.data.inf_about_acting_show = false;\n        ViewContext.data.substitute_show = false;\n    }\n}\n\n\nasync function date_correct(): Promise\u003cvoid\u003e {\n    if (Context.data.start_date \u0026\u0026 Context.data.end_date) {\n        const timeZoneCompany = System.timezones.default.offset + 100;\n        let timeZoneUser: number;\n        const curUser = await (await System.users.getCurrentUser()).fetch();\n        if (curUser.data.groupIds \u0026\u0026 curUser.data.groupIds.find(f =\u003e f.id === 'f25906e4-41c3-5a89-8ec2-06648dd1f614'))\n            timeZoneUser = -(Context.data.start_date.asDate().getTimezoneOffset() / 60) + 100;\n        else\n            timeZoneUser = curUser.timezone.offset + 100;\n        ViewContext.data.timezone = timeZoneUser - 100;\n        const delta = timeZoneUser - timeZoneCompany;\n        Context.data.start_day_line = Context.data.start_date.add(new Duration(delta, 'hours')).format(\"DD.MM.YYYY\");\n        Context.data.end_date_line = Context.data.end_date.add(new Duration(delta, 'hours')).format(\"DD.MM.YYYY\");\n    }\n}","clientScriptOptions":{"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{},"dataFieldCode":"context"},"dataNamespace":"kedo.execution_duties","dataCode":"_process_create_substitution","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        async function subtitusuion_set() {\n            if (Context.data.substitution_type) {\n                ViewContext.data.inf_about_acting_show = false;\n                ViewContext.data.substitute_show = false;\n                if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.substitution_performance.code) {\n                    ViewContext.data.inf_about_acting_show = true;\n                    ViewContext.data.substitute_show = true;\n                }\n                if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.substitution.code)\n                    ViewContext.data.substitute_show = true;\n                if (Context.data.substitution_type.code == Context.fields.substitution_type.variants.performance.code)\n                    ViewContext.data.inf_about_acting_show = true;\n            }\n            else {\n                ViewContext.data.inf_about_acting_show = false;\n                ViewContext.data.substitute_show = false;\n            }\n        }\n        async function date_correct() {\n            if (Context.data.start_date \u0026\u0026 Context.data.end_date) {\n                const timeZoneCompany = System.timezones.default.offset + 100;\n                let timeZoneUser;\n                const curUser = await (await System.users.getCurrentUser()).fetch();\n                if (curUser.data.groupIds \u0026\u0026 curUser.data.groupIds.find(f =\u003e f.id === 'f25906e4-41c3-5a89-8ec2-06648dd1f614'))\n                    timeZoneUser = -(Context.data.start_date.asDate().getTimezoneOffset() / 60) + 100;\n                else\n                    timeZoneUser = curUser.timezone.offset + 100;\n                ViewContext.data.timezone = timeZoneUser - 100;\n                const delta = timeZoneUser - timeZoneCompany;\n                Context.data.start_day_line = Context.data.start_date.add(new Duration(delta, 'hours')).format(\"DD.MM.YYYY\");\n                Context.data.end_date_line = Context.data.end_date.add(new Duration(delta, 'hours')).format(\"DD.MM.YYYY\");\n            }\n        }\n        return {\n            subtitusuion_set,\n            date_correct\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"subtitusuion_set","parameters":[],"type":"[object Object]"},{"name":"date_correct","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-12-20T13:09:06.377745189Z","__createdBy":"7303b866-4220-4086-a09e-348a76b12c73","__updatedAt":"2024-02-14T11:08:08.048318259Z","__updatedBy":"7303b866-4220-4086-a09e-348a76b12c73","__deletedAt":null}
