{"__id":"018e89f9-2470-7ae4-862a-5a6e1c351571","namespace":"kedo.execution_duties","code":"form_d39fe359-5bf2-442f-9c96-292bbf980386","__name":"Заполнение данных для оформления ИО","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":2,"hidden":true,"draft":false,"readonly":false,"descriptor":{"types":["form"],"template":{"id":"b28e47a7-5ab1-4b4c-ac12-7f2ef6de1a03","descriptor":"item-form-complex-popup","descriptorVersion":2,"values":{"formType":"task-form","formGroup":{"path":["context"]},"systemFunctions":{}},"content":{"[footer]":[{"id":"31979bac-00bd-4123-a901-9d14190c8dde","descriptor":"buttons-panel","values":{"buttons":{"path":["actionButtons"]}}}],"[content]":[{"id":"c18e9118-cda2-49f4-ae50-5414c9b970b2","descriptor":"modal-body","values":{"shadow":true},"content":{"":[{"id":"e9bb66cb-3f6a-4ba1-b013-217ce9389e6c","descriptor":"elma-info-block","values":{"__renderContentOnDemand":false,"__outlet":"","typeEnum":[{"code":"danger","name":"Ошибка (красный)"}],"__baseURL":"","__renderContentAsync":false,"text":"Внимание! По данному процессу запущен процесс отмены. До завершения процесса рекомендуем не выполнять данную задачу.","__hidden":{"path":["is_cancellation_process"],"modifier":"not"},"__relativeURL":"","__isConstValues":[]},"content":{"":[]}},{"id":"7317319e-c9fb-4300-8a46-7a85b4c6ed86","descriptor":"row","values":{"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"313cb81b-7acf-4bf1-a1c7-412c258fdbf3","descriptor":"column","content":{"":[{"id":"77cb2311-cdd7-4f4b-9313-642da1657ddd","descriptor":"groupbox","values":{"title":"Информация по ИО","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false,"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"dcdd3e4e-0c49-483b-87c2-8c782a8890f0","descriptor":"dynamic-form","values":{"form":{"path":["context"]},"fields":{"path":["fields"]}}}]}},{"id":"aeb73f3c-1700-48cf-abc7-28f64b4be4dd","descriptor":"ext_7fe3de7d-f459-4f75-940c-271c6e9ea1ed@converting_dates","descriptorVersion":1,"values":{"__isConstValues":[],"date_1":{"path":["context","start_date"]},"date_2":{"path":["context","end_date"]},"__hidden":true,"date_1_string":{"path":["context","start_date_string"]},"date_2_string":{"path":["context","end_date_string"]}}},{"id":"5ebe2fde-7582-47e7-86d1-fa1b4d2d9d8e","descriptor":"dynamic-form-row","values":{"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","start_date"]},"tooltip":null,"required":true,"hideEmpty":false}},{"id":"dfa060a4-6fd0-4b64-beba-3ec2e6f5498c","descriptor":"dynamic-form-row","values":{"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","end_date"]}}}]}},{"id":"d48ad73d-21c5-4393-a75a-70af5b830f58","descriptor":"column","content":{"":[{"id":"1bcfdc00-641b-4062-9a71-428bb0775bf2","descriptor":"row","values":{"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"ba877be3-6fb8-4671-851b-22c8eff40ca0","descriptor":"column","content":{"":[{"id":"17ebdbce-f827-4e13-b5ad-9ff3afcfc66e","descriptor":"groupbox","values":{"expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false,"__isConstValues":[],"__renderContentAsync":false,"title":"Информация о приказе "},"content":{"":[{"id":"bdbefd06-9bf4-4e7a-b91f-59bc4f10be44","descriptor":"dynamic-form-row","values":{"__readOnly":null,"__isConstValues":[],"control":{"path":["context","number_of_contract_string"]},"required":true,"hideEmpty":false,"bindingMode":false,"displayName":"Номер приказа ","showDisplayName":true,"tooltip":null}}]}}]}},{"id":"ea7377ea-ac0d-442a-b80d-902f98cfe035","descriptor":"column","content":{"":[{"id":"fcbef36f-e5e0-4f53-ac12-6bf3b7186560","descriptor":"groupbox","values":{"title":"Информация о ДС","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false,"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"f25b82bb-dd7a-4698-93e1-6f6414a5d39e","descriptor":"dynamic-form-row","values":{"required":false,"__baseURL":"","hideEmpty":false,"displayName":"Номер ДС ","__renderContentOnDemand":false,"control":{"path":["context","additional_agreement_number_string"]},"__outlet":"","__readOnly":null,"bindingMode":false,"__relativeURL":"","__isConstValues":[],"showDisplayName":true,"tooltip":null}},{"id":"b8082bba-b8ba-4546-890d-72ea05ddf592","descriptor":"dynamic-form-row","values":{"tooltip":null,"displayName":"Номер трудового договора","__isConstValues":[],"showDisplayName":true,"bindingMode":false,"control":{"path":["context","labor_contract_number"]},"required":false,"hideEmpty":false,"__readOnly":null}},{"id":"9b28f7aa-db5b-45f9-b227-236ba7430b46","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["context","procent"]},"required":true,"hideEmpty":false,"__readOnly":null,"displayName":"Процент / фиксированная сумма","tooltip":null,"bindingMode":false,"__isConstValues":[]}},{"id":"c0aaf3ef-38ce-47e9-ae89-f0b6f4785382","descriptor":"dynamic-form-row","values":{"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","contract_date"]},"tooltip":null,"required":true,"hideEmpty":false}},{"id":"6e71ebd4-2286-4cec-826d-6b8a7d7ab64a","descriptor":"dynamic-form-row","values":{"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["context","substitute_staff"]},"hideEmpty":false,"__readOnly":null,"tooltip":null,"required":true,"showCreateItem":false}}]}}]}}]}}]}}]}}]}}],"[sidebar]":[{"id":"39d7757a-529f-4526-98f3-fddc66becf85","descriptor":"sidebar-widget","content":{"":[{"id":"abe4b782-6e2d-49cc-a57e-81b636422ee5","descriptor":"target-widget","values":{"context":{"path":["context"]}}}]}},{"id":"231b371a-64ae-4b61-8014-cba6da318ac9","descriptor":"sidebar-widget","content":{"":[{"id":"5e39b91d-aea4-467e-862f-0f8766eb44df","descriptor":"linked-item","values":{"context":{"path":["context"]}}}]}},{"id":"a4469de0-d7f3-11ec-9d64-0242ac120002","descriptor":"sidebar-widget","content":{"":[{"id":"3ead7c41-6dfa-4144-80da-2bfb5f0ccf59","descriptor":"item-reminder","values":{"formGroup":{"path":["context"]}}}]}},{"id":"56d1d0e8-aa83-4cdd-ae43-294b26ad4d04","descriptor":"sidebar-widget","content":{"":[{"id":"e1525e34-14ba-456b-b703-f407945c01e0","descriptor":"item-tasks","descriptorVersion":4,"values":{"formGroup":{"path":["context"]},"itemModel":{"path":["itemModel"]}}}]}},{"id":"eef018f2-1d3a-4600-a19d-791733b28b5e","descriptor":"sidebar-widget","content":{"":[{"id":"e0a17dec-603a-461a-becf-861637630584","descriptor":"messages-target","values":{"target":{"path":["target"]}}}]}}],"[formInfoPanel]":[{"id":"6c6580c9-c5b0-4f3f-858f-aec147240cfc","descriptor":"validation-info-block","values":{"__validateResult":{"path":["context","__validateResult"]}}}],"[headerControls]":[{"id":"475aa008-aaff-402f-8de2-408bae1f1928","descriptor":"task-percent-widget","values":{"task":{"path":["task"]}}},{"id":"702d9c59-77ae-4dd5-b71a-a5fe7b58858f","descriptor":"extension-zone-toolbar-widget","values":{"item":{"path":["__itemRef"]}}},{"id":"f7b11c79-4267-4f5b-a002-dd629d549682","descriptor":"process-item-map","values":{"task":{"path":["task"]},"skipRulesCheck":true}},{"id":"ff2500ee-6573-49cd-a9e8-2d5c93350f26","descriptor":"button","values":{"action":{"path":["menuAction"]},"runProcessSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"createAppItemSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"icon":"menu_vertical","view":"icon","label":"bpm.tasks.item@menu"}}],"[headerCustomization]":[]}},"fields":[{"code":"is_cancellation_process","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Инициирован процесс анннулирования документов?","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"},"input":true,"output":true}}],"fieldVisibilityConditions":{"is_cancellation_process":{"enabled":false,"conditions":[]}},"scriptOptions":{},"clientScripts":"/* Client scripts module */\ndeclare const console:any;\n\nasync function onInit(): Promise\u003cvoid\u003e {\n\n    if (Context.data.execution_duties) {\n        const app = await Context.data.execution_duties.fetch();\n        ViewContext.data.is_cancellation_process = app.data.is_cancellation_process;\n    }\n\n    const execution_duties = await Context.data.execution_duties!.fetch();\n    const labor_contract = await Context.fields.labor_contract.app.search()\n        .where((f, g) =\u003e g.and(\n            f.__deletedAt.eq(null),\n            f.staff.link(execution_duties.data.substitute!),\n            f.__status.eq(Context.fields.labor_contract.app.fields.__status.variants.signed)\n        ))\n        .first();\n    if (labor_contract) {\n        Context.data.labor_contract_number = labor_contract.data.labor_contract_number;\n        Context.data.contract_date = labor_contract.data.__createdAt.getDate();\n    }\n    Context.data.start_date = execution_duties!.data.start_date!.getDate();\n    Context.data.end_date = execution_duties!.data.end_date!.getDate();\n}\n\n\n\nasync function labor_contract_change(): Promise\u003cvoid\u003e {\n    if (Context.data.labor_contract) {\n        let app = await Context.data.labor_contract.fetch();\n        Context.data.contract_date = app.data.__createdAt.getDate();\n    }\n}\n","clientScriptOptions":{"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{},"dataFieldCode":"context"},"dataNamespace":"kedo.execution_duties","dataCode":"_process_create_agreement_order","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server, System) {\n        async function onInit() {\n            if (Context.data.execution_duties) {\n                const app = await Context.data.execution_duties.fetch();\n                ViewContext.data.is_cancellation_process = app.data.is_cancellation_process;\n            }\n            const execution_duties = await Context.data.execution_duties.fetch();\n            const labor_contract = await Context.fields.labor_contract.app.search()\n                .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.staff.link(execution_duties.data.substitute), f.__status.eq(Context.fields.labor_contract.app.fields.__status.variants.signed)))\n                .first();\n            if (labor_contract) {\n                Context.data.labor_contract_number = labor_contract.data.labor_contract_number;\n                Context.data.contract_date = labor_contract.data.__createdAt.getDate();\n            }\n            Context.data.start_date = execution_duties.data.start_date.getDate();\n            Context.data.end_date = execution_duties.data.end_date.getDate();\n        }\n        async function labor_contract_change() {\n            if (Context.data.labor_contract) {\n                let app = await Context.data.labor_contract.fetch();\n                Context.data.contract_date = app.data.__createdAt.getDate();\n            }\n        }\n        return {\n            onInit,\n            labor_contract_change\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"onInit","parameters":[],"type":"[object Object]"},{"name":"labor_contract_change","parameters":[],"type":"[object Object]"}],"clientDependencies":{"applications":[{"namespace":"kedo","code":"labor_contract"}],"collections":[{"namespace":"kedo","code":"execution_duties"},{"namespace":"kedo","code":"labor_contract"}],"pages":[]}},"__createdAt":"2024-03-29T11:29:50.190309424Z","__createdBy":"d78f4b2f-13a2-4903-aeeb-fdb72d5b9d0c","__updatedAt":"2024-04-15T10:18:26.3206855Z","__updatedBy":"1a8a4a0b-7e7e-4e0e-895e-ab2a0a301d1e","__deletedAt":null}
