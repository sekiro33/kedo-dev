{"__id":"018c8758-56d6-7f00-9a45-a2c48d3c3df4","namespace":"ext_7fe3de7d-f459-4f75-940c-271c6e9ea1ed","code":"_bdf28a64-1e9c-413c-a14d-7c1a284b6789_binding-form","__name":"bdf28a64-1e9c-413c-a14d-7c1a284b6789_binding-form","description":"app.modules.admin.integration.settings@binding-form-description","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":3,"hidden":false,"draft":false,"readonly":false,"descriptor":{"types":["form","custom-activity-binding-form"],"template":{"id":"eafd6625-2ff3-41d7-8207-1c5cd3dba292","descriptor":"component","content":{"":[{"id":"7d7bd35a-d521-4c08-9d55-d7c3a74932cc","descriptor":"modal-body","content":{"":[{"id":"c467ade7-e8d2-4fc6-b715-97b25e31c0d9","descriptor":"groupbox","values":{"__isConstValues":[],"__renderContentAsync":false,"title":"Тип интеграции","__styles":"margin-bottom: 10px","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false},"content":{"":[{"id":"7398ba24-8b4b-460f-a899-161d938360e4","descriptor":"dynamic-form-row","values":{"required":true,"__readOnly":null,"bindingMode":false,"onChangeValue":{"kind":"Function","name":"alternative_integration_onchange","type":"client"},"__isConstValues":[],"showDisplayName":true,"tooltip":null,"hideEmpty":false,"control":{"path":["item","is_alternative"]}}}]}},{"id":"5ac62cda-1f39-4c33-9fe6-3ae686c793e8","descriptor":"groupbox","values":{"__styles":"margin-bottom: 10px","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false,"__isConstValues":[],"__renderContentAsync":false,"title":"Интеграция 1С","__hidden":{"path":["item","is_alternative"]}},"content":{"":[{"id":"9ef48185-1045-4331-8448-afa7c72c7716","descriptor":"dynamic-form-row","values":{"bindingMode":false,"displayName":"ID документа 1С","showDisplayName":true,"control":{"path":["item","doc_id"]},"tooltip":null,"__readOnly":null,"required":false,"hideEmpty":false,"__isConstValues":[]}},{"id":"8701a7c1-70b7-4145-a4fa-eac6ed6d45a0","descriptor":"dynamic-form-row","values":{"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["document_status_1c"]},"tooltip":null,"required":false,"hideEmpty":false}},{"id":"9b4e0275-b1b7-49b8-b252-eb0b53832799","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["item","polnoe_imya_statusa"]},"tooltip":null,"required":{"path":["full_status_name_required"]},"hideEmpty":false,"__readOnly":true,"bindingMode":false,"__isConstValues":[]}},{"id":"4aef7deb-41c3-4324-8739-5ebd6128a042","descriptor":"dynamic-form-row","values":{"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["item","delete_printing_file"]},"tooltip":null,"required":false,"hideEmpty":false}},{"id":"f54615b2-54d4-48c1-95f5-78f9583b78fd","descriptor":"dynamic-form-row","values":{"tooltip":null,"required":false,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["item","connection_name"]}}}]}},{"id":"14973e82-9733-4a96-8b9a-325ed0011bca","descriptor":"groupbox","values":{"__isConstValues":[],"__renderContentAsync":false,"title":"Альтернативная интеграция 1С","__hidden":{"path":["item","is_alternative"],"modifier":"not"},"__styles":"margin-bottom: 10px","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false},"content":{"":[{"id":"22ca3ea9-9edb-4fa9-9db4-1374c3d25b31","descriptor":"dynamic-form-row","values":{"control":{"path":["item","doc_id"]},"tooltip":"Если указан ID 1С сотрудника - поле заполнять не обязательно","required":false,"bindingMode":false,"displayName":"ID документа 1С","hideEmpty":false,"__readOnly":null,"__isConstValues":[],"showDisplayName":true}},{"id":"426fbe9b-688f-4ada-be33-07fa93276480","descriptor":"dynamic-form-row","values":{"hideEmpty":false,"__readOnly":null,"onChangeValue":{"kind":"Function","name":"document_status_onchange","type":"client"},"__isConstValues":[],"control":{"path":["document_status_1c"]},"required":false,"bindingMode":false,"showDisplayName":true,"tooltip":null}},{"id":"7f946a7a-8eb2-4a55-9b22-c6f4f2399c09","descriptor":"dynamic-form-row","values":{"required":{"path":["item","is_alternative"]},"__readOnly":null,"onChangeValue":{"kind":"Function","name":"doc_status_onchange","type":"client"},"__isConstValues":[],"showDisplayName":true,"control":{"path":["statusy_dokumentov"]},"tooltip":null,"__hidden":true,"hideEmpty":false,"bindingMode":false,"showCreateItem":false}},{"id":"a585d475-8db4-4100-ba38-ec8d0eb12bdb","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["item","polnoe_imya_statusa"]},"tooltip":null,"required":false,"hideEmpty":false,"__readOnly":true,"bindingMode":false,"__isConstValues":[]}},{"id":"7a52da89-148f-4f2a-a5bc-7008cce7c7ce","descriptor":"dynamic-form-row","values":{"tooltip":"Укажите сотрудника, если нужно сменить статус всех его документов из 1С","required":false,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["item","staff"]}}}]}},{"id":"8175a98b-db0c-40f3-ba44-7ac0fb5f1bcd","descriptor":"groupbox","values":{"title":"Отладочная информация","expanded":true,"styleEnum":[{"code":"default","name":"Default"}],"collapsible":false,"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"3d220763-35e0-4390-80d8-64d8d750b58e","descriptor":"dynamic-form-row","values":{"control":{"path":["item","response"]},"tooltip":null,"__readOnly":null,"bindingMode":false,"required":false,"hideEmpty":false,"onChangeValue":{"kind":"Function","name":{},"type":"client"},"__isConstValues":[],"showDisplayName":true}},{"id":"b51f6413-2390-461a-b283-da95c028d9bd","descriptor":"dynamic-form-row","values":{"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["item","error"]},"tooltip":null,"required":false,"hideEmpty":false,"__readOnly":null}}]}}]}}]}},"fields":[{"code":"full_status_name_required","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Обязательность \"Полное имя статуса\"","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"statusy_dokumentov","type":"SYS_COLLECTION","searchable":false,"indexed":false,"deleted":false,"array":true,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{"code":"document_statuses","filter":{"value":{"tf":{}},"enabled":false},"bindings":null,"namespace":"kedo","isDependent":false,"linkedFieldCode":""},"view":{"name":"Статусы документов","data":{}}},{"code":"doc_id_1c_required","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":true,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Обязательность \"ID документа в 1С\"","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"document_status_1c","type":"ENUM","searchable":false,"indexed":false,"deleted":false,"array":true,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{"enumItems":[{"code":"on_sign","name":"На подписании","checked":false},{"code":"signed","name":"Подписан","checked":false},{"code":"rejected","name":"Отменен","checked":false}]},"view":{"name":"Статус документа","data":{}}}],"fieldVisibilityConditions":{"doc_id_1c_required":{"enabled":false,"conditions":[]},"document_status_1c":{"enabled":false,"conditions":[]},"statusy_dokumentov":{"enabled":false,"conditions":[]},"full_status_name_required":{"enabled":false,"conditions":[]}},"scriptOptions":{},"clientScripts":"/* Client scripts module */\n\nasync function alternative_integration_onchange(): Promise\u003cvoid\u003e {\n    if (Context.data.is_alternative) {\n        ViewContext.data.full_status_name_required = !Context.data.is_alternative;\n    }\n\n    Context.data.staff_id_1c = undefined;\n}\n\nasync function doc_status_onchange(): Promise\u003cvoid\u003e {\n    if (ViewContext.data.statusy_dokumentov) {\n        const doc_status = await ViewContext.data.statusy_dokumentov.fetch();\n        Context.data.polnoe_imya_statusa = doc_status.data.full_name;\n    }\n}\n\nasync function staff_id_1c_onchange(): Promise\u003cvoid\u003e {\n    ViewContext.data.doc_id_1c_required = true;\n    if (Context.data.staff_id_1c \u0026\u0026 Context.data.staff_id_1c.length \u003e 0) {\n        ViewContext.data.doc_id_1c_required = false;\n    }\n}\n\nasync function document_status_onchange(): Promise\u003cvoid\u003e {\n    if (ViewContext.data.document_status_1c) {\n        const status = await ViewContext.fields.statusy_dokumentov.app.search().size(10000).all();\n\n        switch (ViewContext.data.document_status_1c.code) {\n            case ViewContext.fields.document_status_1c.variants.on_sign.code:\n                ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2767-c0a6-11ed-80cb-f20017d1803e');\n                break;\n\n            case ViewContext.fields.document_status_1c.variants.rejected.code:\n                ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2769-c0a6-11ed-80cb-f20017d1803e');\n                break;\n\n            case ViewContext.fields.document_status_1c.variants.signed.code:\n                ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2768-c0a6-11ed-80cb-f20017d1803e');\n                break;\n        }\n    }\n}\n","clientScriptOptions":{"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{},"dataFieldCode":"item"},"dataNamespace":"ext_7fe3de7d-f459-4f75-940c-271c6e9ea1ed","dataCode":"","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        async function alternative_integration_onchange() {\n            if (Context.data.is_alternative) {\n                ViewContext.data.full_status_name_required = !Context.data.is_alternative;\n            }\n            Context.data.staff_id_1c = undefined;\n        }\n        async function doc_status_onchange() {\n            if (ViewContext.data.statusy_dokumentov) {\n                const doc_status = await ViewContext.data.statusy_dokumentov.fetch();\n                Context.data.polnoe_imya_statusa = doc_status.data.full_name;\n            }\n        }\n        async function staff_id_1c_onchange() {\n            ViewContext.data.doc_id_1c_required = true;\n            if (Context.data.staff_id_1c \u0026\u0026 Context.data.staff_id_1c.length \u003e 0) {\n                ViewContext.data.doc_id_1c_required = false;\n            }\n        }\n        async function document_status_onchange() {\n            if (ViewContext.data.document_status_1c) {\n                const status = await ViewContext.fields.statusy_dokumentov.app.search().size(10000).all();\n                switch (ViewContext.data.document_status_1c.code) {\n                    case ViewContext.fields.document_status_1c.variants.on_sign.code:\n                        ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2767-c0a6-11ed-80cb-f20017d1803e');\n                        break;\n                    case ViewContext.fields.document_status_1c.variants.rejected.code:\n                        ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2769-c0a6-11ed-80cb-f20017d1803e');\n                        break;\n                    case ViewContext.fields.document_status_1c.variants.signed.code:\n                        ViewContext.data.statusy_dokumentov = status.find(f =\u003e f.data.guid == '5b7a2768-c0a6-11ed-80cb-f20017d1803e');\n                        break;\n                }\n            }\n        }\n        return {\n            alternative_integration_onchange,\n            doc_status_onchange,\n            staff_id_1c_onchange,\n            document_status_onchange\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"alternative_integration_onchange","parameters":[],"type":"[object Object]"},{"name":"doc_status_onchange","parameters":[],"type":"[object Object]"},{"name":"staff_id_1c_onchange","parameters":[],"type":"[object Object]"},{"name":"document_status_onchange","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-12-20T13:09:22.772507414Z","__createdBy":"7303b866-4220-4086-a09e-348a76b12c73","__updatedAt":"2024-02-14T11:09:35.29972306Z","__updatedBy":"7303b866-4220-4086-a09e-348a76b12c73","__deletedAt":null}
