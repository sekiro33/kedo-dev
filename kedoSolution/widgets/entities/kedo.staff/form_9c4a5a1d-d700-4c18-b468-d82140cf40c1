{"__id":"018c8758-11bd-7ade-99dd-3d74f520b5a2","namespace":"kedo.staff","code":"form_9c4a5a1d-d700-4c18-b468-d82140cf40c1","__name":"Подписать пакет документов для трудоустройства","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":3,"hidden":true,"draft":false,"readonly":false,"descriptor":{"types":["form"],"template":{"id":"450ee765-f6c1-4dbf-8826-849546e3b36b","descriptor":"item-form-complex-popup","descriptorVersion":2,"values":{"formType":"task-form","formGroup":{"path":["context"]},"systemFunctions":{"validate":{"kind":"Function","name":"validate","type":"client"}}},"content":{"[footer]":[{"id":"31979bac-00bd-4123-a901-9d14190c8dde","descriptor":"buttons-panel","values":{"buttons":{"path":["actionButtons"]}}}],"[content]":[{"id":"c18e9118-cda2-49f4-ae50-5414c9b970b2","descriptor":"modal-body","values":{"shadow":true},"content":{"":[{"id":"5c48d393-7bb0-4d17-bfec-7565aedd6f47","descriptor":"code","values":{"html":"\u003cstyle\u003e\r\n    .hide-boolean {\r\n        display: none !important;\r\n    }\r\n\u003c/style\u003e","hideContent":true,"contentPlaceholder":"css"}},{"id":"06ad27d8-c4b3-428f-846b-4991cbf29a9c","descriptor":"dynamic-form-row","values":{"__readOnly":null,"bindingMode":false,"onChangeValue":{"kind":"Function","name":{},"type":"client"},"showDisplayName":true,"control":{"path":["all_docs_signed"]},"tooltip":null,"__classes":"hide-boolean","required":false,"hideEmpty":false,"__isConstValues":[]}},{"id":"60642000-d6cd-4077-8a57-7238989162e9","descriptor":"kedo@signing_package_of_documents_for_employment","descriptorVersion":18,"values":{"all_docs_signed":{"path":["all_docs_signed"]},"staff":{"path":["context","staff"]},"__styles":"width: 100%;","docs_for_sign":{"path":["context","docs"]},"__isConstValues":[]}}]}}],"[sidebar]":[{"id":"39d7757a-529f-4526-98f3-fddc66becf85","descriptor":"sidebar-widget","content":{"":[{"id":"abe4b782-6e2d-49cc-a57e-81b636422ee5","descriptor":"target-widget","values":{"context":{"path":["context"]}}}]}},{"id":"231b371a-64ae-4b61-8014-cba6da318ac9","descriptor":"sidebar-widget","content":{"":[{"id":"5e39b91d-aea4-467e-862f-0f8766eb44df","descriptor":"linked-item","values":{"context":{"path":["context"]}}}]}},{"id":"a4469de0-d7f3-11ec-9d64-0242ac120002","descriptor":"sidebar-widget","content":{"":[{"id":"3ead7c41-6dfa-4144-80da-2bfb5f0ccf59","descriptor":"item-reminder","values":{"formGroup":{"path":["context"]}}}]}},{"id":"56d1d0e8-aa83-4cdd-ae43-294b26ad4d04","descriptor":"sidebar-widget","content":{"":[{"id":"e1525e34-14ba-456b-b703-f407945c01e0","descriptor":"item-tasks","descriptorVersion":4,"values":{"formGroup":{"path":["context"]}}}]}},{"id":"eef018f2-1d3a-4600-a19d-791733b28b5e","descriptor":"sidebar-widget","content":{"":[{"id":"e0a17dec-603a-461a-becf-861637630584","descriptor":"messages-target","values":{"target":{"path":["target"]}}}]}}],"[formInfoPanel]":[{"id":"7f4a27b4-47e2-4f8c-a33f-e9dc66a8ef39","descriptor":"validation-info-block","values":{"__validateResult":{"path":["context","__validateResult"]}}}],"[headerControls]":[{"id":"475aa008-aaff-402f-8de2-408bae1f1928","descriptor":"task-percent-widget","values":{"task":{"path":["task"]}}},{"id":"702d9c59-77ae-4dd5-b71a-a5fe7b58858f","descriptor":"extension-zone-toolbar-widget","values":{"item":{"path":["__itemRef"]}}},{"id":"f7b11c79-4267-4f5b-a002-dd629d549682","descriptor":"process-item-map","values":{"task":{"path":["task"]},"skipRulesCheck":true}},{"id":"ff2500ee-6573-49cd-a9e8-2d5c93350f26","descriptor":"button","values":{"view":"icon","label":"bpm.tasks.item@menu","action":{"path":["menuAction"]},"runProcessSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"createAppItemSettings":{"kind":"","settings":{"code":"","field":"","binding":null,"namespace":""}},"icon":"menu_vertical"}}],"[headerCustomization]":[]}},"fields":[{"code":"valid_string","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Строка валидации","data":{"additionalType":"string"}}},{"code":"stopper","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Стоппер","data":{"additionalType":"string"}}},{"code":"stopper_need","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Стоппер обязателен","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"all_docs_signed","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Документы подписаны","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"all_documents_loaded","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":false,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Документы загружены","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}}],"fieldVisibilityConditions":{"stopper":{"enabled":false,"conditions":[]},"stopper_need":{"enabled":false,"conditions":[]},"valid_string":{"enabled":false,"conditions":[]},"all_docs_signed":{"enabled":false,"conditions":[]},"all_documents_loaded":{"enabled":false,"conditions":[]}},"scriptOptions":{"allowNamespace":true},"clientScripts":"\nasync function validate(): Promise\u003cValidationResult\u003e {\n    let result = new ValidationResult();\n    if (ViewContext.data.all_docs_signed == false || !ViewContext.data.all_docs_signed) {\n        result.addViewContextError(\"all_docs_signed\", \"Все документы должны быть подписаны.\")\n    };\n    return result;\n}","clientScriptOptions":{"allowNamespace":true,"allowServer":true},"serverScripts":"async function testDocs(): Promise\u003cvoid\u003e {\n    let filesArr: any[] = []\n        await Namespace.app.documents_for_employment.search()\n            .where(item =\u003e item.staff.link(Context.data.staff!))\n            .size(100)\n            .all()\n            .then((items) =\u003e {\n                if(items){\n                    filesArr.push(...items)\n                }\n            })\n\n    filesArr = filesArr ? filesArr.filter((file:any) =\u003e {\n        return file.data.__sourceRef.code !== 'order_for_transfer'\n            \u0026\u0026 file.data.__sourceRef.code !== 'transfer_application'\n            \u0026\u0026 file.data.__sourceRef.code !== 'letter_of_resignation'\n            \u0026\u0026 file.data.__sourceRef.code !== 'dismissal_order'\n            \u0026\u0026 file.data.__sourceRef.code !== 'job_application'\n            \u0026\u0026 file.data.__sourceRef.code !== 'information_about_labor_activity'\n            \u0026\u0026 file.data.__sourceRef.code !== 'electronic_interaction_agreement'\n    }) : []\n\n    filesArr = filesArr.sort((item1, item2) =\u003e {\n        if(item2.data.__createdAt.after(item1.data.__createdAt)){\n            return -1;\n        } else {\n            return 1\n        }\n    })\n    Context.data.test = filesArr.map(doc =\u003e doc.id).join(\" \");\n}","serverScriptOptions":{"allowNamespace":true},"dataFieldCode":"context"},"dataNamespace":"kedo.staff","dataCode":"_process_signing_employment_docs","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        async function validate() {\n            let result = new ValidationResult();\n            if (ViewContext.data.all_docs_signed == false || !ViewContext.data.all_docs_signed) {\n                result.addViewContextError(\"all_docs_signed\", \"Все документы должны быть подписаны.\");\n            }\n            ;\n            return result;\n        }\n        return {\n            validate\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"validate","parameters":[],"type":"[object Object]"}],"serverScripts":"async function testDocs() {\n    let filesArr = [];\n    await Namespace.app.documents_for_employment.search()\n        .where(item =\u003e item.staff.link(Context.data.staff))\n        .size(100)\n        .all()\n        .then((items) =\u003e {\n        if (items) {\n            filesArr.push(...items);\n        }\n    });\n    filesArr = filesArr ? filesArr.filter((file) =\u003e {\n        return file.data.__sourceRef.code !== 'order_for_transfer'\n            \u0026\u0026 file.data.__sourceRef.code !== 'transfer_application'\n            \u0026\u0026 file.data.__sourceRef.code !== 'letter_of_resignation'\n            \u0026\u0026 file.data.__sourceRef.code !== 'dismissal_order'\n            \u0026\u0026 file.data.__sourceRef.code !== 'job_application'\n            \u0026\u0026 file.data.__sourceRef.code !== 'information_about_labor_activity'\n            \u0026\u0026 file.data.__sourceRef.code !== 'electronic_interaction_agreement';\n    }) : [];\n    filesArr = filesArr.sort((item1, item2) =\u003e {\n        if (item2.data.__createdAt.after(item1.data.__createdAt)) {\n            return -1;\n        }\n        else {\n            return 1;\n        }\n    });\n    Context.data.test = filesArr.map(doc =\u003e doc.id).join(\" \");\n}\n","serverFnDeclarations":[{"name":"testDocs","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-12-20T13:09:05.083750402Z","__createdBy":"7303b866-4220-4086-a09e-348a76b12c73","__updatedAt":"2024-02-14T11:08:04.390911166Z","__updatedBy":"7303b866-4220-4086-a09e-348a76b12c73","__deletedAt":null}
