{"__id":"018c8758-3265-7cbd-a0dc-a99f9c61ba7f","namespace":"kedo.staff","code":"form_360c1b2c-17a9-48db-a57e-c26fa9539242","__name":"Форма запуска","description":"","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":3,"hidden":true,"draft":false,"readonly":false,"descriptor":{"types":["form"],"template":{"id":"99fc80bc-acc2-43ba-8ced-aaba8e12991e","descriptor":"item-form-complex-popup","descriptorVersion":2,"values":{"formType":"start-process-form","formGroup":{"path":["context"]},"systemFunctions":{"validate":{"kind":"Function","name":"validate","type":"client"}}},"content":{"[headerCustomization]":[],"[footer]":[{"id":"cc734fcd-17d6-4b8c-8529-91a25cc2a94e","descriptor":"buttons-panel","values":{"buttons":{"path":["actionButtons"]}}}],"[content]":[{"id":"c18e9118-cda2-49f4-ae50-5414c9b970b2","descriptor":"modal-body","values":{"shadow":true},"content":{"":[{"id":"08587203-f790-48e9-aecf-9a61745ae83b","descriptor":"dynamic-form-row","values":{"__baseURL":"","hideEmpty":false,"__relativeURL":"","showCreateItem":false,"__isConstValues":[],"showDisplayName":true,"__hidden":{"path":["view_staff"],"modifier":"not"},"__outlet":"","required":{"path":["view_staff"]},"__readOnly":null,"bindingMode":false,"control":{"path":["context","staff"]},"tooltip":null}},{"id":"17c80e5c-ba7f-4f36-9845-e9be7721016a","descriptor":"dynamic-form-row","values":{"control":{"path":["context","staff_categories"]},"tooltip":null,"bindingMode":false,"onChangeValue":{"kind":"Function","name":"category_change","type":"client"},"__isConstValues":[],"required":true,"hideEmpty":false,"__readOnly":null,"showCreateItem":false,"showDisplayName":true}},{"id":"bd1a9f56-77ab-4f0c-be97-8cd2cb71b169","descriptor":"dynamic-form-row","values":{"__hidden":{"path":["view_invalid_child"],"modifier":"not"},"required":false,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"control":{"path":["context","vacation_invalid_child_days"]},"tooltip":null,"__isConstValues":[],"showDisplayName":true}},{"id":"fbcadb2d-3350-4301-b80a-96a15d93e595","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["context","assignment_date"]},"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[]}},{"id":"eb43ad2b-fb8f-41e8-a4e7-df512f4728e4","descriptor":"dynamic-form-row","values":{"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[],"control":{"path":["context","expiration_date"]},"tooltip":null,"__hidden":{"path":["view_expiration_date"],"modifier":"not"},"required":{"path":["view_expiration_date"]},"showDisplayName":true}}]}}],"[sidebar]":[{"id":"0ceaa8ec-5cdc-4385-9a6b-b0ae1e04039b","descriptor":"sidebar-widget","content":{"":[{"id":"2c1bfe32-44b9-46d5-bee7-2ed66205f4d6","descriptor":"user-guide","values":{"userGuide":{"path":["instruction"]}}}]}},{"id":"2112f287-a8ad-433c-862d-f9808c2d4f7b","descriptor":"sidebar-widget","content":{"":[{"id":"8900384e-a047-46b0-8ba7-462c23711e72","descriptor":"target-widget","values":{"context":{"path":["context"]}}}]}}],"[headerControls]":[]}},"fields":[{"code":"view_expiration_date","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"view_expiration_date","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"view_invalid_child","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"view_invalid_child","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}},{"code":"view_staff","type":"BOOLEAN","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"view_staff","data":{"additionalType":"radio","noValue":"Нет","yesValue":"Да"}}}],"fieldVisibilityConditions":{"view_staff":{"enabled":false,"conditions":[]},"view_invalid_child":{"enabled":false,"conditions":[]},"view_expiration_date":{"enabled":false,"conditions":[]}},"scriptOptions":{},"clientScripts":"/* Client scripts module */\n\n\nasync function onInit(): Promise\u003cvoid\u003e {\n    Context.data.assignment_date = new TDate();\n    if (!!Context.data.bulk_edit) {\n        ViewContext.data.view_staff = false;\n    } else {\n        ViewContext.data.view_staff = true;\n    }\n}\nasync function category_change(): Promise\u003cvoid\u003e {\n    if (Context.data.staff_categories) {\n        let app = await Context.data.staff_categories.fetch();\n        if (app.data.perpetual == false || undefined) {\n            ViewContext.data.view_expiration_date = true;\n        }\n        else {\n            ViewContext.data.view_expiration_date = false;\n        }\n\n        if (app.data.code == 'invalid_child') {\n            ViewContext.data.view_invalid_child = true;\n        }\n        else {\n            ViewContext.data.view_invalid_child = false;\n        }\n\n    }\n\n}\n\nasync function validate(): Promise\u003cValidationResult\u003e {\n    const result = new ValidationResult();\n    if(Context.data.staff \u0026\u0026 Context.data.staff_categories){\n        let staff = await Context.data.staff.fetch();\n        if(staff.data.categories_table \u0026\u0026 staff.data.categories_table.find(item=\u003eitem.staff_categories.id == Context.data.staff_categories!.id)){\n            result.addMessage('Данная категория уже присвоена сотруднику')\n        }\n    }\n\n\n    return result\n}\n","clientScriptOptions":{"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{},"dataFieldCode":"context"},"dataNamespace":"kedo.staff","dataCode":"_process_category_assignment_workfow","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        async function onInit() {\n            Context.data.assignment_date = new TDate();\n            if (!!Context.data.bulk_edit) {\n                ViewContext.data.view_staff = false;\n            }\n            else {\n                ViewContext.data.view_staff = true;\n            }\n        }\n        async function category_change() {\n            if (Context.data.staff_categories) {\n                let app = await Context.data.staff_categories.fetch();\n                if (app.data.perpetual == false || undefined) {\n                    ViewContext.data.view_expiration_date = true;\n                }\n                else {\n                    ViewContext.data.view_expiration_date = false;\n                }\n                if (app.data.code == 'invalid_child') {\n                    ViewContext.data.view_invalid_child = true;\n                }\n                else {\n                    ViewContext.data.view_invalid_child = false;\n                }\n            }\n        }\n        async function validate() {\n            const result = new ValidationResult();\n            if (Context.data.staff \u0026\u0026 Context.data.staff_categories) {\n                let staff = await Context.data.staff.fetch();\n                if (staff.data.categories_table \u0026\u0026 staff.data.categories_table.find(item =\u003e item.staff_categories.id == Context.data.staff_categories.id)) {\n                    result.addMessage('Данная категория уже присвоена сотруднику');\n                }\n            }\n            return result;\n        }\n        return {\n            onInit,\n            category_change,\n            validate\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"onInit","parameters":[],"type":"[object Object]"},{"name":"category_change","parameters":[],"type":"[object Object]"},{"name":"validate","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-12-20T13:09:13.443232024Z","__createdBy":"7303b866-4220-4086-a09e-348a76b12c73","__updatedAt":"2024-02-14T11:08:36.103449877Z","__updatedBy":"7303b866-4220-4086-a09e-348a76b12c73","__deletedAt":null}
