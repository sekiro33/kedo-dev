{
  "__id": "018f0a74-f63b-7627-8073-9d892a1889f2",
  "namespace": "kedo.document_types",
  "code": "edit",
  "__name": "Форма редактирования",
  "description": "",
  "extensionZoneCode": "",
  "sort": 0,
  "category": "00000000-0000-0000-0000-000000000000",
  "version": 1,
  "hidden": false,
  "draft": false,
  "readonly": false,
  "descriptor": {
    "types": ["form"],
    "template": {
      "id": "521b1daf-1101-4aba-8c5c-d3be6f5b1bb8",
      "descriptor": "item-form-complex-popup",
      "descriptorVersion": 2,
      "values": {
        "systemFunctions": {
          "validate": {
            "kind": "Function",
            "name": "validation",
            "type": "client"
          }
        },
        "formGroup": {
          "path": ["item"]
        }
      },
      "content": {
        "[headerControls]": [],
        "[headerCustomization]": [],
        "[footer]": [
          {
            "id": "5abe56f6-be67-4644-8aac-51ea69713907",
            "descriptor": "zone-content",
            "values": {
              "zoneCode": "[footer]"
            }
          }
        ],
        "[content]": [
          {
            "id": "c18e9118-cda2-49f4-ae50-5414c9b970b2",
            "descriptor": "modal-body",
            "values": {
              "shadow": true
            },
            "content": {
              "": [
                {
                  "id": "3add636e-ba8f-4f6d-a497-c3921885524b",
                  "descriptor": "ext_7fe3de7d-f459-4f75-940c-271c6e9ea1ed@toastr_widget",
                  "descriptorVersion": 3,
                  "values": {
                    "__isConstValues": [],
                    "__renderContentOnDemand": false,
                    "__outlet": "",
                    "__styles": "width: 100%",
                    "__baseURL": "",
                    "__relativeURL": ""
                  }
                },
                {
                  "id": "7fe87b6f-803f-40af-ae04-2c46f1919292",
                  "descriptor": "app-navigation-crumbs-tree-widget",
                  "values": {
                    "form": {
                      "path": ["item"]
                    },
                    "item": {
                      "path": ["itemModel"]
                    },
                    "__readOnly": false,
                    "application": {
                      "path": ["application"]
                    }
                  }
                },
                {
                  "id": "94fc4670-4e51-4870-ae15-66266dac3ee6",
                  "descriptor": "dynamic-form-row",
                  "values": {
                    "__baseURL": "",
                    "__relativeURL": "",
                    "__isConstValues": [],
                    "__outlet": "",
                    "tooltip": null,
                    "required": true,
                    "hideEmpty": false,
                    "__readOnly": null,
                    "bindingMode": false,
                    "showDisplayName": true,
                    "__renderContentOnDemand": false,
                    "control": {
                      "path": ["item", "__name"]
                    }
                  }
                },
                {
                  "id": "52bd0bf2-7792-423e-960a-648bb7932686",
                  "descriptor": "dynamic-form-row",
                  "values": {
                    "__relativeURL": "",
                    "__isConstValues": [],
                    "showDisplayName": true,
                    "__renderContentOnDemand": false,
                    "__baseURL": "",
                    "hideEmpty": false,
                    "__outlet": "",
                    "required": true,
                    "__readOnly": null,
                    "bindingMode": false,
                    "control": {
                      "path": ["item", "doc_type_id_1c"]
                    },
                    "tooltip": null
                  }
                },
                {
                  "id": "c1130e6d-5690-466a-8457-3d8f1cf07617",
                  "descriptor": "code",
                  "values": {
                    "html": "\u003c!-- В зависимости от того, было выбрано приложение или нет, будем отображать текст \"Выбрать приложение\" --\u003e\n\u003c!-- или название выбранного приложения. Оба текста кликабельны и открывают модальное окно для выбора приложения. --\u003e\n\u003celma-form-row _ngcontent-pyy-c88=\"\" _nghost-pyy-c47=\"\" class=\"elma-form-row ng-untouched ng-pristine ng-valid\"\u003e\n    \u003celma-form-label _ngcontent-pyy-c47=\"\" _nghost-pyy-c46=\"\" class=\"elma-form-label\"\u003e\n        \u003cspan _ngcontent-pyy-c46=\"\" class=\"label-name\"\u003eДокумент ELMA365\u003c/span\u003e\n        \u003cspan _ngcontent-pyy-c46=\"\" class=\"required\"\u003e*\u003c/span\u003e\n    \u003c/elma-form-label\u003e\n    \u003celma-form-control _ngcontent-pyy-c47=\"\" _nghost-pyy-c45=\"\" class=\"elma-form-control text-base\"\u003e\n        \u003celma-type-string _nghost-pyy-c629=\"\"\u003e\n            \u003cdiv _ngcontent-pyy-c629=\"\" class=\"multiline-container\"\u003e\n                \u003c% if (!ViewContext.data.selected_element) { %\u003e\n                    \u003cp class=\"custom-p-link\" onclick=\"\u003c%- Scripts%\u003e.openModal()\"\u003eВыбрать приложение\u003c/p\u003e\n                \u003c% } else { %\u003e\n                    \u003cp class=\"custom-p-link\" onclick=\"\u003c%- Scripts%\u003e.openModal()\"\u003e\n                        \u003c%= ViewContext.data.selected_element.name %\u003e\n                    \u003c/p\u003e\n                \u003c% } %\u003e\n            \u003c/div\u003e\n        \u003c/elma-type-string\u003e\n    \u003c/elma-form-control\u003e\n\u003c/elma-form-row\u003e\n\n\u003cstyle\u003e\n    .custom-p-link {\n        cursor: pointer;\n        color: #1e6599;\n        margin: 0;\n    }\n\n    .disabled {\n        color: grey;\n        cursor: cursor;\n    }\n\n    .custom-p-link:hover {\n        cursor: pointer;\n        color: #1e6599;\n        text-decoration: underline;\n    }\n\u003c/style\u003e",
                    "hideContent": true,
                    "contentPlaceholder": "Селектор приложений (Виджет-код)"
                  }
                },
                {
                  "id": "56d0327e-c593-4c60-81cf-820c251f2401",
                  "descriptor": "complex-popup",
                  "values": {
                    "__isConstValues": [],
                    "visible": {
                      "path": ["show_modal_window"]
                    },
                    "__hidden": false,
                    "__outlet": "",
                    "__styles": "",
                    "modalSize": [
                      {
                        "code": "modal-md",
                        "name": "Средний"
                      }
                    ],
                    "__relativeURL": "",
                    "title": "Выбрать документ ELMA365",
                    "__baseURL": "",
                    "__classes": "",
                    "sidebarAvailable": false,
                    "__renderContentAsync": false,
                    "__renderContentOnDemand": false
                  },
                  "content": {
                    "[popup-footer]": [
                      {
                        "id": "48efe302-7312-4e71-aa4e-7dcb0fd9a035",
                        "descriptor": "row-layout",
                        "content": {
                          "": [
                            {
                              "id": "af279890-b7a7-4040-acce-5b9de9ded7f5",
                              "descriptor": "button",
                              "values": {
                                "action": null,
                                "processPopoverSize": [
                                  {
                                    "code": "default",
                                    "name": "shared.common.button@widget-process-popover-size-default",
                                    "translate": true
                                  }
                                ],
                                "createAppItemSettings": null,
                                "__renderContentOnDemand": false,
                                "__outlet": "",
                                "__baseURL": "",
                                "__relativeURL": "",
                                "__isConstValues": [],
                                "runProcessSettings": null,
                                "view": "primary",
                                "label": "Выбрать",
                                "onClick": {
                                  "kind": "Function",
                                  "name": "selectElement",
                                  "type": "client"
                                },
                                "runInPopover": null,
                                "runActionEnum": [
                                  {
                                    "code": "undefined",
                                    "name": "shared.common.button@widget-runAction-none",
                                    "translate": true
                                  }
                                ]
                              }
                            },
                            {
                              "id": "d9d72e2a-c0c3-4f39-b255-d16d3e368762",
                              "descriptor": "button",
                              "values": {
                                "runInPopover": null,
                                "__relativeURL": "",
                                "createAppItemSettings": null,
                                "label": "Отмена",
                                "action": null,
                                "onClick": {
                                  "kind": "Function",
                                  "name": "closeModal",
                                  "type": "client"
                                },
                                "view": "danger",
                                "__outlet": "",
                                "__baseURL": "",
                                "processPopoverSize": [
                                  {
                                    "code": "default",
                                    "name": "shared.common.button@widget-process-popover-size-default",
                                    "translate": true
                                  }
                                ],
                                "runProcessSettings": null,
                                "__renderContentOnDemand": false,
                                "runActionEnum": [
                                  {
                                    "code": "undefined",
                                    "name": "shared.common.button@widget-runAction-none",
                                    "translate": true
                                  }
                                ],
                                "__isConstValues": []
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "[popup-header]": [],
                    "[popup-content]": [
                      {
                        "id": "82c503c0-54b1-477a-b067-4dc5b4e9c9ef",
                        "descriptor": "modal-body",
                        "content": {
                          "": [
                            {
                              "id": "77340f35-4beb-44ca-8acf-bade31b723c0",
                              "descriptor": "kedo.document_types@solution_structure",
                              "descriptorVersion": 4,
                              "values": {
                                "selected_element": {
                                  "path": ["selected_element"]
                                },
                                "__renderContentOnDemand": false,
                                "__outlet": "",
                                "__styles": "width: 100%",
                                "__baseURL": "",
                                "__relativeURL": "",
                                "__isConstValues": []
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "[popup-sidebar]": [],
                    "[popup-controls]": [],
                    "[popup-upper-header]": []
                  }
                }
              ]
            }
          }
        ],
        "[sidebar]": [
          {
            "id": "662f08da-59da-4112-9ae1-763785ab8bf2",
            "descriptor": "sidebar-widget",
            "content": {
              "": [
                {
                  "id": "1556d7a7-eaa5-41a2-b262-82ec3b86e64d",
                  "descriptor": "user-guide"
                }
              ]
            }
          }
        ]
      }
    },
    "fields": [
      {
        "code": "selected_element",
        "type": "JSON",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Выбранный элемент",
          "data": {},
          "input": true,
          "output": true
        }
      },
      {
        "code": "show_modal_window",
        "type": "BOOLEAN",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": false,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Отобразить модальное окно?",
          "data": {
            "additionalType": "radio",
            "noValue": "Нет",
            "yesValue": "Да"
          },
          "input": true,
          "output": true
        }
      },
      {
        "code": "app_name",
        "type": "STRING",
        "searchable": false,
        "indexed": false,
        "deleted": false,
        "array": false,
        "required": false,
        "single": true,
        "defaultValue": null,
        "calcByFormula": false,
        "formula": "",
        "data": {},
        "view": {
          "name": "Название приложения",
          "data": {
            "additionalType": "string"
          },
          "input": true,
          "output": true
        }
      }
    ],
    "fieldVisibilityConditions": {
      "app_name": {
        "enabled": false,
        "conditions": []
      },
      "selected_element": {
        "enabled": false,
        "conditions": []
      },
      "show_modal_window": {
        "enabled": false,
        "conditions": []
      }
    },
    "scriptOptions": {},
    "clientScripts": "/* Client scripts module */\n\ndeclare const notify: any;\n\ninterface ISelectedElement {\n    namespace: string,\n    code: string,\n    name?: string,\n}\n\nfunction error(message: string): void {\n    notify({\n        message: message,\n        color: \"danger\",\n        timeout: 5000,\n    });\n}\n\nasync function onInit(): Promise\u003cvoid\u003e {\n    if (Context.data.app_namespace \u0026\u0026 Context.data.app_code) {\n        const selected_element: ISelectedElement = {\n            namespace: Context.data.app_namespace,\n            code: Context.data.app_code,\n        };\n\n        ViewContext.data.selected_element = selected_element;\n    }\n}\n\nasync function selectElement(): Promise\u003cvoid\u003e {\n    if (!ViewContext.data.selected_element) {\n        error(\"Документ не выбран\")\n        return;\n    }\n\n    /** Переменная ViewContext.data.selected_element связана с виджетом \"Структура решений\".\n     * При выборе приложения данное поле обновляется и туда записываются данные по выбранному приложенияю.\n     */\n    const selected_element: ISelectedElement = ViewContext.data.selected_element;\n\n    ViewContext.data.app_name = selected_element.name;\n    Context.data.app_code = selected_element.code;\n    Context.data.app_namespace = selected_element.namespace;\n\n    await closeModal();\n}\n\nasync function openModal(): Promise\u003cvoid\u003e {\n    ViewContext.data.show_modal_window = true;\n}\n\nasync function closeModal(): Promise\u003cvoid\u003e {\n    if (!Context.data.app_code) ViewContext.data.selected_element = undefined;\n    ViewContext.data.show_modal_window = false;\n}\n\nasync function validation(): Promise\u003cValidationResult\u003e {\n    const result = new ValidationResult();\n\n    if (!Context.data.app_code \u0026\u0026 !Context.data.app_namespace) {\n        result.addMessage(\"Укажите соответствующее виду документа приложение ELMA365\");\n    }\n\n    return result;\n}\n",
    "clientScriptOptions": {
      "allowServer": true
    },
    "serverScripts": "/* Server scripts module */\n",
    "serverScriptOptions": {},
    "widgetZones": [
      {
        "code": "[footer]"
      }
    ],
    "dataFieldCode": "item"
  },
  "dataNamespace": "kedo",
  "dataCode": "document_types",
  "runtime": {
    "version": 1,
    "clientScripts": "System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server, System) {\n        function error(message) {\n            notify({\n                message: message,\n                color: \"danger\",\n                timeout: 5000,\n            });\n        }\n        async function onInit() {\n            if (Context.data.app_namespace \u0026\u0026 Context.data.app_code) {\n                const selected_element = {\n                    namespace: Context.data.app_namespace,\n                    code: Context.data.app_code,\n                };\n                ViewContext.data.selected_element = selected_element;\n            }\n        }\n        async function selectElement() {\n            if (!ViewContext.data.selected_element) {\n                error(\"Документ не выбран\");\n                return;\n            }\n            const selected_element = ViewContext.data.selected_element;\n            ViewContext.data.app_name = selected_element.name;\n            Context.data.app_code = selected_element.code;\n            Context.data.app_namespace = selected_element.namespace;\n            await closeModal();\n        }\n        async function openModal() {\n            ViewContext.data.show_modal_window = true;\n        }\n        async function closeModal() {\n            if (!Context.data.app_code)\n                ViewContext.data.selected_element = undefined;\n            ViewContext.data.show_modal_window = false;\n        }\n        async function validation() {\n            const result = new ValidationResult();\n            if (!Context.data.app_code \u0026\u0026 !Context.data.app_namespace) {\n                result.addMessage(\"Укажите соответствующее виду документа приложение ELMA365\");\n            }\n            return result;\n        }\n        return {\n            error,\n            onInit,\n            selectElement,\n            openModal,\n            closeModal,\n            validation\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n",
    "clientFnDeclarations": [
      {
        "name": "error",
        "parameters": [
          {
            "name": "[object Object]",
            "type": "[object Object]"
          }
        ],
        "type": "[object Object]"
      },
      {
        "name": "onInit",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "selectElement",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "openModal",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "closeModal",
        "parameters": [],
        "type": "[object Object]"
      },
      {
        "name": "validation",
        "parameters": [],
        "type": "[object Object]"
      }
    ],
    "clientDependencies": {
      "applications": [],
      "collections": [],
      "pages": []
    }
  },
  "__createdAt": "2024-04-23T10:16:28.473466211Z",
  "__createdBy": "099fd2a1-8125-406b-aaff-0db06d81aa40",
  "__updatedAt": "2024-04-23T10:16:28.473466211Z",
  "__updatedBy": "099fd2a1-8125-406b-aaff-0db06d81aa40",
  "__deletedAt": null
}
