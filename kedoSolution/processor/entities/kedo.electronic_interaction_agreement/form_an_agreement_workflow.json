{
  "__id": "018c8757-193c-7ec1-b20a-90e8e1be4016",
  "namespace": "kedo.electronic_interaction_agreement",
  "code": "form_an_agreement_workflow",
  "category": "00000000-0000-0000-0000-000000000000",
  "__name": "Запуск формирований соглашений об ЭВ",
  "type": "bpmn",
  "draft": false,
  "version": 3,
  "context": [
    {
      "code": "electronic_interaction_agreement",
      "type": "SYS_COLLECTION",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": true,
      "required": false,
      "single": true,
      "defaultValue": null,
      "calcByFormula": false,
      "formula": "",
      "data": {
        "code": "electronic_interaction_agreement",
        "filter": null,
        "bindings": null,
        "namespace": "kedo",
        "isDependent": false,
        "linkedFieldCode": ""
      },
      "view": {
        "name": "Соглашение об ЭВ"
      }
    },
    {
      "code": "staffs",
      "type": "SYS_COLLECTION",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": true,
      "required": false,
      "single": false,
      "defaultValue": null,
      "calcByFormula": false,
      "formula": "",
      "data": {
        "code": "staff",
        "filter": {
          "value": {
            "tf": {}
          },
          "enabled": false
        },
        "bindings": null,
        "namespace": "kedo",
        "isDependent": false,
        "linkedFieldCode": ""
      },
      "view": {
        "name": "Сотрудники",
        "data": {}
      }
    },
    {
      "code": "staff_kedo",
      "type": "SYS_COLLECTION",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": true,
      "required": false,
      "single": true,
      "defaultValue": null,
      "calcByFormula": false,
      "formula": "",
      "data": {
        "code": "staff",
        "filter": {
          "value": {
            "tf": {}
          },
          "enabled": false
        },
        "bindings": null,
        "namespace": "kedo",
        "isDependent": false,
        "linkedFieldCode": ""
      },
      "view": {
        "name": "Сотрудник",
        "data": {}
      }
    },
    {
      "code": "counter",
      "type": "FLOAT",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": false,
      "required": false,
      "single": true,
      "defaultValue": null,
      "calcByFormula": false,
      "formula": "",
      "data": {},
      "view": {
        "name": "Счетчик",
        "data": {
          "additionalType": "integer",
          "showRowSeparator": true
        }
      }
    },
    {
      "code": "is_director",
      "type": "BOOLEAN",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": false,
      "required": false,
      "single": true,
      "defaultValue": false,
      "calcByFormula": false,
      "formula": "",
      "data": {},
      "view": {
        "name": "Это директор?",
        "data": {
          "additionalType": "radio",
          "noValue": "Нет",
          "yesValue": "Да"
        }
      }
    },
    {
      "code": "mass_launch",
      "type": "BOOLEAN",
      "searchable": false,
      "indexed": false,
      "deleted": false,
      "array": false,
      "required": false,
      "single": true,
      "defaultValue": null,
      "calcByFormula": false,
      "formula": "",
      "data": {},
      "view": {
        "name": "Массовый запуск?",
        "data": {
          "additionalType": "radio",
          "noValue": "Нет",
          "yesValue": "Да"
        }
      }
    }
  ],
  "manualRun": false,
  "readonly": false,
  "__createdAt": "2023-07-03T13:05:49.065986887Z",
  "__createdBy": "6c362877-9ef9-45f4-aa6f-e5e126ee96c0",
  "__updatedAt": "2023-09-11T06:02:47.289081929Z",
  "__updatedBy": "7303b866-4220-4086-a09e-348a76b12c73",
  "process": {
    "items": {
      "00000000-0000-0000-0000-000000000000": {
        "x": 104,
        "y": 72,
        "id": "00000000-0000-0000-0000-000000000000",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "type": "start",
        "color": "#ffffff",
        "exits": ["ddfdebbe-306e-451f-8ca5-2435a4856543"],
        "width": 32,
        "height": 32,
        "settings": {
          "formFields": [
            {
              "code": "__name",
              "display": "Название",
              "tooltip": "Название экземпляра процесса, будет показываться в задачах",
              "readonly": false,
              "required": true
            }
          ],
          "instruction": "",
          "notifyMessage": "Запущен процесс",
          "titleTemplate": "Запуск формирований соглашений об ЭВ ({$electronic_interaction_agreement})",
          "titleGenerateMethod": "template"
        }
      },
      "0e2a4bbc-bde6-4e7c-93be-34a835f1fee9": {
        "x": 256,
        "y": 248,
        "id": "0e2a4bbc-bde6-4e7c-93be-34a835f1fee9",
        "icon": "end",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "",
        "type": "end",
        "color": "#ffffff",
        "exits": [],
        "width": 32,
        "height": 32,
        "settings": {
          "actions": [],
          "isModal": false,
          "actionType": "nothing",
          "messageText": "",
          "redirectUrl": ""
        }
      },
      "19f5ed20-c867-4abf-bd93-1866f77e3604": {
        "x": 104,
        "y": 328,
        "id": "19f5ed20-c867-4abf-bd93-1866f77e3604",
        "icon": "exclusive",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "",
        "type": "gateway",
        "color": "#ffffff",
        "exits": [
          "db2f6a41-3720-4a2f-bde1-7356a7f1251b",
          "6e80b22b-991e-4d4a-97c2-0c87a0942829"
        ],
        "width": 32,
        "height": 32,
        "settings": {
          "func": "",
          "type": "exclusive",
          "useFunc": false,
          "funcType": "STRING",
          "description": ""
        }
      },
      "1e8eb912-1fb0-4556-837a-a40ab73de0a8": {
        "x": 240,
        "y": 400,
        "id": "1e8eb912-1fb0-4556-837a-a40ab73de0a8",
        "icon": "script",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "Обнулить счетчик",
        "type": "script",
        "color": "#fde9a0",
        "exits": ["54cf3281-70b3-4203-9c60-08ce8f313a2c"],
        "width": 80,
        "height": 64,
        "settings": {
          "func": "setStartData",
          "count": 1,
          "delay": 5,
          "retry": true,
          "escalation": {
            "byError": {
              "notify": false,
              "interrupt": false,
              "receivers": []
            }
          }
        }
      },
      "8d57084e-7470-4249-8bd1-3c288027a57c": {
        "x": 80,
        "y": 152,
        "id": "8d57084e-7470-4249-8bd1-3c288027a57c",
        "icon": "script",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "Заполнить стартовые параметры",
        "type": "script",
        "color": "#fde9a0",
        "exits": ["0d3d3e9b-c8a4-422c-8ff7-72590726157e"],
        "width": 80,
        "height": 64,
        "settings": {
          "func": "setStartData",
          "count": 1,
          "delay": 5,
          "retry": true,
          "escalation": {
            "byError": {
              "notify": false,
              "interrupt": false,
              "receivers": []
            }
          }
        }
      },
      "98daba61-fad7-430f-ada9-97727b521c9a": {
        "x": 264,
        "y": 328,
        "id": "98daba61-fad7-430f-ada9-97727b521c9a",
        "icon": "timer",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "2 мин",
        "type": "event",
        "color": "#ffffff",
        "exits": ["ad7f927a-942d-4630-8aff-8a8c177b8259"],
        "width": 32,
        "height": 32,
        "settings": {
          "kind": "timer",
          "timer": {
            "days": 0,
            "kind": "duration",
            "hours": 0,
            "minutes": 2,
            "absolute": true
          }
        }
      },
      "a665db15-5c4d-42fd-8bc6-328bb1141c40": {
        "x": 80,
        "y": 400,
        "id": "a665db15-5c4d-42fd-8bc6-328bb1141c40",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "Генерация соглашения об ЭВ",
        "type": "call",
        "color": "#ffffff",
        "exits": ["158bc624-1f24-444d-83de-b94b006f9ecd"],
        "width": 80,
        "height": 64,
        "settings": {
          "code": "agreement_generation",
          "async": true,
          "input": [
            {
              "source": {
                "kind": "context",
                "value": "staff_kedo"
              },
              "target": {
                "kind": "context",
                "value": "employee"
              }
            },
            {
              "source": {
                "kind": "context",
                "value": "__createdBy"
              },
              "target": {
                "kind": "context",
                "value": "__createdBy"
              }
            },
            {
              "source": {
                "kind": "manual",
                "value": false
              },
              "target": {
                "kind": "context",
                "value": "personal_data_employee"
              }
            },
            {
              "source": {
                "kind": "manual",
                "value": true
              },
              "target": {
                "kind": "context",
                "value": "mass_launch"
              }
            },
            {
              "source": {
                "kind": "context",
                "value": "is_director"
              },
              "target": {
                "kind": "context",
                "value": "is_director"
              }
            }
          ],
          "output": [],
          "namespace": "kedo.staff",
          "subProcessTargetFieldCode": ""
        }
      },
      "ccccaac2-9875-4c15-ba7e-a230d653e844": {
        "x": 104,
        "y": 248,
        "id": "ccccaac2-9875-4c15-ba7e-a230d653e844",
        "icon": "exclusive",
        "lane": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "",
        "type": "gateway",
        "color": "#ffffff",
        "exits": [
          "c17aa036-051e-430e-9cc2-15dcdbec13a9",
          "9385830d-845f-4fbc-bce0-192d2aff182d"
        ],
        "width": 32,
        "height": 32,
        "settings": {
          "func": "prepare_staffs",
          "type": "exclusive",
          "useFunc": true,
          "funcType": "BOOLEAN",
          "description": ""
        }
      }
    },
    "lanes": {
      "46a57d88-13bf-415a-b4f9-09cae30970af": {
        "x": 8,
        "y": 8,
        "id": "46a57d88-13bf-415a-b4f9-09cae30970af",
        "name": "Инициатор",
        "color": "#d6f0cc",
        "width": 376,
        "height": 600,
        "settings": {
          "type": "dynamic",
          "variable": "__createdBy",
          "permissionExtend": {
            "kind": "simple"
          }
        },
        "direction": "vertical",
        "multiInstance": false
      }
    },
    "paper": {
      "format": "A4",
      "orientation": "landscape"
    },
    "transitions": {
      "0d3d3e9b-c8a4-422c-8ff7-72590726157e": {
        "id": "0d3d3e9b-c8a4-422c-8ff7-72590726157e",
        "name": "",
        "path": [
          {
            "x": 120,
            "y": 216
          },
          {
            "x": 120,
            "y": 248
          }
        ],
        "type": "plain",
        "source": "8d57084e-7470-4249-8bd1-3c288027a57c",
        "target": "ccccaac2-9875-4c15-ba7e-a230d653e844",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "158bc624-1f24-444d-83de-b94b006f9ecd": {
        "id": "158bc624-1f24-444d-83de-b94b006f9ecd",
        "name": "",
        "path": [
          {
            "x": 80,
            "y": 432
          },
          {
            "x": 48,
            "y": 432
          },
          {
            "x": 48,
            "y": 264
          },
          {
            "x": 104,
            "y": 264
          }
        ],
        "type": "plain",
        "source": "a665db15-5c4d-42fd-8bc6-328bb1141c40",
        "target": "ccccaac2-9875-4c15-ba7e-a230d653e844",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "54cf3281-70b3-4203-9c60-08ce8f313a2c": {
        "id": "54cf3281-70b3-4203-9c60-08ce8f313a2c",
        "name": "",
        "path": [
          {
            "x": 240,
            "y": 432
          },
          {
            "x": 160,
            "y": 432
          }
        ],
        "type": "plain",
        "source": "1e8eb912-1fb0-4556-837a-a40ab73de0a8",
        "target": "a665db15-5c4d-42fd-8bc6-328bb1141c40",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "6e80b22b-991e-4d4a-97c2-0c87a0942829": {
        "id": "6e80b22b-991e-4d4a-97c2-0c87a0942829",
        "name": "Счетчик \u003c 90",
        "path": [
          {
            "x": 120,
            "y": 360
          },
          {
            "x": 120,
            "y": 400
          }
        ],
        "type": "default",
        "source": "19f5ed20-c867-4abf-bd93-1866f77e3604",
        "target": "a665db15-5c4d-42fd-8bc6-328bb1141c40",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "9385830d-845f-4fbc-bce0-192d2aff182d": {
        "id": "9385830d-845f-4fbc-bce0-192d2aff182d",
        "name": "Кол-во сотрудников \u003e 0",
        "path": [
          {
            "x": 120,
            "y": 280
          },
          {
            "x": 120,
            "y": 328
          }
        ],
        "type": "default",
        "source": "ccccaac2-9875-4c15-ba7e-a230d653e844",
        "target": "19f5ed20-c867-4abf-bd93-1866f77e3604",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "ad7f927a-942d-4630-8aff-8a8c177b8259": {
        "id": "ad7f927a-942d-4630-8aff-8a8c177b8259",
        "name": "",
        "path": [
          {
            "x": 280,
            "y": 360
          },
          {
            "x": 280,
            "y": 400
          }
        ],
        "type": "plain",
        "source": "98daba61-fad7-430f-ada9-97727b521c9a",
        "target": "1e8eb912-1fb0-4556-837a-a40ab73de0a8",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "c17aa036-051e-430e-9cc2-15dcdbec13a9": {
        "id": "c17aa036-051e-430e-9cc2-15dcdbec13a9",
        "name": "Кол-во сотрудников = 0",
        "path": [
          {
            "x": 136,
            "y": 264
          },
          {
            "x": 256,
            "y": 264
          }
        ],
        "type": "plain",
        "source": "ccccaac2-9875-4c15-ba7e-a230d653e844",
        "target": "0e2a4bbc-bde6-4e7c-93be-34a835f1fee9",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [
            {
              "a": {
                "kind": "context",
                "value": "__service"
              },
              "b": {
                "kind": "manual",
                "value": false
              },
              "type": "BOOLEAN",
              "inversion": false,
              "operation": {
                "relation": "equal",
                "inversion": false,
                "caseInsensitive": false
              },
              "conjunction": false
            }
          ],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "db2f6a41-3720-4a2f-bde1-7356a7f1251b": {
        "id": "db2f6a41-3720-4a2f-bde1-7356a7f1251b",
        "name": "Счетчик \u003e= 90",
        "path": [
          {
            "x": 136,
            "y": 344
          },
          {
            "x": 264,
            "y": 344
          }
        ],
        "type": "plain",
        "source": "19f5ed20-c867-4abf-bd93-1866f77e3604",
        "target": "98daba61-fad7-430f-ada9-97727b521c9a",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [
            {
              "a": {
                "kind": "context",
                "value": "counter"
              },
              "b": {
                "kind": "manual",
                "value": 90
              },
              "type": "FLOAT",
              "inversion": false,
              "operation": {
                "relation": "less",
                "inversion": true,
                "caseInsensitive": false
              },
              "conjunction": false
            }
          ],
          "descritpion": ""
        },
        "nameShift": 0
      },
      "ddfdebbe-306e-451f-8ca5-2435a4856543": {
        "id": "ddfdebbe-306e-451f-8ca5-2435a4856543",
        "name": "Сформировать соглашение об ЭВ",
        "path": [
          {
            "x": 120,
            "y": 104
          },
          {
            "x": 120,
            "y": 152
          }
        ],
        "type": "plain",
        "source": "00000000-0000-0000-0000-000000000000",
        "target": "8d57084e-7470-4249-8bd1-3c288027a57c",
        "settings": {
          "exit": {
            "confirm": "none",
            "interrupt": false,
            "skipCheck": false,
            "formFields": [],
            "buttonClass": "default",
            "confirmText": "",
            "popoverSize": "md",
            "formDescription": ""
          },
          "conditions": [],
          "descritpion": ""
        },
        "nameShift": 0
      }
    }
  },
  "scripts": "/**\nHere you can write scripts for complex server processing of the context during process execution.\nTo write scripts, use TypeScript (https://www.typescriptlang.org).\nELMA365 SDK documentation available on https://tssdk.elma365.com.\n**/\nasync function prepare_staffs(): Promise\u003cboolean\u003e {\n    if (Context.data.staffs \u0026\u0026 Context.data.staffs.length \u003e 0) {\n        Context.data.staff_kedo = Context.data.staffs.pop();\n        Context.data.counter! += 1;\n        return true\n    } else {\n        return false\n    }\n}\nasync function setStartData(): Promise\u003cvoid\u003e {\n    Context.data.counter = 0;\n}\n\n",
  "forms": [],
  "settings": {
    "logged": true,
    "targetFeed": {
      "type": "object",
      "variable": "electronic_interaction_agreement"
    },
    "allowGlobal": false,
    "instanceCard": {
      "allFields": true,
      "formFields": []
    },
    "notifyOnStart": true,
    "allowNamespace": false,
    "applicationContext": false,
    "fieldVisibilityConditions": {
      "staffs": {
        "enabled": false,
        "conditions": []
      },
      "counter": {
        "enabled": false,
        "conditions": []
      },
      "staff_kedo": {
        "enabled": false,
        "conditions": []
      },
      "is_director": {
        "enabled": false,
        "conditions": []
      },
      "mass_launch": {
        "enabled": false,
        "conditions": []
      }
    }
  },
  "hideInList": false,
  "applicationLink": false,
  "__deletedAt": null
}
