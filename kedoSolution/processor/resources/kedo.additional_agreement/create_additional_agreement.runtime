{"scripts":"async function getBossPosition() {\n    if (Context.data.boss) {\n        const headApp = await Context.fields.staff.app.search()\n            .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(Context.data.boss)))\n            .first();\n        Context.data.boss_position = headApp.data.position;\n    }\n}\nasync function createStatusObj(app, status) {\n    const obj_status = {\n        'app': {\n            'namespace': app.namespace,\n            'code': app.code,\n            'id': app.id,\n        },\n        'status': status,\n    };\n    Context.data.kedo_status = JSON.stringify(obj_status);\n}\nasync function createStatusChiefOrderSigning() {\n    createStatusObj(Context.data.additional_agreement, 'chief_order_signing');\n}\nasync function createStatusAppChiefOrderSigning() {\n    createStatusObj(Context.data.staff_personal_data, 'chief_doc_signing');\n}\nasync function setDocName() {\n    if (Context.data.file) {\n        const doc_name = await Context.data.file.fetch();\n        Context.data.file_name = doc_name.data.__name.replace('.docx', '');\n    }\n}\nasync function getEmploymentContract() {\n    if (!Context.data.staff_personal_data) {\n        throw new Error(\"Context.data.staff_personal_data is undefined\");\n    }\n    const staff_app = await Context.data.staff_personal_data.fetch();\n    if (staff_app.data.full_name) {\n        Context.data.full_name_string = staff_app.data.full_name.lastname + \" \" + staff_app.data.full_name.firstname + \" \" + staff_app.data.full_name.middlename;\n    }\n    else {\n        Context.data.full_name_string = \"\";\n    }\n}\nasync function processingTable() {\n    if (Context.data.info_additional_table) {\n        Context.data.count_type_employment = Context.data.info_additional_table.length;\n    }\n}\nasync function processingRows() {\n    if (Context.data.info_additional_table) {\n        const row = Context.data.info_additional_table[Context.data.count_type_employment - 1];\n        Context.data.organization_employee = row.organization_employee;\n        Context.data.agreement_number = row.number;\n        Context.data.agreement_date = row.agreement_date;\n        Context.data.number_labor_contract = row.employment_contract_number;\n        Context.data.date_labor_contract = row.date_employment_contract;\n        Context.data.count_type_employment--;\n        if (Context.data.count_type_employment == 0) {\n            Context.data.isEmployeeProcessed = true;\n        }\n        else {\n            Context.data.isEmployeeProcessed = false;\n        }\n    }\n}\nasync function processingTableDocuments() {\n    if (Context.data.documents_table) {\n        Context.data.count_row_table = Context.data.documents_table.length;\n    }\n}\nasync function processingRowsDocumentsTable() {\n    if (Context.data.documents_table) {\n        const row = Context.data.documents_table[Context.data.count_row_table - 1];\n        Context.data.organization_employee = row.organization_employee;\n        Context.data.number_labor_contract = row.employment_contract_number;\n        Context.data.date_labor_contract = row.date_employment_contract;\n        Context.data.signatory_table_app = row.responsible;\n        const signatory = await row.responsible.fetch();\n        Context.data.signatory_table = signatory.data.ext_user;\n        Context.data.need_choise_signatory = false;\n        if (!row.file) {\n            Context.data.need_create_file = true;\n            Context.data.count_row_table--;\n            if (Context.data.count_row_table == 0) {\n                Context.data.isEmployeeProcessed = true;\n            }\n            else {\n                Context.data.isEmployeeProcessed = false;\n            }\n            return;\n        }\n        Context.data.file = row.file;\n        Context.data.count_row_table--;\n        if (Context.data.count_row_table == 0) {\n            Context.data.isEmployeeProcessed = true;\n        }\n        else {\n            Context.data.isEmployeeProcessed = false;\n        }\n    }\n}\n","gatewayPairs":{},"hasTranslations":false}
