{"scripts":"async function get_labor_number() {\n    let staff = await Context.data.staff.fetch();\n    let doc = await Context.fields.labor_contract.app.search().where(f =\u003e f.staff.link(staff)).first();\n    if (!doc)\n        return;\n    Context.data.labor_contract = doc;\n}\nasync function getPositions() {\n    if (Context.data.boss) {\n        const headApp = await Context.fields.staff.app.search()\n            .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(Context.data.boss)))\n            .first();\n        Context.data.boss_position = headApp.data.position;\n    }\n    if (Context.data.responsible_accouting_user) {\n        const headApp = await Context.fields.staff.app.search()\n            .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(Context.data.responsible_accouting_user)))\n            .first();\n        Context.data.responsible_accounting = headApp;\n    }\n    if (Context.data.responsible_hr_dep_user) {\n        const headApp = await Context.fields.staff.app.search()\n            .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(Context.data.responsible_hr_dep_user)))\n            .first();\n        Context.data.responsible_hr_dep = headApp;\n    }\n}\nasync function getEmploymentContract() {\n    if (!Context.data.staff_personal_data) {\n        throw new Error(\"Context.data.staff_personal_data is undefined\");\n    }\n    const staff_app = await Context.data.staff_personal_data.fetch();\n    if (staff_app.data.full_name) {\n        Context.data.full_name_string = staff_app.data.full_name.lastname + \" \" + staff_app.data.full_name.firstname + \" \" + staff_app.data.full_name.middlename;\n    }\n    else {\n        Context.data.full_name_string = \"\";\n    }\n}\nasync function setDocName() {\n    if (Context.data.file) {\n        const doc_name = await Context.data.file.fetch();\n        Context.data.file_name = doc_name.data.__name;\n    }\n}\nasync function processingTableDocuments() {\n    if (Context.data.order_table) {\n        Context.data.count_row_table = Context.data.order_table.length;\n        const row = Context.data.order_table[Context.data.count_row_table - 1];\n        Context.data.organization_employee = row.organization_employee;\n        const signatory = await row.responsible.fetch();\n        Context.data.signatory.push(signatory.data.ext_user);\n        if (row.file) {\n            Context.data.need_create_file = true;\n            Context.data.need_number = false;\n            Context.data.file = row.file;\n        }\n        else {\n            Context.data.need_number = true;\n        }\n    }\n}\nasync function processingOrganization() {\n    if (Context.data.isExternalApp == true \u0026\u0026 Context.data.place_employment) {\n        const place_employment = await Context.data.place_employment.fetch();\n        Context.data.organization_employee = place_employment.data.organization;\n    }\n    else {\n        const staff = await Context.data.staff.fetch();\n        Context.data.organization_employee = staff.data.organization;\n    }\n}\n","gatewayPairs":{},"hasTranslations":false}
