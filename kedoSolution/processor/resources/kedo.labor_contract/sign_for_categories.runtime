{"scripts":"async function get_labor_number() {\n    let staff = await Context.data.staff.fetch();\n    let doc = await Context.fields.labor_contract.app.search().where(f =\u003e f.staff.link(staff)).first();\n    if (!doc)\n        return;\n    Context.data.labor_contract = doc;\n    await status_set();\n    await set_status_signing();\n}\nasync function fileds_set() {\n    let app = await Context.data.additional_agreement_to_the_contract.fetch();\n    app.data.__file = Context.data.file;\n    app.data.line_file_name = (await Context.data.file.fetch()).data.__name;\n    app.data.staff = Context.data.staff;\n    await app.save();\n    await status_set();\n}\nasync function status_set() {\n    let app = await Context.data.additional_agreement_to_the_contract.fetch();\n    app.data.line_status = `${app.data.__status.code};${app.data.__status.name}`;\n    await app.save();\n}\nasync function set_status(app, status) {\n    await app.setStatus(status);\n}\nasync function set_status_signed() {\n    let app = await Context.data.additional_agreement_to_the_contract.fetch();\n    await set_status(app, app.fields.__status.variants.signed);\n}\nasync function set_status_rejected() {\n    let app = await Context.data.additional_agreement_to_the_contract.fetch();\n    await set_status(app, app.fields.__status.variants.removed);\n}\nasync function set_status_signing() {\n    let app = await Context.data.additional_agreement_to_the_contract.fetch();\n    await set_status(app, app.fields.__status.variants.signed);\n}\nasync function getBossPosition() {\n    var _a, _b;\n    const staff = await ((_a = Context.data.staff) === null || _a === void 0 ? void 0 : _a.fetch());\n    const organization_staff = await ((_b = staff === null || staff === void 0 ? void 0 : staff.data.organization) === null || _b === void 0 ? void 0 : _b.fetch());\n    Context.data.signers_app = organization_staff === null || organization_staff === void 0 ? void 0 : organization_staff.data.signatories;\n    if (Context.data.boss) {\n        const headApp = await Context.fields.staff.app.search()\n            .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.ext_user.eq(Context.data.boss)))\n            .first();\n        Context.data.boss_position = headApp.data.position;\n    }\n}\nasync function createStatusObj(app, status) {\n    const obj_status = {\n        'app': {\n            'namespace': app.namespace,\n            'code': app.code,\n            'id': app.id,\n        },\n        'status': status,\n    };\n    Context.data.kedo_status = JSON.stringify(obj_status);\n}\nasync function createStatusCategoryChiefOrderSigning() {\n    createStatusObj(Context.data.additional_agreement_to_the_contract, 'chief_order_signing');\n}\nasync function createStatusCategoryStaffOrderSigning() {\n    createStatusObj(Context.data.additional_agreement_to_the_contract, 'staff_order_signing');\n}\nasync function createStatusCategoryCancelled() {\n    createStatusObj(Context.data.additional_agreement_to_the_contract, 'cancelled');\n}\nasync function createStatusCategorySigned() {\n    createStatusObj(Context.data.additional_agreement_to_the_contract, 'signed');\n}\nasync function createStatusAppChiefDocSigning() {\n    createStatusObj(Context.data.staff_personal_data, 'chief_doc_signing');\n}\nasync function createStatusAppStaffDocSigning() {\n    createStatusObj(Context.data.staff_personal_data, 'staff_doc_signing');\n}\nasync function createStatusAppOrderSigned() {\n    createStatusObj(Context.data.staff_personal_data, 'order_signed');\n}\nasync function getSigners() {\n    var _a, _b;\n    const kedo_settings = await Context.fields.kedo_settings.app.search()\n        .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.code.eq('head_signing_notification')))\n        .first();\n    Context.data.head_signing_notification = kedo_settings ? kedo_settings.data.status : false;\n    const staff = await ((_a = Context.data.staff) === null || _a === void 0 ? void 0 : _a.fetch());\n    const organization_staff = await ((_b = staff === null || staff === void 0 ? void 0 : staff.data.organization) === null || _b === void 0 ? void 0 : _b.fetch());\n    Context.data.signers_app = organization_staff === null || organization_staff === void 0 ? void 0 : organization_staff.data.signatories;\n}\n","gatewayPairs":{},"hasTranslations":false}
