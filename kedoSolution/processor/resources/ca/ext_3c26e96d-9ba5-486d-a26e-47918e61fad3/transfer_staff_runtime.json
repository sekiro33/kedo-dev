{
  "scripts": "async function action() {\n    if (!Context.data.transfer_staff_data) {\n        throw new Error(\"Context.data.transfer_staff_data is undefined\");\n    }\n    const current_date = new Datetime();\n    const transfer = JSON.parse(Context.data.transfer_staff_data);\n    const body = {\n        \"Date\": current_date.format(\"YYYY-MM-DDT00:00:00\"),\n        \"Организация_Key\": transfer.staff.organization_id,\n        \"Сотрудник_Key\": transfer.staff.id_1c,\n        \"ФизическоеЛицо_Key\": transfer.staff.individual_id_1c,\n        \"ДатаНачала\": transfer.start_date,\n        \"ВидЗанятости\": \"ОсновноеМестоРаботы\",\n        \"КоличествоСтавок\": 1,\n        \"ВидДоговора\": \"ТрудовойДоговор\",\n        \"КоэффициентИндексации\": 1,\n        \"ДатаЗапрета\": transfer.start_date,\n        \"НаименованиеДокумента\": \"Приказ\",\n        \"ПричинаПеревода\": transfer.reason,\n        \"ОснованиеПеревода\": transfer.base,\n        \"ИзменитьСведенияОДоговореКонтракте\": true,\n        \"Комментарий\": transfer.comment,\n    };\n    if (transfer.work_place) {\n        body[\"ИзменитьРабочееМесто\"] = true;\n        body[\"РабочееМесто_Key\"] = transfer.work_place;\n    }\n    if (transfer.remote_work) {\n        body[\"РаботаетДистанционно\"] = transfer.remote_work;\n        body[\"ИзменитьДистанционнуюРаботу\"] = true;\n    }\n    if (transfer.position_id && transfer.subdivison_id) {\n        body[\"Должность_Key\"] = transfer.position_id;\n        body[\"Подразделение_Key\"] = transfer.subdivison_id;\n        body[\"ИзменитьПодразделениеИДолжность\"] = true;\n    }\n    if (transfer.work_schedule_id) {\n        body[\"ГрафикРаботы_Key\"] = transfer.work_schedule_id;\n        body[\"ИзменитьГрафикРаботы\"] = true;\n    }\n    if (transfer.end_date) {\n        body[\"ДатаОкончания\"] = transfer.end_date;\n    }\n    const accounting1c = Namespace.params.fields.integration_app.app.fields.accounting_systems.variants.zup_1c;\n    const integration_app = Namespace.params.fields.integration_app.app.create();\n    integration_app.data.__name = `Кадровый перевод (${transfer.staff.name})`;\n    integration_app.data.document_odata_name = \"Document_КадровыйПеревод\";\n    integration_app.data.accounting_systems = accounting1c;\n    integration_app.data.personal_guid_1c = JSON.stringify([transfer.staff.individual_id_1c]);\n    integration_app.data.document_creation_data = JSON.stringify(body);\n    integration_app.data.additional_info = Context.data.additional_info;\n    integration_app.data.base_1c_name = Context.data.connection_name;\n    await integration_app.save();\n    Context.data.integration_app = integration_app;\n}\n(async function () {\n    action();\n});\n",
  "execution": [
    {
      "code": "sync",
      "name": "Синхронное"
    }
  ],
  "allowGlobal": false,
  "checkInterval": ""
}
