{"scripts":"const StaffStatuses = Namespace.app.staff.fields.__status.variants;\nasync function getGroupMembers() {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    if (!Context.data.organization) {\n        throw new Error(\"Не указана организация\");\n    }\n    const organization = await Context.data.organization.fetch();\n    const position_head = await ((_a = organization.data.position_head) === null || _a === void 0 ? void 0 : _a.fetch());\n    const head_staffs = [\n        ...((_b = position_head === null || position_head === void 0 ? void 0 : position_head.data.staff) !== null \u0026\u0026 _b !== void 0 ? _b : []),\n        ...((_c = position_head === null || position_head === void 0 ? void 0 : position_head.data.staff_internal_combination) !== null \u0026\u0026 _c !== void 0 ? _c : []),\n        ...((_d = position_head === null || position_head === void 0 ? void 0 : position_head.data.staff_external_combination) !== null \u0026\u0026 _d !== void 0 ? _d : [])\n    ];\n    const staff_ids = [\n        ...((_e = organization.data.hr_department) !== null \u0026\u0026 _e !== void 0 ? _e : []),\n        ...((_f = organization.data.accounting) !== null \u0026\u0026 _f !== void 0 ? _f : []),\n        ...((_g = organization.data.signatories) !== null \u0026\u0026 _g !== void 0 ? _g : []),\n        ...((_h = organization.data.office_managers) !== null \u0026\u0026 _h !== void 0 ? _h : []),\n        ...((_j = organization.data.matching_finance) !== null \u0026\u0026 _j !== void 0 ? _j : []),\n        ...head_staffs,\n    ].map(s =\u003e s.id);\n    const staffs = await Namespace.app.staff.search()\n        .where((f, g) =\u003e g.and(f.__deletedAt.eq(null), f.__id.in(staff_ids), f.__status.eq(StaffStatuses.signed_documents), f.ext_user.neq(null)))\n        .size(staff_ids.length)\n        .all();\n    if (organization.data.hr_department \u0026\u0026 organization.data.hr_department.length \u003e 0) {\n        Context.data.hr_dep = staffs\n            .filter(s =\u003e { var _a; return ((_a = organization.data.hr_department) !== null \u0026\u0026 _a !== void 0 ? _a : []).findIndex(hr =\u003e hr.id === s.id) !== -1; })\n            .map(s =\u003e s.data.ext_user);\n    }\n    if (organization.data.accounting \u0026\u0026 organization.data.accounting.length \u003e 0) {\n        Context.data.accounting = staffs\n            .filter(s =\u003e { var _a; return ((_a = organization.data.accounting) !== null \u0026\u0026 _a !== void 0 ? _a : []).findIndex(account =\u003e account.id === s.id) !== -1; })\n            .map(s =\u003e s.data.ext_user);\n    }\n    if (organization.data.signatories \u0026\u0026 organization.data.signatories.length \u003e 0) {\n        Context.data.signatories = staffs\n            .filter(s =\u003e { var _a; return ((_a = organization.data.signatories) !== null \u0026\u0026 _a !== void 0 ? _a : []).findIndex(signatory =\u003e signatory.id === s.id) !== -1; })\n            .map(s =\u003e s.data.ext_user);\n    }\n    if (organization.data.office_managers \u0026\u0026 organization.data.office_managers.length \u003e 0) {\n        Context.data.office_managers = staffs\n            .filter(s =\u003e { var _a; return ((_a = organization.data.office_managers) !== null \u0026\u0026 _a !== void 0 ? _a : []).findIndex(manager =\u003e manager.id === s.id) !== -1; })\n            .map(s =\u003e s.data.ext_user);\n    }\n    if (organization.data.matching_finance \u0026\u0026 organization.data.matching_finance.length \u003e 0) {\n        Context.data.matching_finance = staffs\n            .filter(s =\u003e { var _a; return ((_a = organization.data.matching_finance) !== null \u0026\u0026 _a !== void 0 ? _a : []).findIndex(finance =\u003e finance.id === s.id) !== -1; })\n            .map(s =\u003e s.data.ext_user);\n    }\n    if (head_staffs \u0026\u0026 head_staffs.length \u003e 0) {\n        const org_head = staffs.find(s =\u003e head_staffs.findIndex(head =\u003e head.id === s.id) !== -1);\n        Context.data.organization_head = org_head === null || org_head === void 0 ? void 0 : org_head.data.ext_user;\n        Context.data.organization_head_app = org_head;\n    }\n}\n","gatewayPairs":{},"hasTranslations":false}
