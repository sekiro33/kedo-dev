{"scripts":"async function get_staff_replcament() {\n    if (!Context.data.staff) {\n        Context.data.error = 'Не указан сотрудник';\n        throw new Error(Context.data.error);\n    }\n    const staff = await Context.data.staff.fetch();\n    if (!staff.data.ext_user) {\n        Context.data.error = 'У сотрудника не найден связанный с ним пользователь';\n        throw new Error(Context.data.error);\n    }\n    const user = staff.data.ext_user;\n    const now = new Datetime();\n    const replacement = await System.replacements.search().where((f, g) =\u003e g.and(f.absent.eq(user), f.begin.lte(now), f.end.gte(now))).first();\n    if (replacement) {\n        Context.data.date_end = replacement.data.end;\n    }\n    else {\n        Context.data.date_end = undefined;\n    }\n}\n","gatewayPairs":{},"hasTranslations":false}
