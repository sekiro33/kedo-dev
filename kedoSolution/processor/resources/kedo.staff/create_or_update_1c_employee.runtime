{"scripts":"const url = \"https://1cfresh.com/a/hrm/1869190/ru_RU/odata/standard.odata/\";\nconst pass = \"T4ixesu\";\nconst login = \"admin.user\";\nlet individualRes;\nasync function fillInfo() {\n    const employee_app = await Context.data.staff.fetch();\n    Context.data.documents_types_url = \"Catalog_ВидыДокументовФизическихЛиц?$format=json\";\n    Context.data.request_type = !!employee_app.data.individual_id_1c ? \"PATCH\" : \"POST\";\n    Context.data.employee_exists = !!employee_app.data.individual_id_1c;\n    const individualObject = {\n        \"Description\": employee_app.data.__name,\n        \"ДатаРождения\": employee_app.data.date_of_birth.format('YYYY-MM-DD') + \"T00:00:00\",\n        \"Пол\": employee_app.data.sex ? \"Мужской\" : \"Женский\",\n        \"ИНН\": employee_app.data.inn,\n        \"СтраховойНомерПФР\": employee_app.data.snils,\n        \"ФИО\": employee_app.data.full_name.lastname + \" \" + employee_app.data.full_name.firstname + \" \" + employee_app.data.full_name.middlename,\n        \"Фамилия\": employee_app.data.full_name.lastname,\n        \"Имя\": employee_app.data.full_name.firstname,\n        \"Отчество\": employee_app.data.full_name.middlename,\n        \"Инициалы\": employee_app.data.full_name.firstname[0] + \". \" + employee_app.data.full_name.middlename[0] + \".\",\n    };\n    Context.data.individual_request_body = JSON.stringify(individualObject);\n    Context.data.url_individuals = employee_app.data.individual_id_1c\n        ? `Catalog_ФизическиеЛица(guid'${employee_app.data.individual_id_1c}')?$format=json`\n        : \"Catalog_ФизическиеЛица?$format=json\";\n}\nasync function fillEmployeeAndPassportInfo() {\n    const employee_app = await Context.data.staff.fetch();\n    const personalInfo = Context.data.individuals_result ? JSON.parse(Context.data.individuals_result) : undefined;\n    if (personalInfo) {\n        Context.data.individual_id = personalInfo[\"Ref_Key\"];\n        employee_app.data.individual_id_1c = personalInfo[\"Ref_Key\"];\n    }\n    if (!employee_app.data.passport_saved_in_1s) {\n        Context.data.renew_passport = true;\n        Context.data.request_type_documents = \"POST\";\n        const documentTypesJSON = JSON.parse(Context.data.document_types);\n        const passportId = documentTypesJSON.value.find((obj) =\u003e {\n            return obj[\"КодПФР\"] === \"ПАСПОРТ РОССИИ\";\n        });\n        const documentObject = {\n            \"Физлицо_Key\": Context.data.individual_id,\n            \"ВидДокумента_Key\": passportId[\"Ref_Key\"],\n            \"Серия\": employee_app.data.passport_series,\n            \"Номер\": employee_app.data.passport_number,\n            \"ДатаВыдачи\": employee_app.data.date_of_issue.year + \"-\" + employee_app.data.date_of_issue.month + \"-\" + employee_app.data.date_of_issue.day + \"T00:00:00\",\n            \"КемВыдан\": employee_app.data.issued_by,\n            \"КодПодразделения\": employee_app.data.department_code,\n        };\n        Context.data.telo_zaprosa_dokumenty = JSON.stringify(documentObject);\n        Context.data.url_documents = \"InformationRegister_ДокументыФизическихЛиц?$format=json\";\n        employee_app.data.passport_saved_in_1s = true;\n    }\n    await employee_app.save();\n    Context.data.request_type = !!employee_app.data.id_1c ? \"PATCH\" : \"POST\";\n    const org = await employee_app.data.organization.fetch();\n    const orgRef = org.data.ref_key;\n    const employeeObject = !!employee_app.data.id_1c ? {\n        \"Description\": employee_app.data.__name,\n    } : {\n        \"Description\": employee_app.data.__name,\n        \"ФизическоеЛицо_Key\": Context.data.individual_id,\n        \"ГоловнаяОрганизация_Key\": orgRef,\n    };\n    Context.data.request_body_employees = JSON.stringify(employeeObject);\n    Context.data.url_employee = employee_app.data.id_1c\n        ? `Catalog_Сотрудники(guid'${employee_app.data.id_1c}')?$format=json`\n        : \"Catalog_Сотрудники?$format=json\";\n}\nasync function fillId() {\n    const employee_app = await Context.data.staff.fetch();\n    const employeeInfo = Context.data.employees_response ? JSON.parse(Context.data.employees_response) : undefined;\n    if (employeeInfo) {\n        Context.data.employee_id = employeeInfo[\"Ref_Key\"];\n        employee_app.data.id_1c = employeeInfo[\"Ref_Key\"];\n        await employee_app.save();\n    }\n}\n","gatewayPairs":{},"hasTranslations":false}
